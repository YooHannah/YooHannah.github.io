<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="/atom.xml" title="My Little World" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0">






<meta property="og:type" content="website">
<meta property="og:title" content="My Little World">
<meta property="og:url" content="http://yoohannah.github.io/page/14/index.html">
<meta property="og:site_name" content="My Little World">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="My Little World">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoohannah.github.io/page/14/">





  <title> My Little World </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">My Little World</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">learn and share</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            å…³äº
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/react/EventEmitter.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/react/EventEmitter.html" itemprop="url">
                  å®ç°ä¸€ä¸ª EventEmitter
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-10-21T21:07:02+08:00">
                2017-10-21
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="å®ç°ä¸€ä¸ª-EventEmitter"><a href="#å®ç°ä¸€ä¸ª-EventEmitter" class="headerlink" title="å®ç°ä¸€ä¸ª EventEmitter"></a>å®ç°ä¸€ä¸ª EventEmitter</h1><p>EventEmitter æ¨¡å—ï¼Œå®ƒæ˜¯ä¸€ä¸ªç±»ï¼Œå®ƒçš„å®ä¾‹å…·æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹æ³•ï¼šonã€emitã€offï¼š<br>on(eventName, func)ï¼šç›‘å¬ eventName äº‹ä»¶ï¼Œäº‹ä»¶è§¦å‘çš„æ—¶å€™è°ƒç”¨ func å‡½æ•°ã€‚<br>emit(eventName, arg1, arg2, arg3â€¦)ï¼šè§¦å‘ eventName äº‹ä»¶ï¼Œå¹¶ä¸”æŠŠå‚æ•° arg1, arg2, arg3â€¦ ä¼ ç»™äº‹ä»¶å¤„ç†å‡½æ•°ã€‚<br>off(eventName, func)ï¼šåœæ­¢ç›‘å¬æŸä¸ªäº‹ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">class EventEmitter &#123;</span><br><span class="line">  /* TODO */</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    this.listeners = [];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  on(eventName, func)&#123;</span><br><span class="line">    for(let i=0;i&lt;this.listeners.length;i++)&#123;</span><br><span class="line">      if(this.listeners[i].name === eventName)&#123;</span><br><span class="line">          this.listeners[i].funcs.push(func);</span><br><span class="line">          return</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    this.listeners.push(&#123;</span><br><span class="line">      name:eventName,</span><br><span class="line">      funcs:[]</span><br><span class="line">    &#125;)</span><br><span class="line">    this.listeners[this.listeners.length-1].funcs.push(func)</span><br><span class="line">  &#125;</span><br><span class="line">  emit(eventName, ...args)&#123;</span><br><span class="line">    for(let j=0;j&lt;this.listeners.length;j++)&#123;</span><br><span class="line">        if(this.listeners[j].name === eventName)&#123;</span><br><span class="line">            for(let k =0;k&lt;this.listeners[j].funcs.length;k++)&#123;</span><br><span class="line">              this.listeners[j].funcs[k](args)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  off(eventName, func)&#123;</span><br><span class="line">      for(let j=0;j&lt;this.listeners.length;j++)&#123;</span><br><span class="line">        if(this.listeners[j].name === eventName)&#123;</span><br><span class="line">          if(func == undefined)&#123; //æ•´ä¸ªäº‹ä»¶ä¸å†ç›‘å¬</span><br><span class="line">            this.listeners.splice(j,1);</span><br><span class="line">           &#125;</span><br><span class="line">          for(let k =0;k&lt;this.listeners[j].funcs.length;k++)&#123;</span><br><span class="line">                if(func === this.listeners[j].funcs[k])&#123;</span><br><span class="line">                  this.listeners[j].funcs.splice(k,1);</span><br><span class="line">                  return</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const emitter = new EventEmitter()</span><br><span class="line">const sayHi = (name) =&gt; console.log(`Hello $&#123;name&#125;`)</span><br><span class="line">const sayHi2 = (name) =&gt; console.log(`Good night, $&#123;name&#125;`)</span><br><span class="line"></span><br><span class="line">emitter.on(&apos;hi&apos;, sayHi)</span><br><span class="line">emitter.on(&apos;hi&apos;, sayHi2)</span><br><span class="line">emitter.on(&apos;hi2&apos;, sayHi)</span><br><span class="line">emitter.on(&apos;hi2&apos;, sayHi2)</span><br><span class="line">emitter.emit(&apos;hi&apos;, &apos;ScriptOJ&apos;)</span><br><span class="line">// =&gt; Hello ScriptOJ</span><br><span class="line">// =&gt; Good night, ScriptOJ</span><br><span class="line"></span><br><span class="line">emitter.off(&apos;hi&apos;, sayHi)</span><br><span class="line">emitter.emit(&apos;hi&apos;, &apos;ScriptOJ&apos;)</span><br><span class="line">emitter.emit(&apos;hi2&apos;, &apos;ScriptOJ&apos;)</span><br><span class="line"></span><br><span class="line">const emitter2 = new EventEmitter()</span><br><span class="line">emitter2.on(&apos;hi&apos;, (name, age) =&gt; &#123;</span><br><span class="line">  console.log(`I am $&#123;name&#125;, and I am $&#123;age&#125; years old`)</span><br><span class="line">&#125;)</span><br><span class="line">emitter2.emit(&apos;hi&apos;, &apos;Jerry&apos;, 12)</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/react/react.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/react/react.html" itemprop="url">
                  react ç®€ç•¥å­¦ä¹ ç¬”è®°
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-10-09T06:37:02+08:00">
                2017-10-09
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>react.jsæ˜¯ä¸€ä¸ªUIåº“,æŒ‰ç…§reactè§„åˆ™ï¼Œå¯ä»¥ç»„å»ºé¡µé¢é‡Œæ¯ä¸€å°å—çš„åŠŸèƒ½ï¼Œè¿™ç§å±€éƒ¨çš„åŠŸèƒ½å°±æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œ<br>å„ç»„ä»¶ä¹‹é—´å¯ä»¥ç»„åˆã€åµŒå¥—ï¼Œä»è€Œæ‹¼æˆæ•´ä¸ªé¡µé¢<br>reactå°±æ˜¯åœ¨ç»„å»ºå„ä¸ªå°½å¯èƒ½é€šç”¨çš„ç»„ä»¶</p>
<h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><p>ç›´æ¥ä½¿ç”¨å®˜æ–¹å·¥å…· create-react-app<br>npm install -g create-react-app å®‰è£…å‘½ä»¤è¡Œ<br>create-react-app hello-react æ„å»ºå·¥ç¨‹<br>cd hello-react è¿›å…¥å·¥ç¨‹<br>npm start è¿è¡Œ<br>src/App.js å³æ˜¯ç¼–å†™ç»„ä»¶çš„æ–‡ä»¶<br>ä¸€ä¸ªç®€å•çš„ç»„ä»¶<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &apos;react&apos; //å†™ç»„ä»¶å¿…é¡»è¦å¼•å…¥çš„ä¾èµ–</span><br><span class="line">import ReactDOM from &apos;react-dom&apos; //æŠŠç»„ä»¶æ¸²æŸ“åˆ°é¡µé¢ä¸Šå»ï¼Œå°±æ˜¯æŠŠç»„ä»¶çš„htmlç»“æ„å½¢æˆé¡µé¢</span><br><span class="line">import &apos;./index.css&apos;</span><br><span class="line"></span><br><span class="line">class Header extends Component &#123;</span><br><span class="line">  render () &#123; //ç»„ä»¶å¿…é¡»è¦æœ‰çš„å‡½æ•°ï¼Œä¸”å¿…é¡»è¦è¿”å›JSX</span><br><span class="line">    return ( //è¿”å›JSXå†™çš„ç»„ä»¶å†…å®¹</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;React å°ä¹¦&lt;/h1&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//ReactDOM.render åŠŸèƒ½å°±æ˜¯æŠŠç»„ä»¶æ¸²æŸ“å¹¶ä¸”æ„é€  DOM æ ‘ï¼Œç„¶åæ’å…¥åˆ°é¡µé¢ä¸ŠæŸä¸ªç‰¹å®šçš„å…ƒç´ ä¸Šï¼ˆåœ¨è¿™é‡Œæ˜¯ id ä¸º root çš„ div å…ƒç´ ï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;Header /&gt;,</span><br><span class="line">  document.getElementById(&apos;root&apos;)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>åœ¨ç¼–å†™ React.js ç»„ä»¶çš„æ—¶å€™ï¼Œä¸€èˆ¬éƒ½éœ€è¦ç»§æ‰¿ React.js çš„ Componentï¼ˆä¹Ÿæœ‰åˆ«çš„ç¼–å†™ç»„ä»¶çš„æ–¹å¼â€“&gt;å‡½æ•°å¼ç»„ä»¶ï¼‰ã€‚ä¸€ä¸ªç»„ä»¶ç±»å¿…é¡»è¦å®ç°ä¸€ä¸ª render æ–¹æ³•ï¼Œè¿™ä¸ª render æ–¹æ³•å¿…é¡»è¦è¿”å›ä¸€ä¸ª JSX å…ƒç´ ã€‚ä½†è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œ</p>
<p>å¿…é¡»è¦ç”¨ä¸€ä¸ªå¤–å±‚çš„ JSX å…ƒç´ æŠŠæ‰€æœ‰å†…å®¹åŒ…è£¹èµ·æ¥ã€‚è¿”å›å¹¶åˆ—å¤šä¸ª JSX å…ƒç´ æ˜¯ä¸å…è®¸çš„ï¼Œ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//ä¸å¯¹çš„</span><br><span class="line">return (</span><br><span class="line">      &lt;div&gt;ç¬¬ä¸€ä¸ª&lt;/div&gt;</span><br><span class="line">      &lt;div&gt;ç¬¬äºŒä¸ª&lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">//å¯¹çš„</span><br><span class="line">return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;div&gt;ç¬¬ä¸€ä¸ª&lt;/div&gt;</span><br><span class="line">      &lt;div&gt;ç¬¬äºŒä¸ª&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br></pre></td></tr></table></figure></p>
<h1 id="JSX"><a href="#JSX" class="headerlink" title="JSX"></a>JSX</h1><p>å¯ä»¥æŠŠå®ƒçœ‹åšæ˜¯jsçš„ä¸€ç§æ•°æ®ç±»å‹ï¼Œé•¿å¾—å¾ˆåƒHTMLï¼Œä½†ä¸æ˜¯HTML,å¯ä»¥åƒhtmlé‚£æ ·å†™ï¼Œä½†æœ‰äº›åœ°æ–¹è¦æ³¨æ„</p>
<p>å¯åº”ç”¨{}æ’å…¥ä»»ä½•jsä»£ç ï¼Œ<br>å¦‚æœæ˜¯è¡¨è¾¾å¼å‡½æ•°ï¼Œåˆ™è¿”å›çš„ç»“æœä¼šç›¸åº”åœ°æ¸²æŸ“åˆ°é¡µé¢ä¸Šï¼Œå˜é‡åˆ™å°†å˜é‡å€¼å¯¹åº”æ¸²æŸ“</p>
<p>{}å†…å¦‚æœæ˜¯æ¡ä»¶è¡¨è¾¾å¼ï¼Œå³å¯ä»¥å®ç°ï¼Œæ ¹æ®ä¸åŒæ¡ä»¶è¿”å›ä¸åŒjsxå†…å®¹ï¼Œ<br>å¦‚æœåœ¨è¡¨è¾¾å¼æ’å…¥é‡Œé¢è¿”å› null ï¼Œé‚£ä¹ˆ React.js ä¼šä»€ä¹ˆéƒ½ä¸æ˜¾ç¤ºï¼Œç›¸å½“äºå¿½ç•¥äº†è¯¥è¡¨è¾¾å¼æ’å…¥ã€‚ç»“åˆæ¡ä»¶è¿”å›çš„è¯ï¼Œå°±åšåˆ°æ˜¾ç¤ºæˆ–è€…éšè—æŸäº›å…ƒç´ </p>
<p>å¯ä»¥åšå˜é‡çš„å€¼<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">render () &#123;</span><br><span class="line">  const isGoodWord = true</span><br><span class="line">  const goodWord = &lt;strong&gt; is good&lt;/strong&gt;</span><br><span class="line">  const badWord = &lt;span&gt; is not good&lt;/span&gt;</span><br><span class="line">  const title = &lt;h1 className=&apos;title&apos;&gt; ScriptOJ &lt;/h1&gt;</span><br><span class="line">  const page = &lt;div className= &apos;content&apos;&gt; &#123;title&#125; &lt;/div&gt; //pageé‡Œé¢ç”¨titleçš„å€¼ï¼Œå³ &lt;h1 className=&apos;title&apos;&gt; ScriptOJ &lt;/h1&gt;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h1&gt;</span><br><span class="line">        React å°ä¹¦</span><br><span class="line">        &#123;isGoodWord ? goodWord : badWord&#125;</span><br><span class="line">      &lt;/h1&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ç»™æ ‡ç­¾æ·»åŠ classæ—¶ï¼Œä¸èƒ½ç”¨class,è¦ç”¨className<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">render () &#123;</span><br><span class="line">  const className = &apos;header&apos;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div className=&#123;className&#125;&gt;</span><br><span class="line">      &lt;h1&gt;React å°ä¹¦&lt;/h1&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>forå±æ€§ä¸èƒ½ç”¨ï¼Œè¦ç”¨htmlforä»£æ›¿ï¼Œ<br>å…¶ä»–çš„ HTML å±æ€§ä¾‹å¦‚ style ã€data-* ç­‰å°±å¯ä»¥åƒæ™®é€šçš„ HTML å±æ€§é‚£æ ·ç›´æ¥æ·»åŠ ä¸Šå»ã€‚</p>
<h1 id="ç»„ä»¶æ ‘"><a href="#ç»„ä»¶æ ‘" class="headerlink" title="ç»„ä»¶æ ‘"></a>ç»„ä»¶æ ‘</h1><p>é€šè¿‡ç»§æ‰¿Componentå¯ä»¥è‡ªå®šä¹‰å½¢æˆå¤šä¸ªç±»,å³å½¢æˆå¤šä¸ªç»„ä»¶ï¼Œä½†è¿™äº›ç»„ä»¶åï¼Œ<br>æˆ–è€…è¯´ç±»åè¦ä½œä¸ºæ ‡ç­¾ä½¿ç”¨ï¼Œä¸ºä¸æ™®é€šå°å†™å­—æ¯å¼€å¤´çš„HTMLæ ‡ç­¾åšåŒºåˆ†ï¼Œä¸€å®šè¦ä»¥å¤§å†™å­—æ¯å¼€å¤´</p>
<p>è‡ªå®šä¹‰ç»„ä»¶ä»¥æ ‡ç­¾çš„å½¢å¼æ”¾å…¥å¦ä¸€ä¸ªè‡ªå®šä¹‰ç»„ä»¶çš„JSXä¸­ï¼Œå³å¯å®ç°åŒ…å«å…³ç³»<br>å¤šä¸ªè‡ªå®šä¹‰æ ‡ç­¾ç»„ä»¶å¹¶åˆ—æ”¾å…¥åŒä¸€ä¸ªJSXä¸­å³å®ç°å¹¶åˆ—å…³ç³»<br>ç»„ä»¶å¯ä»¥å’Œç»„ä»¶ç»„åˆåœ¨ä¸€èµ·ï¼Œç»„ä»¶å†…éƒ¨å¯ä»¥ä½¿ç”¨åˆ«çš„ç»„ä»¶ï¼Œå°±åƒæ™®é€šçš„ HTML æ ‡ç­¾ä¸€æ ·ä½¿ç”¨å°±å¯ä»¥<br>è¿™æ ·çš„ç»„åˆåµŒå¥—ï¼Œæœ€åæ„æˆä¸€ä¸ªæ‰€è°“çš„ç»„ä»¶æ ‘</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &apos;react&apos;;</span><br><span class="line">import ReactDOM from &apos;react-dom&apos;;</span><br><span class="line"></span><br><span class="line">class Title extends Component &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;h1&gt;hello react&lt;/h1&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Header extends Component &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;Title /&gt; //headeré‡Œé¢åŒ…å«Title</span><br><span class="line">      &lt;h2&gt;This is Header&lt;/h2&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Main extends Component &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h2&gt;This is main content&lt;/h2&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Footer extends Component &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h2&gt;This is footer&lt;/h2&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Index extends Component &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt; //å¤šæ ‡ç­¾å¹¶åˆ—æ”¾ç½®ï¼Œç»„æˆé¡µé¢</span><br><span class="line">        &lt;Header /&gt;</span><br><span class="line">        &lt;Main /&gt;</span><br><span class="line">        &lt;Footer /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;Index /&gt;,</span><br><span class="line">  document.getElementById(&apos;root&apos;)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h1 id="äº‹ä»¶ç›‘å¬"><a href="#äº‹ä»¶ç›‘å¬" class="headerlink" title="äº‹ä»¶ç›‘å¬"></a>äº‹ä»¶ç›‘å¬</h1><p> React.js ä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨æµè§ˆå™¨åŸç”Ÿçš„ addEventListener è¿›è¡Œäº‹ä»¶ç›‘å¬ã€‚<br> React.js å°è£…å¥½äº†ä¸€ç³»åˆ—çš„ on<em> çš„å±æ€§ï¼Œå½“éœ€è¦ä¸ºæŸä¸ªå…ƒç´ ç›‘å¬æŸä¸ªäº‹ä»¶çš„æ—¶å€™ï¼Œåªéœ€è¦ç®€å•åœ°ç»™å®ƒåŠ ä¸Š on</em> å°±å¯ä»¥äº†ã€‚<br> è€Œä¸”ä¸éœ€è¦è€ƒè™‘ä¸åŒæµè§ˆå™¨å…¼å®¹æ€§çš„é—®é¢˜ï¼ŒReact.js éƒ½å°è£…å¥½äº†è¿™äº›ç»†èŠ‚ã€‚</p>
<p> ä½†æ˜¯è¦æ³¨æ„ï¼Œæ²¡æœ‰ç»è¿‡ç‰¹æ®Šå¤„ç†çš„è¯ï¼Œè¿™äº› on* çš„äº‹ä»¶ç›‘å¬åªèƒ½ç”¨åœ¨æ™®é€šçš„ HTML çš„æ ‡ç­¾ä¸Šï¼Œè€Œä¸èƒ½ç”¨åœ¨ç»„ä»¶æ ‡ç­¾ä¸Š</p>
<p> React.js ä¼šç»™æ¯ä¸ªäº‹ä»¶ç›‘å¬ä¼ å…¥ä¸€ä¸ª event å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æä¾›çš„åŠŸèƒ½å’Œæµè§ˆå™¨æä¾›çš„åŠŸèƒ½ä¸€è‡´ï¼Œè€Œä¸”å®ƒæ˜¯å…¼å®¹æ‰€æœ‰æµè§ˆå™¨çš„ã€‚</p>
<p> React.js çš„äº‹ä»¶ç›‘å¬æ–¹æ³•éœ€è¦æ‰‹åŠ¨ bind åˆ°å½“å‰å®ä¾‹ï¼Œè¿™ç§æ¨¡å¼åœ¨ React.js ä¸­éå¸¸å¸¸ç”¨ã€‚ä¸ç„¶ç›‘å¬äº‹ä»¶è°ƒç”¨çš„æ–¹æ³•é‡Œé¢çš„thisæ˜¯undefined<br> å¦å¤–å¯ä»¥åœ¨bind çš„æ—¶å€™ä¼ å‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">class Title extends Component &#123;</span><br><span class="line"> handleClickOnTitle (e) &#123;</span><br><span class="line">    console.log(this)//undefined</span><br><span class="line">    console.log(e.target.innerHTML)//hello React</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render () &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;h1 onClick=&#123;this.handleClickOnTitle&#125;&gt;hello React&lt;/h1&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Title extends Component &#123;</span><br><span class="line"> handleClickOnTitle (word, e) &#123;</span><br><span class="line">    console.log(this, word)//Title å¯¹è±¡ï¼Œâ€œhelloâ€</span><br><span class="line">    console.log(e.target.innerHTML)//hello React</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render () &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;h1 onClick=&#123;this.handleClickOnTitle.bind(this, &apos;Hello&apos;)&#125;&gt;hello React &lt;/h1&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="setStateå‡½æ•°å’Œpros"><a href="#setStateå‡½æ•°å’Œpros" class="headerlink" title="setStateå‡½æ•°å’Œpros"></a>setStateå‡½æ•°å’Œpros</h1><p>ä¸€ä¸ªç»„ä»¶çš„æ˜¾ç¤ºå½¢æ€æ˜¯å¯ä»¥ç”±å®ƒæ•°æ®çŠ¶æ€(state)å’Œé…ç½®å‚æ•°(pros)å†³å®šçš„ï¼Œå³ä¸¤ç§æ–¹å¼æ§åˆ¶ç»„ä»¶æ˜¾ç¤ºå½¢æ€</p>
<h2 id="æ–¹å¼ä¸€ï¼šåˆ©ç”¨stateçš„å€¼-é€šè¿‡æ¸²æŸ“æ§åˆ¶æ˜¾ç¤ºçŠ¶æ€"><a href="#æ–¹å¼ä¸€ï¼šåˆ©ç”¨stateçš„å€¼-é€šè¿‡æ¸²æŸ“æ§åˆ¶æ˜¾ç¤ºçŠ¶æ€" class="headerlink" title="æ–¹å¼ä¸€ï¼šåˆ©ç”¨stateçš„å€¼,é€šè¿‡æ¸²æŸ“æ§åˆ¶æ˜¾ç¤ºçŠ¶æ€"></a>æ–¹å¼ä¸€ï¼šåˆ©ç”¨stateçš„å€¼,é€šè¿‡æ¸²æŸ“æ§åˆ¶æ˜¾ç¤ºçŠ¶æ€</h2><p>ä¸€ä¸ªç»„ä»¶å¯ä»¥æ‹¥æœ‰è‡ªå·±çš„çŠ¶æ€,React.js çš„ state ç”¨æ¥å­˜å‚¨è¿™ç§å¯å˜åŒ–çš„çŠ¶æ€,å†è®©setStateå‡½æ•°æ ¹æ®stateçš„å€¼é‡æ–°æ¸²æŸ“ç»„ä»¶åˆ°é¡µé¢<br>setState æ–¹æ³•ç”±çˆ¶ç±» Component æ‰€æä¾›ã€‚å½“è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„æ—¶å€™ï¼ŒReact.js ä¼šæ›´æ–°ç»„ä»¶çš„çŠ¶æ€ state ï¼Œå¹¶ä¸”é‡æ–°è°ƒç”¨ render æ–¹æ³•ï¼Œç„¶åå†æŠŠ render æ–¹æ³•æ‰€æ¸²æŸ“çš„æœ€æ–°çš„å†…å®¹æ˜¾ç¤ºåˆ°é¡µé¢ä¸Šã€‚<br>æ³¨æ„ï¼Œå½“è¦æ”¹å˜ç»„ä»¶çš„çŠ¶æ€çš„æ—¶å€™ï¼Œä¸èƒ½ç›´æ¥ç”¨ this.state = xxx è¿™ç§æ–¹å¼æ¥ä¿®æ”¹ï¼Œå¦‚æœè¿™æ ·åš React.js å°±æ²¡åŠæ³•çŸ¥é“ä½ ä¿®æ”¹äº†ç»„ä»¶çš„çŠ¶æ€ï¼Œå®ƒä¹Ÿå°±æ²¡æœ‰åŠæ³•æ›´æ–°é¡µé¢ã€‚æ‰€ä»¥ï¼Œä¸€å®šè¦ä½¿ç”¨ React.js æä¾›çš„ setState æ–¹æ³•ï¼Œå®ƒæ¥å—ä¸€ä¸ªå¯¹è±¡æˆ–è€…å‡½æ•°ä½œä¸ºå‚æ•°ã€‚</p>
<p>ä¼ å…¥ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œè¿™ä¸ªå¯¹è±¡è¡¨ç¤ºè¯¥ç»„ä»¶çš„æ–°çŠ¶æ€ã€‚ä½†åªéœ€è¦ä¼ å…¥éœ€è¦æ›´æ–°çš„éƒ¨åˆ†å°±å¯ä»¥äº†ï¼Œè€Œä¸éœ€è¦ä¼ å…¥æ•´ä¸ªå¯¹è±¡<br>è¦æ³¨æ„çš„æ˜¯ï¼Œå½“è°ƒç”¨ setState çš„æ—¶å€™ï¼ŒReact.js å¹¶ä¸ä¼šé©¬ä¸Šä¿®æ”¹ stateã€‚è€Œæ˜¯æŠŠè¿™ä¸ªå¯¹è±¡æ”¾åˆ°ä¸€ä¸ªæ›´æ–°é˜Ÿåˆ—é‡Œé¢ï¼Œç¨åæ‰ä¼šä»é˜Ÿåˆ—å½“ä¸­æŠŠæ–°çš„çŠ¶æ€æå–å‡ºæ¥åˆå¹¶åˆ° state å½“ä¸­ï¼Œç„¶åå†è§¦å‘ç»„ä»¶æ›´æ–°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">handleClickOnLikeButton () &#123;</span><br><span class="line">    console.log(this.state.isLiked)</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      isLiked: !this.state.isLiked</span><br><span class="line">    &#125;)</span><br><span class="line">    console.log(this.state.isLiked) //ç¬¬äºŒæ¬¡æ‰“å°çš„å°±æ˜¯ç¬¬ä¸€æ¬¡æ‰“å°çš„å€¼</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœéœ€è¦å¤šæ¬¡setState,è€Œä¸”åç»­ä¼ å…¥å‚æ•°ä¾èµ–å‰ä¸€ä¸ªsetState å‚æ•°ï¼Œè¿™æ—¶å°±è¦ç”¨å‡½æ•°åšsetStateå‚æ•°ï¼Œ<br>React.js ä¼šæŠŠä¸Šä¸€ä¸ª setState çš„ç»“æœä¼ å…¥è¿™ä¸ªå‡½æ•°ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨è¯¥ç»“æœè¿›è¡Œè¿ç®—ã€æ“ä½œï¼Œç„¶åè¿”å›ä¸€ä¸ªå¯¹è±¡ä½œä¸ºæ›´æ–° state çš„å¯¹è±¡<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">handleClickOnLikeButton () &#123;</span><br><span class="line"></span><br><span class="line">    // this.setState(&#123; count: 0 &#125;) // =&gt; this.state.count è¿˜æ˜¯ undefined</span><br><span class="line">    // this.setState(&#123; count: this.state.count + 1&#125;) // =&gt; undefined + 1 = NaN</span><br><span class="line">    // this.setState(&#123; count: this.state.count + 2&#125;) //æœ€ç»ˆç»“æœä¸ºNAN</span><br><span class="line"></span><br><span class="line">    this.setState((prevState) =&gt; &#123;</span><br><span class="line">      return &#123; count: 0 &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    this.setState((prevState) =&gt; &#123;</span><br><span class="line">      return &#123; count: prevState.count + 1 &#125; // ä¸Šä¸€ä¸ª setState çš„è¿”å›æ˜¯ count ä¸º 0ï¼Œå½“å‰è¿”å› 1</span><br><span class="line">    &#125;)</span><br><span class="line">    this.setState((prevState) =&gt; &#123;</span><br><span class="line">      return &#123; count: prevState.count + 2 &#125; // ä¸Šä¸€ä¸ª setState çš„è¿”å›æ˜¯ count ä¸º 1ï¼Œå½“å‰è¿”å› 3</span><br><span class="line">    &#125;)</span><br><span class="line">    // æœ€åçš„ç»“æœæ˜¯ this.state.count ä¸º 3ï¼Œæ‰€ä»¥å¦‚æœJSXä¸­å¦‚æœæ˜¾ç¤ºcount,åˆ™æ˜¾ç¤º3</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>å¤šæ¬¡è°ƒç”¨setStateåªä¼šè¿”å›å¤šæ¬¡è¿è¡Œåçš„ç»“æœï¼ŒReact.js å†…éƒ¨ä¼šæŠŠ JavaScript äº‹ä»¶å¾ªç¯ä¸­çš„æ¶ˆæ¯é˜Ÿåˆ—çš„åŒä¸€ä¸ªæ¶ˆæ¯ä¸­çš„ setState éƒ½è¿›è¡Œåˆå¹¶ä»¥åå†é‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚</p>
<h2 id="æ–¹å¼äºŒï¼šåœ¨JSXä¸­ä½¿ç”¨è‡ªå®šä¹‰ç»„ä»¶æ—¶ï¼Œä¼ å…¥é…ç½®å±æ€§ï¼Œæ ¹æ®å±æ€§æ˜¾ç¤ºçŠ¶æ€"><a href="#æ–¹å¼äºŒï¼šåœ¨JSXä¸­ä½¿ç”¨è‡ªå®šä¹‰ç»„ä»¶æ—¶ï¼Œä¼ å…¥é…ç½®å±æ€§ï¼Œæ ¹æ®å±æ€§æ˜¾ç¤ºçŠ¶æ€" class="headerlink" title="æ–¹å¼äºŒï¼šåœ¨JSXä¸­ä½¿ç”¨è‡ªå®šä¹‰ç»„ä»¶æ—¶ï¼Œä¼ å…¥é…ç½®å±æ€§ï¼Œæ ¹æ®å±æ€§æ˜¾ç¤ºçŠ¶æ€"></a>æ–¹å¼äºŒï¼šåœ¨JSXä¸­ä½¿ç”¨è‡ªå®šä¹‰ç»„ä»¶æ—¶ï¼Œä¼ å…¥é…ç½®å±æ€§ï¼Œæ ¹æ®å±æ€§æ˜¾ç¤ºçŠ¶æ€</h2><p>åœ¨ä½¿ç”¨ä¸€ä¸ªç»„ä»¶çš„æ—¶å€™ï¼Œå¯ä»¥æŠŠå‚æ•°æ”¾åœ¨æ ‡ç­¾çš„å±æ€§å½“ä¸­ï¼Œæ‰€æœ‰çš„å±æ€§éƒ½ä¼šä½œä¸º props å¯¹è±¡çš„é”®å€¼<br>ç»„ä»¶å†…éƒ¨å°±å¯ä»¥é€šè¿‡ this.props æ¥è®¿é—®åˆ°è¿™äº›é…ç½®å‚æ•°<br>å¯ä»¥æŠŠä»»ä½•ç±»å‹çš„æ•°æ®ä½œä¸ºç»„ä»¶çš„å‚æ•°ï¼ŒåŒ…æ‹¬å­—ç¬¦ä¸²ã€æ•°å­—ã€å¯¹è±¡ã€æ•°ç»„ã€ç”šè‡³æ˜¯å‡½æ•°ç­‰ç­‰<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">class Index extends Component &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;LikeButton wordings=&#123;&#123;likedText: &apos;å·²èµ&apos;, unlikedText: &apos;èµ&apos;&#125;&#125;</span><br><span class="line">        onClick=&#123;() =&gt; console.log(&apos;Click on like button!&apos;)/&gt; //è¿™é‡Œonclickå¯ä»¥è¢«å½“åšå±æ€§è®¿é—®åˆ°</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">//LikeButton ç±»</span><br><span class="line">handleClickOnLikeButton () &#123;</span><br><span class="line"></span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      isLiked: !this.state.isLiked</span><br><span class="line">    &#125;)</span><br><span class="line">    if (this.props.onClick) &#123; //è¿™é‡Œçš„onclickæ˜¯ä½¿ç”¨&lt;LikeButton /&gt;æ—¶å®šä¹‰çš„å±æ€§</span><br><span class="line">      this.props.onClick() //è¿™é‡Œçš„å‡½æ•°é€šè¿‡å±æ€§ä¼ é€’è¿›æ¥ï¼Œä¸æ˜¯ç»„ä»¶è‡ªå·±å®ç°</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">render()return çš„JSXçš„button onclickäº‹ä»¶ç»‘å®šhandleClickOnLikeButtonå‡½æ•°</span><br></pre></td></tr></table></figure></p>
<p>JSX çš„{}å†…å¯ä»¥åµŒå…¥ä»»ä½•è¡¨è¾¾å¼,{ {} }å°±æ˜¯åœ¨ {} å†…éƒ¨ç”¨å¯¹è±¡}å­—é¢é‡è¿”å›ä¸€ä¸ªå¯¹è±¡è€Œå·²,<br>this.props.wordingså°±æ˜¯å¯¹è±¡{ likedText: â€˜å·²èµâ€™, unlikedText: â€˜èµâ€™} </p>
<p>å¯ä»¥ç”¨defaultPropsé…ç½®é»˜è®¤å±æ€§,è¿™æ ·å°±ä¸éœ€è¦åˆ¤æ–­é…ç½®å±æ€§æ˜¯å¦ä¼ è¿›æ¥äº†,å¦‚æœæ²¡æœ‰ä¼ è¿›æ¥ï¼Œä¼šç›´æ¥ä½¿ç”¨ defaultProps ä¸­çš„é»˜è®¤å±æ€§</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">class LikeButton extends Component &#123;</span><br><span class="line">  static defaultProps = &#123;</span><br><span class="line">    likedText: &apos;å–æ¶ˆ&apos;,</span><br><span class="line">    unlikedText: &apos;ç‚¹èµ&apos;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  constructor () &#123;</span><br><span class="line">    super()</span><br><span class="line">    this.state = &#123; isLiked: false &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleClickOnLikeButton () &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      isLiked: !this.state.isLiked</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render () &#123;</span><br><span class="line">  //ä¸éœ€è¦åœ¨è¿™é‡Œå‘ä¸‹é¢è¿™æ ·åˆ¤æ–­æ˜¯å¦ä¼ è¿›æ¥äº†é…ç½®å±æ€§,å¦‚æœé…ç½®äº†wordingså°±ç”¨wordingsï¼Œå¦åˆ™ç”¨åé¢&#123;&#125;å†…çš„é»˜è®¤å€¼</span><br><span class="line">  &lt;!-- const wordings = this.props.wordings || &#123;</span><br><span class="line">      likedText: &apos;å–æ¶ˆ&apos;,</span><br><span class="line">      unlikedText: &apos;ç‚¹èµ&apos;</span><br><span class="line">    &#125; --&gt;</span><br><span class="line">    return (</span><br><span class="line">      &lt;button onClick=&#123;this.handleClickOnLikeButton.bind(this)&#125;&gt;</span><br><span class="line">        &#123;this.state.isLiked</span><br><span class="line">          ? this.props.likedText //ç›´æ¥ä½¿ç”¨</span><br><span class="line">          : this.props.unlikedText&#125; ğŸ‘</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸€ä¸ªç»„ä»¶åœ¨è¾“å…¥ç¡®å®šçš„ props çš„æ—¶å€™ï¼Œèƒ½å¤Ÿè¾“å‡ºç¡®å®šçš„ UI æ˜¾ç¤ºå½¢æ€ã€‚å¦‚æœæƒ³ä¿®æ”¹propså†³å®šçš„æ˜¾ç¤ºå½¢æ€ï¼Œå¯ä»¥ä¸»åŠ¨é€šè¿‡é‡æ–°æ¸²æŸ“çš„æ–¹å¼ï¼Œ<br>æŠŠæ–°çš„propsä¼ å…¥åˆ°ç»„ä»¶å½“ä¸­ï¼Œè¿™æ ·è¿™ä¸ªç»„ä»¶ä¸­ç”± props å†³å®šçš„æ˜¾ç¤ºå½¢æ€ä¹Ÿä¼šå¾—åˆ°ç›¸åº”çš„æ”¹å˜ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">class Index extends Component &#123;</span><br><span class="line">  constructor () &#123;</span><br><span class="line">    super()</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      likedText: &apos;å·²èµ&apos;,</span><br><span class="line">      unlikedText: &apos;èµ&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleClickOnChange () &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      likedText: &apos;å–æ¶ˆ&apos;,</span><br><span class="line">      unlikedText: &apos;ç‚¹èµ&apos;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render () &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;LikeButton</span><br><span class="line">          likedText=&#123;this.state.likedText&#125;</span><br><span class="line">          unlikedText=&#123;this.state.unlikedText&#125; /&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &lt;button onClick=&#123;this.handleClickOnChange.bind(this)&#125;&gt;</span><br><span class="line">            ä¿®æ”¹ wordings</span><br><span class="line">          &lt;/button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å³props ä¸€æ—¦ä¼ å…¥,ä½ å°±ä¸å¯ä»¥åœ¨ç»„ä»¶å†…éƒ¨å¯¹å®ƒè¿›è¡Œä¿®æ”¹ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡çˆ¶ç»„ä»¶ä¸»åŠ¨é‡æ–°æ¸²æŸ“çš„æ–¹å¼æ¥ä¼ å…¥æ–°çš„ propsï¼Œä»è€Œè¾¾åˆ°æ›´æ–°çš„æ•ˆæœ</p>
<p>å°ç»“<br>state æ˜¯è®©ç»„ä»¶æ§åˆ¶è‡ªå·±çš„çŠ¶æ€ï¼Œprops æ˜¯è®©å¤–éƒ¨å¯¹ç»„ä»¶è‡ªå·±è¿›è¡Œé…ç½®ã€‚<br>æ²¡æœ‰ state çš„ç»„ä»¶å«æ— çŠ¶æ€ç»„ä»¶ï¼ˆstateless componentï¼‰ï¼Œè®¾ç½®äº† state çš„å«åšæœ‰çŠ¶æ€ç»„ä»¶ï¼ˆstateful componentï¼‰<br>å› ä¸ºçŠ¶æ€ä¼šå¸¦æ¥ç®¡ç†çš„å¤æ‚æ€§ï¼Œæ‰€ä»¥å°½é‡å¤šåœ°å†™æ— çŠ¶æ€ç»„ä»¶ï¼Œå°½é‡å°‘åœ°å†™æœ‰çŠ¶æ€çš„ç»„ä»¶ã€‚è¿™æ ·ä¼šé™ä½ä»£ç ç»´æŠ¤çš„éš¾åº¦ï¼Œä¹Ÿä¼šåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢å¼ºç»„ä»¶çš„å¯å¤ç”¨æ€§ã€‚</p>
<h1 id="å‡½æ•°å¼ç»„ä»¶"><a href="#å‡½æ•°å¼ç»„ä»¶" class="headerlink" title="å‡½æ•°å¼ç»„ä»¶"></a>å‡½æ•°å¼ç»„ä»¶</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">//æ™®é€šå†™æ³•</span><br><span class="line">class HelloWorld extends Component &#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  sayHi () &#123;</span><br><span class="line">    alert(&apos;Hello World&apos;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render () &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div onClick=&#123;this.sayHi.bind(this)&#125;&gt;Hello World&lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//å‡½æ•°å¼ç»„ä»¶çš„ç¼–å†™æ–¹å¼</span><br><span class="line">const HelloWorld = (props) =&gt; &#123;</span><br><span class="line">  const sayHi = (event) =&gt; alert(&apos;Hello World&apos;)</span><br><span class="line">  return (</span><br><span class="line">    &lt;div onClick=&#123;sayHi&#125;&gt;Hello World&lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»¥å‰ä¸€ä¸ªç»„ä»¶æ˜¯é€šè¿‡ç»§æ‰¿ Component æ¥æ„å»ºï¼Œä¸€ä¸ªå­ç±»å°±æ˜¯ä¸€ä¸ªç»„ä»¶ã€‚è€Œç”¨å‡½æ•°å¼çš„ç»„ä»¶ç¼–å†™æ–¹å¼æ˜¯ä¸€ä¸ªå‡½æ•°å°±æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œä½†ä½¿ç”¨æ–¹æ³•åŒæ™®é€šå†™æ³•<br>å‡½æ•°å¼ç»„ä»¶åªèƒ½æ¥å— props è€Œæ— æ³•åƒè·Ÿç±»ç»„ä»¶ä¸€æ ·å¯ä»¥åœ¨ constructor é‡Œé¢åˆå§‹åŒ– stateã€‚ä½ å¯ä»¥ç†è§£å‡½æ•°å¼ç»„ä»¶å°±æ˜¯ä¸€ç§åªèƒ½æ¥å— props å’Œæä¾› render æ–¹æ³•çš„ç±»ç»„ä»¶ã€‚</p>
<h1 id="æ¸²æŸ“åˆ—è¡¨æ•°æ®"><a href="#æ¸²æŸ“åˆ—è¡¨æ•°æ®" class="headerlink" title="æ¸²æŸ“åˆ—è¡¨æ•°æ®"></a>æ¸²æŸ“åˆ—è¡¨æ•°æ®</h1><p>å¦‚æœå¾€ {} æ”¾ä¸€ä¸ªæ•°ç»„ï¼ŒReact.js ä¼šå¸®ä½ æŠŠæ•°ç»„é‡Œé¢ä¸€ä¸ªä¸ªå…ƒç´ ç½—åˆ—å¹¶ä¸”æ¸²æŸ“å‡ºæ¥ï¼Œå¦‚æœæ•°ç»„æ¯ä¸€é¡¹æ˜¯JSXï¼Œå°±å¯ä»¥å°†æ•°æ®æ¸²æŸ“åˆ°htmlé‡Œé¢äº†<br>æ‰€ä»¥reactæ¸²æŸ“åˆ—è¡¨çš„æ€è·¯å°±æ˜¯,å°†æ•°ç»„æ•°æ®åˆ©ç”¨es6çš„mapæ–¹æ³•è½¬æ¢æˆJSX,å†å°†JSXæ•°ç»„æ”¾åˆ°render()è¿”å›å€¼ä¸­<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">class Index extends Component &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &#123;users.map((user) =&gt; &#123;</span><br><span class="line">          return (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">              &lt;div&gt;å§“åï¼š&#123;user.username&#125;&lt;/div&gt;</span><br><span class="line">              &lt;div&gt;å¹´é¾„ï¼š&#123;user.age&#125;&lt;/div&gt;</span><br><span class="line">              &lt;div&gt;æ€§åˆ«ï¼š&#123;user.gender&#125;&lt;/div&gt;</span><br><span class="line">              &lt;hr /&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          )</span><br><span class="line">        &#125;)&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>è¿›ä¸€æ­¥ä¼˜åŒ–,å°†æ•°ç»„æ¯é¡¹JSXæŠ½ç¦»æˆè‡ªå®šä¹‰ç»„ä»¶<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">const users = [</span><br><span class="line">  &#123; username: &apos;Jerry&apos;, age: 21, gender: &apos;male&apos; &#125;,</span><br><span class="line">  &#123; username: &apos;Tomy&apos;, age: 22, gender: &apos;male&apos; &#125;,</span><br><span class="line">  &#123; username: &apos;Lily&apos;, age: 19, gender: &apos;female&apos; &#125;,</span><br><span class="line">  &#123; username: &apos;Lucy&apos;, age: 20, gender: &apos;female&apos; &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">class User extends Component &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    const &#123; user &#125; = this.props</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;div&gt;å§“åï¼š&#123;user.username&#125;&lt;/div&gt;</span><br><span class="line">        &lt;div&gt;å¹´é¾„ï¼š&#123;user.age&#125;&lt;/div&gt;</span><br><span class="line">        &lt;div&gt;æ€§åˆ«ï¼š&#123;user.gender&#125;&lt;/div&gt;</span><br><span class="line">        &lt;hr /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Index extends Component &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &#123;users.map((user) =&gt; &lt;User user=&#123;user&#125; /&gt;)&#125;</span><br><span class="line">        &lt;!-- &#123;users.map((user, i) =&gt; &lt;User key=&#123;i&#125; user=&#123;user&#125; /&gt;)&#125; --&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;Index /&gt;,</span><br><span class="line">  document.getElementById(&apos;root&apos;)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>ä½†æ˜¯è¦æ³¨æ„<br>å¯¹äºç”¨è¡¨è¾¾å¼å¥—æ•°ç»„ç½—åˆ—åˆ°é¡µé¢ä¸Šçš„å…ƒç´ ï¼Œéƒ½è¦ä¸ºæ¯ä¸ªå…ƒç´ åŠ ä¸Š key å±æ€§ï¼Œè¿™ä¸ª key å¿…é¡»æ˜¯æ¯ä¸ªå…ƒç´ å”¯ä¸€çš„æ ‡è¯†<br>è¿™é‡Œç”¨å¾ªç¯è®¡æ•°å™¨ i ä½œä¸º keyå¯¹å¾ªç¯æ ‡ç­¾Useræ·»åŠ key,å°±ä¸ä¼šæŠ¥éœ€è¦keyçš„é”™äº†<br>{users.map((user) =&gt; <user user="\{user\}">)} å˜æˆ {users.map((user, i) =&gt; <user key="\{i\}" user="\{user\}">)}</user></user></p>
<h1 id="å—æ§ç»„ä»¶"><a href="#å—æ§ç»„ä»¶" class="headerlink" title="å—æ§ç»„ä»¶"></a>å—æ§ç»„ä»¶</h1><p>ç±»ä¼¼äº &lt;input /&gt;ã€&lt;select /&gt;ã€&lt;textarea&gt; è¿™äº›å…ƒç´ çš„ value å€¼è¢« React.js æ‰€æ§åˆ¶ã€æ¸²æŸ“çš„ç»„ä»¶ï¼Œåœ¨ React.js å½“ä¸­è¢«ç§°ä¸ºå—æ§ç»„ä»¶ï¼ˆControlled Componentï¼‰ã€‚å¯¹äºç”¨æˆ·å¯è¾“å…¥çš„æ§ä»¶ï¼Œä¸€èˆ¬éƒ½å¯ä»¥è®©å®ƒä»¬æˆä¸ºå—æ§ç»„ä»¶.<br>React.js è®¤ä¸ºæ‰€æœ‰çš„çŠ¶æ€éƒ½åº”è¯¥ç”± React.js çš„ state æ§åˆ¶ï¼Œåªè¦ç±»ä¼¼äº &lt;input /&gt;ã€&lt;textarea /&gt;ã€&lt;select /&gt; è¿™æ ·çš„è¾“å…¥æ§ä»¶è¢«è®¾ç½®äº† value å€¼ï¼Œé‚£ä¹ˆå®ƒä»¬çš„å€¼ç­‰äºstateçš„ä¸€ä¸ªå±æ€§å€¼ï¼Œå°±ä¼šæ°¸è¿œä»¥è¢«è®¾ç½®çš„å€¼ä¸ºå‡†ã€‚å€¼ä¸å˜ï¼Œvalue å°±ä¸ä¼šå˜åŒ–ã€‚<br>åœ¨ React.js å½“ä¸­å¿…é¡»è¦ç”¨ setState æ‰èƒ½æ›´æ–°ç»„ä»¶çš„å†…å®¹,æ‰€ä»¥å¯ä»¥é€šè¿‡ç»™è¾“å…¥æ¡†ç»‘å®šç›‘å¬è¾“å…¥æ¡†çš„ onChange äº‹ä»¶ï¼Œç„¶åè·å–åˆ°ç”¨æˆ·è¾“å…¥çš„å†…å®¹ï¼Œå†é€šè¿‡ setState çš„æ–¹å¼æ›´æ–° state ä¸­çš„ valueå±æ€§ç»‘å®šçš„å€¼ï¼Œè¿™æ · è¾“å…¥æ¡†çš„å†…å®¹æ‰ä¼šæ›´æ–°ã€‚</p>
<p>å­ç»„ä»¶å¯ä»¥åˆ©ç”¨propså‘çˆ¶ç»„ä»¶ä¼ é€’æ•°æ®ï¼Œå³ï¼Œçˆ¶ç»„ä»¶åœ¨ä½¿ç”¨å­ç»„ä»¶æ—¶ï¼Œæ·»åŠ å±æ€§Aï¼Œå¹¶å°†è¯¥Aå±æ€§å€¼èµ‹å€¼ä¸ºä¸€ä¸ªçˆ¶ç»„ä»¶çš„å‡½æ•°Bï¼Œ<br>å­ç»„ä»¶åœ¨è§¦å‘æ•°æ®æäº¤çš„æ—¶å€™ï¼Œæ£€æŸ¥è‡ªå·±çš„propsæœ‰æ²¡æœ‰å±æ€§A,å¦‚æœæœ‰çš„è¯ï¼Œå°†æ•°æ®ä»¥å‚æ•°çš„å½¢å¼ï¼Œä¼ é€’ç»™å±æ€§Aï¼Œå³<br>this.props.A({key1:value1,key2â€value2â€¦.})<br>çˆ¶ç»„ä»¶å‡½æ•°Bé€šè¿‡å‡½æ•°å‚æ•°å°±å¯ä»¥è·å¾—ä¼ é€’è¿‡æ¥çš„æ•°æ®</p>
<p>å­ç»„ä»¶ä»çˆ¶ç»„ä»¶è·å–æ•°æ®ï¼ŒåŒæ ·ä½¿ç”¨props,ä¹Ÿå°±æ˜¯è¯´ï¼Œçˆ¶ç»„ä»¶åœ¨ä½¿ç”¨å­ç»„ä»¶çš„æ—¶å€™æŠŠè‡ªå·±çš„stateçš„ä¸€ä¸ªå±æ€§Cèµ‹å€¼ç»™å­ç»„ä»¶çš„å±æ€§D,<br>å­ç»„ä»¶é€šè¿‡å±æ€§Dè·å–çˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„æ•°æ®,åœ¨å­ç»„ä»¶ä¸­ç›´æ¥ä½¿ç”¨props.Dçš„å€¼ï¼Œä½†è¦æ³¨æ„ç»™å­ç»„ä»¶è®¾ç½®defaultPropsï¼Œç»™å±æ€§Dä¸€ä¸ªé»˜è®¤å€¼ï¼Œé˜²æ­¢å‡ºç°ä¸ä¼ å€¼çš„æƒ…å†µ<br>è¿™ç§è¡Œä¸ºå«åšâ€œçŠ¶æ€æå‡â€<br>å¦‚æœå°†å±æ€§Dçš„å€¼ï¼Œå†ä¿å­˜åˆ°å­ç»„ä»¶çš„stateä¸­åœ¨ä½¿ç”¨ï¼Œé‚£ä¹ˆå½“å…¶ä»–ç»„ä»¶ä¹Ÿéœ€è¦è¿™ä»½æ•°æ®çš„æ—¶å€™ï¼Œå°†æ— æ³•ä½¿ç”¨ï¼Œå› ä¸ºæ ¹æœ¬æ²¡åŠæ³•è®¿é—®,å› æ­¤é‡‡ç”¨ä½¿ç”¨propså€¼çš„åŠæ³•ï¼Œå°†è¿™ç§ç»„ä»¶ä¹‹é—´å…±äº«çš„çŠ¶æ€äº¤ç»™ç»„ä»¶æœ€è¿‘çš„å…¬å…±çˆ¶èŠ‚ç‚¹ä¿ç®¡ï¼Œç„¶åé€šè¿‡ props æŠŠçŠ¶æ€ä¼ é€’ç»™å­ç»„ä»¶ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ç»„ä»¶ä¹‹é—´å…±äº«æ•°æ®äº†</p>
<p>å½“æŸä¸ªçŠ¶æ€è¢«å¤šä¸ªç»„ä»¶ä¾èµ–æˆ–è€…å½±å“çš„æ—¶å€™ï¼Œå°±æŠŠè¯¥çŠ¶æ€æå‡åˆ°è¿™äº›ç»„ä»¶çš„æœ€è¿‘å…¬å…±çˆ¶ç»„ä»¶ä¸­å»ç®¡ç†ï¼Œç”¨ props ä¼ é€’æ•°æ®æˆ–è€…å‡½æ•°æ¥ç®¡ç†è¿™ç§ä¾èµ–æˆ–ç€å½±å“çš„è¡Œä¸ºã€‚<br>å¯¹äºä¸ä¼šè¢«å¤šä¸ªç»„ä»¶ä¾èµ–å’Œå½±å“çš„çŠ¶æ€ï¼ˆä¾‹å¦‚æŸç§ä¸‹æ‹‰èœå•çš„å±•å¼€å’Œæ”¶èµ·çŠ¶æ€ï¼‰ï¼Œä¸€èˆ¬æ¥è¯´åªéœ€è¦ä¿å­˜åœ¨ç»„ä»¶å†…éƒ¨å³å¯ï¼Œä¸éœ€è¦åšæå‡æˆ–è€…ç‰¹æ®Šçš„ç®¡ç†ã€‚</p>
<h1 id="ç”Ÿå‘½å‘¨æœŸ"><a href="#ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸ"></a>ç”Ÿå‘½å‘¨æœŸ</h1><h2 id="æŒ‚è½½"><a href="#æŒ‚è½½" class="headerlink" title="æŒ‚è½½"></a>æŒ‚è½½</h2><p>React.js å°†ç»„ä»¶æ¸²æŸ“ï¼Œå¹¶ä¸”æ„é€  DOM å…ƒç´ ç„¶åå¡å…¥é¡µé¢çš„è¿‡ç¨‹ç§°ä¸ºç»„ä»¶çš„æŒ‚è½½<br>æŒ‚è½½è¿‡ç¨‹:<br>-&gt; constructor() //è‡ªèº«çš„çŠ¶æ€çš„åˆå§‹åŒ–å·¥ä½œ<br>-&gt; componentWillMount()//ç»„ä»¶è¿˜æ²¡æŒ‚è½½å®Œæˆæ—¶è¿›è¡Œçš„ç»„ä»¶å¯åŠ¨å·¥ä½œï¼Œä¾‹å¦‚ Ajax æ•°æ®æ‹‰å–ã€å®šæ—¶å™¨çš„å¯åŠ¨ã€‚<br>-&gt; render()<br>// ç„¶åæ„é€  DOM å…ƒç´ æ’å…¥é¡µé¢<br>-&gt; componentDidMount() //ç»„ä»¶æŒ‚è½½å®Œæˆä»¥åï¼Œä¹Ÿå°±æ˜¯ DOM å…ƒç´ å·²ç»æ’å…¥é¡µé¢åè°ƒç”¨ã€‚è¿›è¡Œä¾èµ–DOMçš„å¯åŠ¨å·¥ä½œ<br>// â€¦<br>// å³å°†ä»é¡µé¢ä¸­åˆ é™¤, setState åªèƒ½åœ¨å·²ç»æŒ‚è½½æˆ–è€…æ­£åœ¨æŒ‚è½½çš„ç»„ä»¶ä¸Šè°ƒç”¨,<br>//ç»„ä»¶éšè—çš„æ—¶å€™ï¼Œç»„ä»¶çš„å›è°ƒå‡½æ•°å¯èƒ½è¿˜åœ¨ä¸åœåœ°å°è¯• setState,å› æ­¤ä¼šæŠ¥é”™<br>-&gt; componentWillUnmount() //ç»„ä»¶å¯¹åº”çš„ DOM å…ƒç´ ä»é¡µé¢ä¸­åˆ é™¤ä¹‹å‰è°ƒç”¨,å¤„ç†æ•°æ®æ¸…ç†å·¥ä½œï¼Œå¦‚å®šæ—¶å™¨çš„æ¸…ç†<br>// ä»é¡µé¢ä¸­åˆ é™¤</p>
<h2 id="æ›´æ–°é˜¶æ®µ"><a href="#æ›´æ–°é˜¶æ®µ" class="headerlink" title="æ›´æ–°é˜¶æ®µ"></a>æ›´æ–°é˜¶æ®µ</h2><p> setState å¯¼è‡´ React.js é‡æ–°æ¸²æŸ“ç»„ä»¶å¹¶ä¸”æŠŠç»„ä»¶çš„å˜åŒ–åº”ç”¨åˆ° DOM å…ƒç´ ä¸Šçš„è¿‡ç¨‹ï¼Œè¿™æ˜¯ä¸€ä¸ªç»„ä»¶çš„å˜åŒ–è¿‡ç¨‹ã€‚è€Œ React.js ä¹Ÿæä¾›äº†ä¸€ç³»åˆ—çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°å¯ä»¥è®©æˆ‘ä»¬åœ¨è¿™ä¸ªç»„ä»¶æ›´æ–°çš„è¿‡ç¨‹æ‰§è¡Œä¸€äº›æ“ä½œã€‚<br> å…³äºæ›´æ–°é˜¶æ®µçš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸï¼š<br>shouldComponentUpdate(nextProps, nextState)ï¼šä½ å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹æ³•æ§åˆ¶ç»„ä»¶æ˜¯å¦é‡æ–°æ¸²æŸ“ã€‚å¦‚æœè¿”å› false ç»„ä»¶å°±ä¸ä¼šé‡æ–°æ¸²æŸ“ã€‚è¿™ä¸ªç”Ÿå‘½å‘¨æœŸåœ¨ React.js æ€§èƒ½ä¼˜åŒ–ä¸Šéå¸¸æœ‰ç”¨ã€‚<br>componentWillReceiveProps(nextProps)ï¼šç»„ä»¶ä»çˆ¶ç»„ä»¶æ¥æ”¶åˆ°æ–°çš„ props ä¹‹å‰è°ƒç”¨ã€‚<br>componentWillUpdate()ï¼šç»„ä»¶å¼€å§‹é‡æ–°æ¸²æŸ“ä¹‹å‰è°ƒç”¨ã€‚<br>componentDidUpdate()ï¼šç»„ä»¶é‡æ–°æ¸²æŸ“å¹¶ä¸”æŠŠæ›´æ”¹å˜æ›´åˆ°çœŸå®çš„ DOM ä»¥åè°ƒç”¨ã€‚<br><a href="https://reactjs.org/docs/react-component.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></p>
<h1 id="refå±æ€§"><a href="#refå±æ€§" class="headerlink" title="refå±æ€§"></a>refå±æ€§</h1><p>é€šè¿‡åœ¨htmlæ ‡ç­¾æˆ–è‡ªå®šä¹‰çš„ç»„ä»¶æ ‡ç­¾ä¸­æ·»åŠ  refå±æ€§ï¼Œå¯ä»¥ç»‘å®šDOMæ“ä½œ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">class AutoFocusInput extends Component &#123;</span><br><span class="line">  componentDidMount () &#123; //åˆ©ç”¨ç»„ä»¶å£°æ˜å‘¨æœŸå‡½æ•°</span><br><span class="line">    this.input.focus() //è¿™é‡Œçš„this.inputå°±æ˜¯é¡µé¢é‡Œçš„DOMå…ƒç´ ï¼Œå› æ­¤å¯ä»¥ç›´æ¥ä½¿ç”¨DOM API</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render () &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;input ref=&#123;(input) =&gt; this.input = input&#125; /&gt; //æŠŠinputæ ‡ç­¾DOMå…ƒç´ æŒ‚åˆ°ç»„ä»¶çš„å±æ€§inputä¸Š</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>input å…ƒç´ åŠ äº†ä¸€ä¸ª ref å±æ€§ï¼Œè¿™ä¸ªå±æ€§å€¼æ˜¯ä¸€ä¸ªå‡½æ•°,<br>å½“ input å…ƒç´ åœ¨é¡µé¢ä¸ŠæŒ‚è½½å®Œæˆä»¥åï¼ŒReact.js å°±ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°,å‡½æ•°çš„å‚æ•°ï¼Œå°±æ˜¯æŒ‚è½½ä»¥åçš„DOMç»“ç‚¹<br>åœ¨å‡½æ•°ä¸­æŠŠè¿™ä¸ª DOM å…ƒç´ è®¾ç½®ä¸ºç»„ä»¶å®ä¾‹çš„ä¸€ä¸ªå±æ€§ï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡ this.input è·å–åˆ°è¿™ä¸ª DOM å…ƒç´ ã€‚</p>
<p>ä½†æ³¨æ„,èƒ½ä¸ç”¨ ref å°±ä¸ç”¨ï¼Œå› ä¸ºReact.js æœ¬æ¥å°±å¯ä»¥åšåˆ°çš„é¡µé¢è‡ªåŠ¨æ›´æ–°çš„æ“ä½œå’Œäº‹ä»¶ç›‘å¬ï¼Œå¤šä½™DOMæ“ä½œï¼Œä¸åˆ©äºç†è§£å’Œç»´æŠ¤</p>
<h1 id="dangerouslySetHTML"><a href="#dangerouslySetHTML" class="headerlink" title="dangerouslySetHTML"></a>dangerouslySetHTML</h1><p>dangerouslySetInnerHTML å±æ€§å¯ä»¥ç”¨äºåŠ¨æ€æ¸²æŸ“HTMLç»“æ„,å³å°†HTMLå­—ç¬¦ä¸²ï¼Œåœ¨é¡µé¢ä¸­æ˜¾ç¤ºæ—¶,å½“åšHTMLå»æ¸²æŸ“<br>ç»™ dangerouslySetInnerHTML ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„ __html å±æ€§å€¼å°±ç›¸å½“äºå…ƒç´ çš„ innerHTMLï¼Œè¿™æ ·å°±å¯ä»¥åŠ¨æ€æ¸²æŸ“å…ƒç´ çš„ innerHTML ç»“æ„äº†<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">constructor() &#123;</span><br><span class="line">    super()</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      content: &apos;&lt;h1&gt;React.js cool!&lt;/h1&gt;&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">render () &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div</span><br><span class="line">        className=&apos;editor-wrapper&apos;</span><br><span class="line">        dangerouslySetInnerHTML=&#123;&#123;__html: this.state.content&#125;&#125; /&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>å› ä¸ºè®¾ç½® innerHTML å¯èƒ½ä¼šå¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ï¼Œæ‰€ä»¥ React.js å›¢é˜Ÿè®¤ä¸ºæŠŠäº‹æƒ…æå¤æ‚å¯ä»¥é˜²æ­¢ï¼ˆè­¦ç¤ºï¼‰å¤§å®¶æ»¥ç”¨è¿™ä¸ªå±æ€§ã€‚è¿™ä¸ªå±æ€§ä¸å¿…è¦çš„æƒ…å†µå°±ä¸è¦ä½¿ç”¨</p>
<h1 id="style"><a href="#style" class="headerlink" title="style"></a>style</h1><p>åœ¨ React.js ä¸­éœ€è¦æŠŠ CSS å±æ€§å˜æˆä¸€ä¸ªå¯¹è±¡å†ä¼ ç»™å…ƒç´ <br>style æ¥å—ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡é‡Œé¢æ˜¯è¿™ä¸ªå…ƒç´ çš„ CSS å±æ€§é”®å€¼å¯¹ï¼ŒåŸæ¥ CSS å±æ€§ä¸­å¸¦ - çš„å…ƒç´ éƒ½å¿…é¡»è¦å»æ‰ - æ¢æˆé©¼å³°å‘½åï¼Œå¦‚ font-size æ¢æˆ fontSizeï¼Œtext-align æ¢æˆ textAlignã€‚<br>ç”¨å¯¹è±¡ä½œä¸º style æ–¹ä¾¿åŠ¨æ€è®¾ç½®å…ƒç´ çš„æ ·å¼ã€‚å¯ä»¥ç”¨ props æˆ–è€… state ä¸­çš„æ•°æ®ç”Ÿæˆæ ·å¼å¯¹è±¡å†ä¼ ç»™å…ƒç´ ï¼Œç„¶åç”¨ setState å°±å¯ä»¥ä¿®æ”¹æ ·å¼ï¼Œéå¸¸çµæ´»</p>
<p>&lt;h1 style={ {fontSize: â€˜12pxâ€™, color: this.state.color} }&gt;React.js color&lt;/h1&gt;</p>
<h1 id="PropTypes-ç»„ä»¶å‚æ•°ç±»å‹éªŒè¯"><a href="#PropTypes-ç»„ä»¶å‚æ•°ç±»å‹éªŒè¯" class="headerlink" title="PropTypes ç»„ä»¶å‚æ•°ç±»å‹éªŒè¯"></a>PropTypes ç»„ä»¶å‚æ•°ç±»å‹éªŒè¯</h1><p>ç»™ç»„ä»¶çš„é…ç½®å‚æ•°åŠ ä¸Šç±»å‹éªŒè¯,å°±å¯ä»¥éªŒè¯ä¼ è¿›ç»„ä»¶çš„å‚æ•°æ˜¯å¦ç¬¦åˆé¢„å®šçš„æ•°æ®ç±»å‹ï¼ŒæŠ¥é”™ä¹Ÿèƒ½å®šä½é—®é¢˜<br>PropTypeså°±æ˜¯reactç¬¬ä¸‰æ–¹åº“ï¼Œç”¨äºéªŒè¯å‚æ•°ç±»å‹ï¼Œå³éªŒè¯ä¼ å…¥ç»„ä»¶çš„æ•°æ®çš„æ•°æ®ç±»å‹<br>npm install â€“save prop-types<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &apos;react&apos;</span><br><span class="line">import PropTypes from &apos;prop-types&apos;</span><br><span class="line"></span><br><span class="line">class Comment extends Component &#123;</span><br><span class="line">  static propTypes = &#123;</span><br><span class="line">    comment: PropTypes.object //æŒ‡å®šä¼ å…¥commentçš„ç±»å‹å¿…é¡»ä¸ºObject</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render () &#123;</span><br><span class="line">    const &#123; comment &#125; = this.props</span><br><span class="line">    return (</span><br><span class="line">      &lt;div className=&apos;comment&apos;&gt;</span><br><span class="line">        &lt;div className=&apos;comment-user&apos;&gt;</span><br><span class="line">          &lt;span&gt;&#123;comment.username&#125; &lt;/span&gt;ï¼š</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;p&gt;&#123;comment.content&#125;&lt;/p&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>propTypes æŒ‡å®šäº†å‚æ•°ç±»å‹ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰è¯´è¿™ä¸ªå‚æ•°ä¸€å®šè¦ä¼ å…¥ï¼Œäº‹å®ä¸Šï¼Œè¿™äº›å‚æ•°é»˜è®¤éƒ½æ˜¯å¯é€‰çš„ã€‚å¯é€‰å‚æ•°å¯ä»¥é€šè¿‡é…ç½® defaultPropsï¼Œè®©å®ƒåœ¨ä¸ä¼ å…¥çš„æ—¶å€™æœ‰é»˜è®¤å€¼ã€‚<br>ä½†æ˜¯è¿™é‡Œå¹¶æ²¡æœ‰é…ç½® defaultPropsï¼Œæ‰€ä»¥å¦‚æœç›´æ¥ç”¨&lt;Comment /&gt; è€Œä¸ä¼ å…¥ä»»ä½•å‚æ•°çš„è¯ï¼Œcomment å°±ä¼šæ˜¯ undefinedï¼Œ<br>å¯ä»¥é€šè¿‡ isRequired å…³é”®å­—æ¥å¼ºåˆ¶ç»„ä»¶æŸä¸ªå‚æ•°å¿…é¡»ä¼ å…¥<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">static propTypes = &#123;</span><br><span class="line">  comment: PropTypes.object.isRequired</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>React.js æä¾›çš„ PropTypes æä¾›äº†ä¸€ç³»åˆ—çš„æ•°æ®ç±»å‹å¯ä»¥ç”¨æ¥é…ç½®ç»„ä»¶çš„å‚æ•°ï¼š<br>PropTypes.array<br>PropTypes.bool<br>PropTypes.func<br>PropTypes.number<br>PropTypes.object<br>PropTypes.string<br>PropTypes.node<br>PropTypes.element</p>
<p><a href="https://reactjs.org/docs/typechecking-with-proptypes.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></p>
<h1 id="å»ºè®®å‘½åå’Œå®šä¹‰é¡ºåº"><a href="#å»ºè®®å‘½åå’Œå®šä¹‰é¡ºåº" class="headerlink" title="å»ºè®®å‘½åå’Œå®šä¹‰é¡ºåº"></a>å»ºè®®å‘½åå’Œå®šä¹‰é¡ºåº</h1><p>ç»„ä»¶çš„ç§æœ‰æ–¹æ³•éƒ½ç”¨ _ å¼€å¤´<br>æ‰€æœ‰äº‹ä»¶ç›‘å¬çš„æ–¹æ³•éƒ½ç”¨ handle å¼€å¤´<br>æŠŠäº‹ä»¶ç›‘å¬æ–¹æ³•ä¼ ç»™ç»„ä»¶çš„æ—¶å€™ï¼Œå±æ€§åç”¨ on å¼€å¤´</p>
<p>ç»„ä»¶çš„å†…å®¹ç¼–å†™é¡ºåºå¦‚ä¸‹ï¼š</p>
<p>static å¼€å¤´çš„ç±»å±æ€§ï¼Œå¦‚ defaultPropsã€propTypesã€‚<br>æ„é€ å‡½æ•°ï¼Œconstructorã€‚<br>getter/setterã€‚<br>ç»„ä»¶ç”Ÿå‘½å‘¨æœŸã€‚<br>_ å¼€å¤´çš„ç§æœ‰æ–¹æ³•ã€‚<br>äº‹ä»¶ç›‘å¬æ–¹æ³•ï¼Œhandle<em>ã€‚<br>render</em>å¼€å¤´çš„æ–¹æ³•ï¼Œæœ‰æ—¶å€™ render() æ–¹æ³•é‡Œé¢çš„å†…å®¹ä¼šåˆ†å¼€åˆ°ä¸åŒå‡½æ•°é‡Œé¢è¿›è¡Œï¼Œè¿™äº›å‡½æ•°éƒ½ä»¥ render* å¼€å¤´ã€‚<br>render() æ–¹æ³•ã€‚</p>
<h1 id="é«˜é˜¶ç»„ä»¶"><a href="#é«˜é˜¶ç»„ä»¶" class="headerlink" title="é«˜é˜¶ç»„ä»¶"></a>é«˜é˜¶ç»„ä»¶</h1><p>é«˜é˜¶ç»„ä»¶å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¼ ç»™å®ƒä¸€ä¸ªç»„ä»¶ï¼Œå®ƒè¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶,è¿”å›çš„è¿™ä¸ªæ–°çš„ç»„ä»¶ä½¿ç”¨ä¼ å…¥çš„ç»„ä»¶ä½œä¸ºå­ç»„ä»¶ã€‚</p>
<p>é«˜é˜¶ç»„ä»¶å†…éƒ¨çš„åŒ…è£…ç»„ä»¶å’Œè¢«åŒ…è£…ç»„ä»¶ä¹‹é—´é€šè¿‡ props ä¼ é€’æ•°æ®ã€‚</p>
<p>å¤šå±‚é«˜é˜¶ç»„ä»¶ä½¿ç”¨æ—¶ï¼Œthis.propsæ˜¯ä»å¤–å‘é‡Œä¼ é€’çš„ï¼Œå³Aç»„ä»¶å…ˆåè¢«B,C,Dç»„ä»¶ç»„è£…ï¼Œåˆ™this.propsåˆ°è¾¾Aç»„ä»¶çš„é¡ºåºæ˜¯D,C,B,A</p>
<p>é«˜é˜¶ç»„ä»¶çš„ä½œç”¨æ˜¯ç”¨äºä»£ç å¤ç”¨ï¼Œå¯ä»¥æŠŠç»„ä»¶ä¹‹é—´å¯å¤ç”¨çš„ä»£ç ã€é€»è¾‘æŠ½ç¦»åˆ°é«˜é˜¶ç»„ä»¶å½“ä¸­ã€‚</p>
<p>é«˜é˜¶ç»„ä»¶æœ‰åŠ©äºæé«˜æˆ‘ä»¬ä»£ç çš„çµæ´»æ€§ï¼Œé€»è¾‘çš„å¤ç”¨æ€§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">//é«˜é˜¶ç»„ä»¶wrapWithLoadData ,</span><br><span class="line">import React, &#123; Component &#125; from &apos;react&apos;</span><br><span class="line"></span><br><span class="line">export default (WrappedComponent, name) =&gt; &#123;</span><br><span class="line">  class NewComponent extends Component &#123;</span><br><span class="line">    constructor () &#123;</span><br><span class="line">      super()</span><br><span class="line">      this.state = &#123; data: null &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    componentWillMount () &#123;</span><br><span class="line">      let data = localStorage.getItem(name)  //å¦‚æœæ”¹å˜æ•°æ®è·å–æ–¹å¼,å¯ä»¥ä¿®æ”¹è¿™é‡Œ</span><br><span class="line">      this.setState(&#123; data &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    //åœ¨æ­¤ä¹‹å‰ï¼Œå¯ä»¥åšå¾ˆå¤šè‡ªå®šä¹‰é€»è¾‘</span><br><span class="line">    render () &#123;</span><br><span class="line">      return &lt;WrappedComponent data=&#123;this.state.data&#125; /&gt;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return NewComponent</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//ä½¿ç”¨</span><br><span class="line">import wrapWithLoadData from &apos;./wrapWithLoadData&apos;</span><br><span class="line"></span><br><span class="line">class InputWithUserName extends Component &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    return &lt;input value=&#123;this.props.data&#125; /&gt;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">InputWithUserName = wrapWithLoadData(InputWithUserName, &apos;username&apos;) //ç»„ä»¶InputWithUserNameä»¥å‚æ•°ä¼ å…¥wrapWithLoadDataï¼Œè¿›è¡ŒåŒ…è£…</span><br><span class="line">export default InputWithUserName</span><br></pre></td></tr></table></figure>
<h1 id="context"><a href="#context" class="headerlink" title="context"></a>context</h1><p>ä¸€ä¸ªç»„ä»¶å¯ä»¥é€šè¿‡ getChildContext æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯å­æ ‘çš„ contextï¼Œæä¾› context çš„ç»„ä»¶å¿…é¡»æä¾› childContextTypes ä½œä¸º context çš„å£°æ˜å’ŒéªŒè¯ã€‚</p>
<p>å¦‚æœä¸€ä¸ªç»„ä»¶è®¾ç½®äº† contextï¼Œé‚£ä¹ˆå®ƒçš„å­ç»„ä»¶éƒ½å¯ä»¥ç›´æ¥è®¿é—®åˆ°é‡Œé¢çš„å†…å®¹ï¼Œå®ƒå°±åƒè¿™ä¸ªç»„ä»¶ä¸ºæ ¹çš„å­æ ‘çš„å…¨å±€å˜é‡ã€‚ä»»æ„æ·±åº¦çš„å­ç»„ä»¶éƒ½å¯ä»¥é€šè¿‡ contextTypes æ¥å£°æ˜ä½ æƒ³è¦çš„ context é‡Œé¢çš„å“ªäº›çŠ¶æ€ï¼Œç„¶åå¯ä»¥é€šè¿‡ this.context è®¿é—®åˆ°é‚£äº›çŠ¶æ€ã€‚</p>
<p>context æ‰“ç ´äº†ç»„ä»¶å’Œç»„ä»¶ä¹‹é—´é€šè¿‡ props ä¼ é€’æ•°æ®çš„è§„èŒƒï¼Œæå¤§åœ°å¢å¼ºäº†ç»„ä»¶ä¹‹é—´çš„è€¦åˆæ€§ã€‚è€Œä¸”ï¼Œå°±å¦‚å…¨å±€å˜é‡ä¸€æ ·ï¼Œcontext é‡Œé¢çš„æ•°æ®èƒ½è¢«éšæ„æ¥è§¦å°±èƒ½è¢«éšæ„ä¿®æ”¹ï¼Œæ¯ä¸ªç»„ä»¶éƒ½èƒ½å¤Ÿæ”¹ context é‡Œé¢çš„å†…å®¹ä¼šå¯¼è‡´ç¨‹åºçš„è¿è¡Œä¸å¯é¢„æ–™ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">//ç»„ä»¶æ ‘çš„æ ¹ç»„ä»¶</span><br><span class="line">class Index extends Component &#123;</span><br><span class="line">  static childContextTypes = &#123; //éªŒè¯getChildContext è¿”å›çš„å¯¹è±¡  å¿…å†™!!!</span><br><span class="line">    themeColor: PropTypes.string</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  constructor () &#123;</span><br><span class="line">    super()</span><br><span class="line">    this.state = &#123; themeColor: &apos;red&apos; &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  getChildContext () &#123; //è®¾ç½® context,è¿”å›çš„å¯¹è±¡å°±æ˜¯å­ç»„ä»¶çš„this.context</span><br><span class="line">    return &#123; themeColor: this.state.themeColor &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render () &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;Header /&gt;</span><br><span class="line">        &lt;Main /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">//å…¶ä¸­ä¸€å±‚çš„å­ç»„ä»¶</span><br><span class="line">class Title extends Component &#123;</span><br><span class="line">  static contextTypes = &#123; //æ¥å£°æ˜å’ŒéªŒè¯éœ€è¦è·å–çš„contxtå†…å®¹çš„ç±»å‹ å¿…å†™!!!</span><br><span class="line">    themeColor: PropTypes.string</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render () &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;h1 style=&#123;&#123; color: this.context.themeColor &#125;&#125;&gt;React.js å°ä¹¦æ ‡é¢˜&lt;/h1&gt; //ç›´æ¥ä½¿ç”¨this.contexté‡Œé¢çš„å€¼</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="redux-æ¨¡å¼"><a href="#redux-æ¨¡å¼" class="headerlink" title="redux æ¨¡å¼"></a>redux æ¨¡å¼</h1><p>ä»£ç ä¸­å‘ç°äº†å…±äº«çš„çŠ¶æ€å¦‚æœå¯ä»¥è¢«ä»»æ„ä¿®æ”¹çš„è¯ï¼Œé‚£ä¹ˆç¨‹åºçš„è¡Œä¸ºå°†éå¸¸ä¸å¯é¢„æ–™ï¼Œæ‰€ä»¥æé«˜äº†ä¿®æ”¹æ•°æ®çš„é—¨æ§›ï¼šå¿…é¡»é€šè¿‡ dispatch æ‰§è¡ŒæŸäº›å…è®¸çš„ä¿®æ”¹æ“ä½œï¼Œè€Œä¸”å¿…é¡»å¤§å¼ æ——é¼“çš„åœ¨ action é‡Œé¢å£°æ˜ã€‚</p>
<p>è¿™ç§æ¨¡å¼æŒºå¥½ç”¨çš„ï¼Œå°±æŠŠå®ƒæŠ½è±¡å‡ºæ¥ä¸€ä¸ª createStoreï¼Œå®ƒå¯ä»¥äº§ç”Ÿ storeï¼Œé‡Œé¢åŒ…å« getState å’Œ dispatch å‡½æ•°ï¼Œæ–¹ä¾¿ä½¿ç”¨ã€‚</p>
<p>åæ¥å‘ç°æ¯æ¬¡ä¿®æ”¹æ•°æ®éƒ½éœ€è¦æ‰‹åŠ¨é‡æ–°æ¸²æŸ“éå¸¸éº»çƒ¦ï¼Œå› æ­¤å¸Œæœ›è‡ªåŠ¨é‡æ–°æ¸²æŸ“è§†å›¾ã€‚æ‰€ä»¥åæ¥åŠ å…¥äº†è®¢é˜…è€…æ¨¡å¼ï¼Œå¯ä»¥é€šè¿‡ store.subscribe è®¢é˜…æ•°æ®ä¿®æ”¹äº‹ä»¶ï¼Œæ¯æ¬¡æ•°æ®æ›´æ–°çš„æ—¶å€™è‡ªåŠ¨é‡æ–°æ¸²æŸ“è§†å›¾ã€‚</p>
<p>æ¥ä¸‹æ¥å‘ç°äº†åŸæ¥çš„â€œé‡æ–°æ¸²æŸ“è§†å›¾â€æœ‰æ¯”è¾ƒä¸¥é‡çš„æ€§èƒ½é—®é¢˜ï¼ˆæ²¡æœ‰å‘ç”Ÿæ”¹å˜çš„æ•°æ®ä¹Ÿè¿›è¡Œäº†æ¸²æŸ“ï¼‰ï¼Œæˆ‘ä»¬å¼•å…¥äº†â€œå…±äº«ç»“æ„çš„å¯¹è±¡â€æ¥å¸®æˆ‘ä»¬è§£å†³é—®é¢˜ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨æ¯ä¸ªæ¸²æŸ“å‡½æ•°çš„å¼€å¤´è¿›è¡Œç®€å•çš„åˆ¤æ–­é¿å…æ²¡æœ‰è¢«ä¿®æ”¹è¿‡çš„æ•°æ®é‡æ–°æ¸²æŸ“ã€‚</p>
<p>æˆ‘ä»¬ä¼˜åŒ–äº† stateChanger ä¸º reducerï¼Œå®šä¹‰äº† reducer åªèƒ½æ˜¯çº¯å‡½æ•°ï¼ŒåŠŸèƒ½å°±æ˜¯è´Ÿè´£åˆå§‹ stateï¼Œå’Œæ ¹æ® state å’Œ action è®¡ç®—å…·æœ‰å…±äº«ç»“æ„çš„æ–°çš„ stateã€‚</p>
<p>createStore ç°åœ¨å¯ä»¥ç›´æ¥æ‹¿æ¥ç”¨äº†ï¼Œå¥—è·¯å°±æ˜¯ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">function createStore (reducer) &#123;</span><br><span class="line">  let state = null</span><br><span class="line">  const listeners = []</span><br><span class="line">  const subscribe = (listener) =&gt; listeners.push(listener)</span><br><span class="line">  const getState = () =&gt; state</span><br><span class="line">  const dispatch = (action) =&gt; &#123;</span><br><span class="line">    state = reducer(state, action) // è¦†ç›–åŸå¯¹è±¡</span><br><span class="line">    listeners.forEach((listener) =&gt; listener())</span><br><span class="line">  &#125;</span><br><span class="line">  dispatch(&#123;&#125;) // åˆå§‹åŒ– state</span><br><span class="line">  return &#123; getState, dispatch, subscribe &#125;</span><br><span class="line">&#125;</span><br><span class="line">// å®šä¸€ä¸ª reducer</span><br><span class="line">function reducer (state, action) &#123;</span><br><span class="line">  /* åˆå§‹åŒ– state å’Œ switch case */</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ç”Ÿæˆ store</span><br><span class="line">const store = createStore(reducer)</span><br><span class="line"></span><br><span class="line">// ç›‘å¬æ•°æ®å˜åŒ–é‡æ–°æ¸²æŸ“é¡µé¢</span><br><span class="line">store.subscribe(() =&gt; renderApp(store.getState()))</span><br><span class="line"></span><br><span class="line">// é¦–æ¬¡æ¸²æŸ“é¡µé¢</span><br><span class="line">renderApp(store.getState())</span><br><span class="line"></span><br><span class="line">// åé¢å¯ä»¥éšæ„ dispatch äº†ï¼Œé¡µé¢è‡ªåŠ¨æ›´æ–°</span><br><span class="line">store.dispatch(...)</span><br></pre></td></tr></table></figure></p>
<p>ä¾‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">function createStore (reducer) &#123;</span><br><span class="line">  let state = null</span><br><span class="line">  const listeners = []</span><br><span class="line">  const subscribe = (listener) =&gt; listeners.push(listener)</span><br><span class="line">  const getState = () =&gt; state</span><br><span class="line">  const dispatch = (action) =&gt; &#123;</span><br><span class="line">    state = reducer(state, action) // è¦†ç›–åŸå¯¹è±¡</span><br><span class="line">    listeners.forEach((listener) =&gt; listener())</span><br><span class="line">  &#125;</span><br><span class="line">  dispatch(&#123;&#125;) // åˆå§‹åŒ– state</span><br><span class="line">  return &#123; getState, dispatch, subscribe &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function renderApp (newAppState, oldAppState = &#123;&#125;) &#123; // é˜²æ­¢ oldAppState æ²¡æœ‰ä¼ å…¥ï¼Œæ‰€ä»¥åŠ äº†é»˜è®¤å‚æ•° oldAppState = &#123;&#125;</span><br><span class="line">  if (newAppState === oldAppState) return // æ•°æ®æ²¡æœ‰å˜åŒ–å°±ä¸æ¸²æŸ“äº†</span><br><span class="line">  console.log(&apos;render app...&apos;)</span><br><span class="line">  renderTitle(newAppState.title, oldAppState.title)</span><br><span class="line">  renderContent(newAppState.content, oldAppState.content)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function renderTitle (newTitle, oldTitle = &#123;&#125;) &#123;</span><br><span class="line">  if (newTitle === oldTitle) return // æ•°æ®æ²¡æœ‰å˜åŒ–å°±ä¸æ¸²æŸ“äº†</span><br><span class="line">  console.log(&apos;render title...&apos;)</span><br><span class="line">  const titleDOM = document.getElementById(&apos;title&apos;)</span><br><span class="line">  titleDOM.innerHTML = newTitle.text</span><br><span class="line">  titleDOM.style.color = newTitle.color</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function renderContent (newContent, oldContent = &#123;&#125;) &#123;</span><br><span class="line">  if (newContent === oldContent) return // æ•°æ®æ²¡æœ‰å˜åŒ–å°±ä¸æ¸²æŸ“äº†</span><br><span class="line">  console.log(&apos;render content...&apos;)</span><br><span class="line">  const contentDOM = document.getElementById(&apos;content&apos;)</span><br><span class="line">  contentDOM.innerHTML = newContent.text</span><br><span class="line">  contentDOM.style.color = newContent.color</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function stateChanger (state, action) &#123;</span><br><span class="line">   if (!state) &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      title: &#123;</span><br><span class="line">        text: &apos;React.js lalalal&apos;,</span><br><span class="line">        color: &apos;red&apos;,</span><br><span class="line">      &#125;,</span><br><span class="line">      content: &#123;</span><br><span class="line">        text: &apos;React.js content&apos;,</span><br><span class="line">        color: &apos;blue&apos;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  switch (action.type) &#123;</span><br><span class="line">    case &apos;UPDATE_TITLE_TEXT&apos;:</span><br><span class="line">      return &#123; // æ„å»ºæ–°çš„å¯¹è±¡å¹¶ä¸”è¿”å›</span><br><span class="line">        ...state,</span><br><span class="line">        title: &#123;</span><br><span class="line">          ...state.title,</span><br><span class="line">          text: action.text</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    case &apos;UPDATE_TITLE_COLOR&apos;:</span><br><span class="line">      return &#123; // æ„å»ºæ–°çš„å¯¹è±¡å¹¶ä¸”è¿”å›</span><br><span class="line">        ...state,</span><br><span class="line">        title: &#123;</span><br><span class="line">          ...state.title,</span><br><span class="line">          color: action.color</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    default:</span><br><span class="line">      return state // æ²¡æœ‰ä¿®æ”¹ï¼Œè¿”å›åŸæ¥çš„å¯¹è±¡</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const store = createStore(stateChanger)</span><br><span class="line">let oldState = store.getState() // ç¼“å­˜æ—§çš„ state</span><br><span class="line">store.subscribe(() =&gt; &#123;</span><br><span class="line">  const newState = store.getState() // æ•°æ®å¯èƒ½å˜åŒ–ï¼Œè·å–æ–°çš„ state</span><br><span class="line">  renderApp(newState, oldState) // æŠŠæ–°æ—§çš„ state ä¼ è¿›å»æ¸²æŸ“</span><br><span class="line">  oldState = newState // æ¸²æŸ“å®Œä»¥åï¼Œæ–°çš„ newState å˜æˆäº†æ—§çš„ oldStateï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡æ•°æ®å˜åŒ–é‡æ–°æ¸²æŸ“</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">renderApp(store.getState()) // é¦–æ¬¡æ¸²æŸ“é¡µé¢</span><br><span class="line">store.dispatch(&#123; type: &apos;UPDATE_TITLE_TEXT&apos;, text: &apos;ã€ŠReact.js is so cool!ã€‹&apos; &#125;) // ä¿®æ”¹æ ‡é¢˜æ–‡æœ¬</span><br><span class="line">store.dispatch(&#123; type: &apos;UPDATE_TITLE_COLOR&apos;, color: &apos;blue&apos; &#125;) // ä¿®æ”¹æ ‡é¢˜é¢œè‰²</span><br></pre></td></tr></table></figure></p>
<h1 id="react-redux"><a href="#react-redux" class="headerlink" title="react-redux"></a>react-redux</h1><p>ä½¿ç”¨Contextå’Œreduxå®ç°æ ¹æ®å…±äº«çŠ¶æ€è¿›è¡Œå­ç»„ä»¶æ¸²æŸ“çš„å·¥ä½œ</p>
<p><a href="https://github.com/YooHannah/make-react-redux/blob/master/src/index.js" target="_blank" rel="noopener">index.js</a></p>
<p><a href="https://github.com/YooHannah/make-react-redux/blob/master/src/react-redux.js" target="_blank" rel="noopener">react-redux.js</a></p>
<p><a href="https://github.com/YooHannah/make-react-redux/blob/master/src/ThemeSwitch.js" target="_blank" rel="noopener">ThemeSwitch.js</a></p>
<p><a href="https://github.com/YooHannah/make-react-redux/blob/master/src/Content.js" target="_blank" rel="noopener">Content.js</a></p>
<p><a href="https://github.com/YooHannah/make-react-redux/blob/master/src/Header.js" target="_blank" rel="noopener">Header.js</a></p>
<p>ä½¿ç”¨çœŸæ­£çš„react-redux<br>å³<br>import { connect } from â€˜react-reduxâ€™<br>import { createStore } from â€˜reduxâ€™<br>import { Provider } from â€˜react-reduxâ€™</p>
<p>æ ¹æ®æ˜¯å¦éœ€è¦é«˜åº¦çš„å¤ç”¨æ€§ï¼ŒæŠŠç»„ä»¶åˆ’åˆ†ä¸º Dumb å’Œ Smart ç»„ä»¶ï¼Œçº¦å®šä¿—æˆåœ°æŠŠå®ƒä»¬åˆ†åˆ«æ”¾åˆ° components å’Œ containers ç›®å½•ä¸‹ã€‚</p>
<p>Dumb åŸºæœ¬åªåšä¸€ä»¶äº‹æƒ… â€”â€” æ ¹æ® props è¿›è¡Œæ¸²æŸ“ã€‚è€Œ Smart åˆ™æ˜¯è´Ÿè´£åº”ç”¨çš„é€»è¾‘ã€æ•°æ®ï¼ŒæŠŠæ‰€æœ‰ç›¸å…³çš„ Dumbï¼ˆSmartï¼‰ç»„ä»¶ç»„åˆèµ·æ¥ï¼Œé€šè¿‡ props æ§åˆ¶å®ƒä»¬ã€‚</p>
<p>Smart ç»„ä»¶å¯ä»¥ä½¿ç”¨ Smartã€Dumb ç»„ä»¶ï¼›è€Œ Dumb ç»„ä»¶æœ€å¥½åªä½¿ç”¨ Dumb ç»„ä»¶ï¼Œå¦åˆ™å®ƒçš„å¤ç”¨æ€§å°±ä¼šä¸§å¤±ã€‚</p>
<p>è¦æ ¹æ®åº”ç”¨åœºæ™¯ä¸åŒåˆ’åˆ†ç»„ä»¶ï¼Œå¦‚æœä¸€ä¸ªç»„ä»¶å¹¶ä¸éœ€è¦å¤ªå¼ºçš„å¤ç”¨æ€§ï¼Œç›´æ¥è®©å®ƒæˆä¸º Smart å³å¯ï¼›å¦åˆ™å°±è®©å®ƒæˆä¸º Dumb ç»„ä»¶ã€‚</p>
<p>è¿˜æœ‰ä¸€ç‚¹è¦æ³¨æ„ï¼ŒSmart ç»„ä»¶å¹¶ä¸æ„å‘³ç€å®Œå…¨ä¸èƒ½å¤ç”¨ï¼ŒSmart ç»„ä»¶çš„å¤ç”¨æ€§æ˜¯ä¾èµ–åœºæ™¯çš„ï¼Œåœ¨ç‰¹å®šçš„åº”ç”¨åœºæ™¯ä¸‹æ˜¯å½“ç„¶æ˜¯å¯ä»¥å¤ç”¨ Smart çš„ã€‚è€Œ Dumb åˆ™æ˜¯å¯ä»¥è·¨åº”ç”¨åœºæ™¯å¤ç”¨ï¼ŒSmart å’Œ Dumb éƒ½å¯ä»¥å¤ç”¨ï¼Œåªæ˜¯ç¨‹åº¦ã€åœºæ™¯ä¸ä¸€æ ·ã€‚</p>
<p>ä¾‹å¦‚å°†ThemeSwitchæ‹†åˆ†æˆ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">/* src/components/ThemeSwitch.js */</span><br><span class="line">import React, &#123; Component, PropTypes &#125; from &apos;react&apos;</span><br><span class="line"></span><br><span class="line">export default class ThemeSwitch extends Component &#123;</span><br><span class="line">  static propTypes = &#123;</span><br><span class="line">    themeColor: PropTypes.string,</span><br><span class="line">    onSwitchColor: PropTypes.func</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleSwitchColor (color) &#123;</span><br><span class="line">    if (this.props.onSwitchColor) &#123;</span><br><span class="line">      this.props.onSwitchColor(color)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render () &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;button</span><br><span class="line">          style=&#123;&#123; color: this.props.themeColor &#125;&#125;</span><br><span class="line">          onClick=&#123;this.handleSwitchColor.bind(this, &apos;red&apos;)&#125;&gt;Red&lt;/button&gt;</span><br><span class="line">        &lt;button</span><br><span class="line">          style=&#123;&#123; color: this.props.themeColor &#125;&#125;</span><br><span class="line">          onClick=&#123;this.handleSwitchColor.bind(this, &apos;blue&apos;)&#125;&gt;Blue&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* src/containers/ThemeSwitch.js */</span><br><span class="line"></span><br><span class="line">import &#123; connect &#125; from &apos;react-redux&apos;</span><br><span class="line">import ThemeSwitch from &apos;../components/ThemeSwitch&apos;</span><br><span class="line"></span><br><span class="line">const mapStateToProps = (state) =&gt; &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    themeColor: state.themeColor</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">const mapDispatchToProps = (dispatch) =&gt; &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    onSwitchColor: (color) =&gt; &#123;</span><br><span class="line">      dispatch(&#123; type: &apos;CHANGE_COLOR&apos;, themeColor: color &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">export default connect(mapStateToProps, mapDispatchToProps)(ThemeSwitch)</span><br></pre></td></tr></table></figure></p>
<p><a href="http://huziketang.com/books/react/lesson1" target="_blank" rel="noopener">å­¦ä¹ èµ„æ–™é“¾æ¥</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/performance/webpack.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/performance/webpack.html" itemprop="url">
                  å…³äºwebpack
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-10-08T18:37:02+08:00">
                2017-10-08
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h1><p>1.webpackå·¥ä½œå†…å®¹<br>Webpackå¯ä»¥çœ‹åšæ˜¯æ¨¡å—æ‰“åŒ…æœºï¼šå®ƒåšçš„äº‹æƒ…æ˜¯ï¼Œåˆ†æä½ çš„é¡¹ç›®ç»“æ„ï¼Œæ‰¾åˆ°JavaScriptæ¨¡å—ä»¥åŠå…¶å®ƒçš„ä¸€äº›æµè§ˆå™¨ä¸èƒ½ç›´æ¥è¿è¡Œçš„æ‹“å±•è¯­è¨€ï¼ˆScssï¼ŒTypeScriptç­‰ï¼‰ï¼Œå¹¶å°†å…¶è½¬æ¢å’Œæ‰“åŒ…ä¸ºåˆé€‚çš„æ ¼å¼ä¾›æµè§ˆå™¨ä½¿ç”¨ã€‚<br>2.webpackå·¥ä½œæ–¹å¼<br>æŠŠä½ çš„é¡¹ç›®å½“åšä¸€ä¸ªæ•´ä½“ï¼Œé€šè¿‡ä¸€ä¸ªç»™å®šçš„ä¸»æ–‡ä»¶ï¼ˆå¦‚ï¼šindex.jsï¼‰ï¼ŒWebpackå°†ä»è¿™ä¸ªæ–‡ä»¶å¼€å§‹æ‰¾åˆ°ä½ çš„é¡¹ç›®çš„æ‰€æœ‰ä¾èµ–æ–‡ä»¶ï¼Œä½¿ç”¨loaders,pluginså¤„ç†å®ƒä»¬ï¼Œæœ€åæ‰“åŒ…ä¸ºä¸€ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰æµè§ˆå™¨å¯è¯†åˆ«çš„JavaScriptæ–‡ä»¶ã€‚</p>
<h1 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h1><p>1.å¦‚æœåœ¨nodejsä¸­å…¨å±€å®‰è£…äº†webpackå’Œwebpack-dev-server,å¯ä»¥åœ¨git bashç›´æ¥ä½¿ç”¨â€™webpackâ€™å‘½ä»¤è¿›è¡Œæ‰“åŒ…ï¼Œä½¿ç”¨â€™webpack-dev-serverâ€™å‘½ä»¤å¯åŠ¨æ‰“åŒ…åç”Ÿæˆçš„é¡¹ç›®<br>2.åœ¨æ‰“åŒ…ä¹‹å‰,è¦å…ˆé…ç½®webpack.config.jsæ–‡ä»¶,â€™webpackâ€™å‘½ä»¤ä¼šæ ¹æ®webpack.config.jsæ–‡ä»¶çš„é…ç½®é¡¹å»æ‰“åŒ…æ–‡ä»¶<br>3.å¦‚æœæƒ³ä½¿ç”¨ä¸åŒçš„é…ç½®æ–‡ä»¶å»æ‰“åŒ…é¡¹ç›®ï¼Œå¯ä»¥ä½¿ç”¨â€™webpack â€“config æ–‡ä»¶åâ€™å‘½ä»¤å»æ‰“åŒ…<br>4.å¦‚æœä¸æƒ³å¸¦æ–‡ä»¶åå»æ‰“åŒ…,å¯ä»¥åœ¨package.jsonçš„scriptså¯¹è±¡ä¸­é…ç½®å‘½ä»¤â€˜xxxâ€™,ç„¶ååœ¨git bashä¸­ä½¿ç”¨å‘½ä»¤â€˜npm run xxxâ€™è¿›è¡Œæ‰“åŒ…<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;start&quot;: &quot;webpack-dev-server&quot;,</span><br><span class="line">    &quot;build&quot;: &quot;webpack --config webpack.config.build.js&quot;,</span><br><span class="line">    &quot;dev&quot;:&quot;webpack --config webpack.config.dev.js&quot;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>æ‰§è¡Œ npm run build åˆ™æŒ‰ç…§webpack.config.build.jsæ–‡ä»¶é…ç½®çš„å†…å®¹å»æ‰“åŒ…<br>åŒæ ·ï¼Œæ‰§è¡Œ npm run dev åˆ™æŒ‰ç…§webpack.config.dev.jsæ–‡ä»¶é…ç½®çš„å†…å®¹å»æ‰“åŒ…<br>ä½†è¦æ³¨æ„,ä½¿ç”¨é…ç½®å‘½ä»¤â€™startâ€™æ—¶ï¼Œç›´æ¥æ‰§è¡Œâ€™npm startâ€™ï¼Œå°±å¯ä»¥æ‰§è¡Œå…¶å¯¹äºçš„å‘½ä»¤ï¼Œä¸­é—´ä¸éœ€è¦åŠ run</p>
<h1 id="webpack-config-js-é…ç½®"><a href="#webpack-config-js-é…ç½®" class="headerlink" title="webpack.config.js é…ç½®"></a>webpack.config.js é…ç½®</h1><p>module.exports = {}<br>1.é…ç½®æ ¹è·¯å¾„<br>é…ç½®å…¥å£æ–‡ä»¶å‰ï¼Œå¯ä»¥ç”¨contexté…ç½®æ ¹è·¯å¾„ï¼Œè¿™æ ·åœ¨é…ç½®æ—¶ï¼Œå°±ä¸ç”¨å°†æ–‡ä»¶è·¯å¾„å†™è¿›å»ï¼Œç›´æ¥å°†æ–‡ä»¶é…ç½®è¿›å»å°±å¯ä»¥äº†<br>å¯ä»¥å€ŸåŠ©pathæ¨¡å—æ‹¼æ¥è·¯å¾„å­—ç¬¦ä¸²<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&apos;path&apos;)</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">  /**</span><br><span class="line">   * The base directory</span><br><span class="line">   */</span><br><span class="line">  context: path.join(__dirname, &apos;./src&apos;),//è¿™æ ·å…¥å£æ–‡ä»¶å°±æ˜¯æŒ‡srcæ–‡ä»¶å¤¹ä¸‹é¢çš„é‚£äº›æ–‡ä»¶</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>2.å…¥å£æ–‡ä»¶<br>å…¥å£æ–‡ä»¶æ˜¯æŒ‡æ‰“åŒ…åé¡¹ç›®ç”Ÿæˆçš„å¯ä»¥è®¿é—®çš„æ–‡ä»¶<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//å•å…¥å£ï¼š</span><br><span class="line"> entry: &apos;./index.js&apos;,/*æ‰“åŒ…å•ä¸ªæ–‡ä»¶*/</span><br><span class="line"> entry: [&apos;./index1.js&apos;,&apos;./index2.js&apos;],/*æ‰“åŒ…å¤šä¸ªæ–‡ä»¶*/</span><br><span class="line"></span><br><span class="line">//å¤šå…¥å£ï¼š</span><br><span class="line">entry: &#123;</span><br><span class="line">    home: &apos;./home&apos;,</span><br><span class="line">    user: [&apos;./user&apos;, &apos;./account&apos;]</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure></p>
<p>å¤šå…¥å£æ–‡ä»¶æ•°ç»„çš„KEYå€¼å¯ç”¨äºå‘½åè¾“å‡ºæ–‡ä»¶åï¼Œå…¶å¯¹åº”çš„å€¼å³æ˜¯è¦æ‰“åŒ…çš„æºæ–‡ä»¶</p>
<p>3.è¾“å‡ºæ–‡ä»¶<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">output: &#123;</span><br><span class="line"></span><br><span class="line">/* filenameæ–¹å¼ä¸€ï¼šç›´æ¥æŒ‡å®šæ–‡ä»¶å*/</span><br><span class="line">    filename: &apos;bundle.js&apos;,</span><br><span class="line"></span><br><span class="line">/* filenameæ–¹å¼äºŒï¼šæ˜ å°„å˜é‡[name]å’Œ[hash]ï¼Œ[name]å³å®šä¹‰å…¥å£æ–‡ä»¶çš„keyå€¼ï¼Œ[hash]æ˜¯webpackåœ¨æ‰“åŒ…çš„æ—¶å€™æŒ‰ç…§ä¸€å®šè§„åˆ™ç”Ÿæˆçš„å€¼,æ˜¯MD5åŠ å¯†çš„å€¼,å¦‚æœæ–‡ä»¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œhashå€¼ä¸ä¼šå˜,å¯ç”¨äºç‰ˆæœ¬æ§åˆ¶</span><br><span class="line">(CDNä¸€èˆ¬ç¼“å­˜æ—¶é—´æ¯”è¾ƒé•¿ï¼Œæ–‡ä»¶å‘ç”Ÿå˜åŒ–ï¼Œhashå€¼å°±ä¼šå˜ï¼Œæ–‡ä»¶åå°±ä¼šå˜ï¼ŒCDNå°±èƒ½åŠæ—¶æ›´æ–°æ–‡ä»¶)</span><br><span class="line"> * è¿˜å¯ä»¥åŠ [chunkhash],è¿™é‡Œæ˜¯ä½œä¸ºç‰ˆæœ¬å·ä½¿ç”¨ï¼Œæ–¹ä¾¿ä¸Šçº¿æ—¶é™æ€èµ„æºçš„ç‰ˆæœ¬ç®¡ç†</span><br><span class="line"> * å•å…¥å£[name]è¢«æ˜ å°„æˆâ€˜mainâ€™</span><br><span class="line">*/</span><br><span class="line">    filename: &apos;[name].bundle.[hash].js&apos;,</span><br><span class="line"></span><br><span class="line">    path: &apos;/home/proj/public/assets&apos;ï¼Œ/*æŒ‡å®šè¾“å…¥æ–‡ä»¶å­˜æ”¾è·¯å¾„*/</span><br><span class="line">    libraryTargetï¼š</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p><a href="http://www.css88.com/doc/webpack2/concepts/output/" target="_blank" rel="noopener">å…¶ä»–é…ç½®å‚æ•°</a></p>
<p>4.é…ç½®åŠ è½½å™¨loader</p>
<p>loader æ˜¯å¯¹åº”ç”¨ç¨‹åºä¸­èµ„æºæ–‡ä»¶è¿›è¡Œè½¬æ¢ã€‚å®ƒä»¬æ˜¯ï¼ˆè¿è¡Œåœ¨ Node.js ä¸­çš„ï¼‰å‡½æ•°ï¼Œå¯ä»¥å°†èµ„æºæ–‡ä»¶ä½œä¸ºå‚æ•°çš„æ¥æºï¼Œç„¶åè¿”å›æ–°çš„èµ„æºæ–‡ä»¶ã€‚<br><a href="https://webpack.js.org/loaders/" target="_blank" rel="noopener">å®˜æ–¹å¯ç”¨loader</a></p>
<p>Loadersçš„é…ç½®åŒ…æ‹¬ä»¥ä¸‹å‡ æ–¹é¢ï¼š<br>testï¼šä¸€ä¸ªç”¨ä»¥åŒ¹é…loadersæ‰€å¤„ç†æ–‡ä»¶çš„æ‹“å±•åçš„æ­£åˆ™è¡¨è¾¾å¼ï¼ˆå¿…é¡»ï¼‰<br>loaderï¼šloaderçš„åç§°ï¼ˆå¿…é¡»ï¼‰<br>include/exclude:æ‰‹åŠ¨æ·»åŠ å¿…é¡»å¤„ç†çš„æ–‡ä»¶ï¼ˆæ–‡ä»¶å¤¹ï¼‰æˆ–å±è”½ä¸éœ€è¦å¤„ç†çš„æ–‡ä»¶ï¼ˆæ–‡ä»¶å¤¹ï¼‰ï¼ˆå¯é€‰ï¼‰ï¼›<br>queryï¼šä¸ºloadersæä¾›é¢å¤–çš„è®¾ç½®é€‰é¡¹ï¼ˆå¯é€‰ï¼‰</p>
<p>loaderè¢«é…ç½®åœ¨rulesæ•°ç»„ä¸­ï¼Œæ•°ç»„æ¯ä¸€ä¸ªå¯¹è±¡å¯é…ç½®ä¸€ä¸ªæˆ–å¤šä¸ªloader<br>ä¾‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">module: &#123;</span><br><span class="line">   rules: [</span><br><span class="line">     &#123;</span><br><span class="line">       test: /\.js$/,</span><br><span class="line">       include: path.join(__dirname, &apos;./src&apos;),</span><br><span class="line">       use: &apos;babel-loader&apos;</span><br><span class="line">     &#125;</span><br><span class="line">   ]</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure></p>
<p>å¸¸ç”¨loader:<br>babel-loader:ç¼–è¯‘js,è€ƒè™‘åˆ°babelå…·æœ‰éå¸¸å¤šçš„é…ç½®é€‰é¡¹,ä¸€èˆ¬æŠŠbabelçš„é…ç½®é€‰é¡¹æ”¾åœ¨ä¸€ä¸ªå•ç‹¬çš„åä¸º â€œ.babelrcâ€ çš„é…ç½®æ–‡ä»¶ä¸­<br>css-loader:ä½¿ä½ èƒ½å¤Ÿä½¿ç”¨ç±»ä¼¼@import å’Œ url(â€¦)çš„æ–¹æ³•å®ç° require()çš„åŠŸèƒ½,è·å–cssæ–‡ä»¶é‡Œé¢çš„æ ·å¼<br>style-loader:å°†cssæ ·å¼æ’ä»¶jsæ–‡ä»¶ï¼Œä¸css-loaderä¸€èµ·ä½¿ç”¨èƒ½å¤ŸæŠŠæ ·å¼è¡¨åµŒå…¥webpackæ‰“åŒ…åçš„JSæ–‡ä»¶ä¸­<br>autoprefixer-loader:è‡ªåŠ¨æ·»åŠ å‰ç¼€ï¼Œä½¿cssæ–‡ä»¶æ›´æœ‰å…¼å®¹æ€§<br>postcss-loader:cssä¼šè‡ªåŠ¨æ ¹æ®Can i useé‡Œçš„æ•°æ®æ·»åŠ ä¸åŒå‰ç¼€ï¼Œå¯ä¸autoprefixer-loaderç»“åˆä½¿ç”¨<br>ExtractTextPlugin.extract:å°†csså•ç‹¬æ‰“åŒ…æˆä¸€ä¸ª.cssæ–‡ä»¶ï¼Œä½¿ç”¨è¿™ä¸ªæ’ä»¶ï¼Œéœ€è¦require æ’ä»¶extract-text-webpack-plugin<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">//é…ç½®ä»£ç ï¼š</span><br><span class="line">1.</span><br><span class="line"> module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: /\.css$/,</span><br><span class="line">        include: [</span><br><span class="line">          path.join(__dirname, &apos;./src&apos;)</span><br><span class="line">        ],</span><br><span class="line">        use: [&apos;style-loader&apos;, &apos;css-loader&apos;] </span><br><span class="line">        //é“¾å¼è°ƒç”¨loaderçš„æ—¶å€™ï¼Œä¼šä»¥æ•°ç»„é€†åºçš„é¡ºåºæ‰§è¡Œï¼Œ</span><br><span class="line">        //å…ˆæ‰§è¡Œcss-loder,å†æ‰§è¡Œstyle-loader</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">2.</span><br><span class="line">module: &#123;</span><br><span class="line">    rules: [&#123;</span><br><span class="line">      test: /\.css$/,</span><br><span class="line">      include: [</span><br><span class="line">       path.join(__dirname, &apos;./src&apos;),</span><br><span class="line">      ],</span><br><span class="line">      use: ExtractTextPlugin.extract(&#123;</span><br><span class="line">        fallback: &apos;style-loader&apos;,</span><br><span class="line">        use: &apos;css-loader&apos;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;]</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">plugins: [</span><br><span class="line">    new ExtractTextPlugin(&apos;[name].css&apos;)</span><br><span class="line">  ]</span><br><span class="line">3.</span><br><span class="line">module: &#123;</span><br><span class="line">    rules: [&#123;</span><br><span class="line">      test: /\.css$/,</span><br><span class="line">      include: [</span><br><span class="line">       path.join(__dirname, &apos;./src&apos;)</span><br><span class="line">      ],</span><br><span class="line">      use: ExtractTextPlugin.extract(&#123;</span><br><span class="line">        fallback: &apos;style-loader&apos;,</span><br><span class="line">        use: [&apos;css-loader&apos;, &apos;autoprefixer-loader&apos;]</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    new ExtractTextPlugin(&apos;[name].css&apos;)</span><br><span class="line">  ]</span><br></pre></td></tr></table></figure></p>
<p>5.é…ç½®æ’ä»¶plugin<br>æ’ä»¶ç›®çš„åœ¨äºè§£å†³ loader æ— æ³•å®ç°çš„å…¶ä»–äº‹,é…ç½®æ’ä»¶éƒ½åœ¨pluginæ•°ç»„ä¸­ï¼Œæ•°ç»„æ¯ä¸€é¡¹å°±æ˜¯newä¸€ä¸ªplugin,æ’ä»¶çš„é…ç½®ä¹Ÿåœ¨newæ—¶ä»¥å‚æ•°å½¢å¼ä¼ é€’è¿›å»<br>ä¾‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//æ‰“åŒ…å…¬å…±æ–‡ä»¶æ–¹å¼ä¸€ï¼š</span><br><span class="line"></span><br><span class="line">plugins: [</span><br><span class="line">    new CommonsChunkPlugin(&#123;</span><br><span class="line">      name: &apos;commons&apos;,</span><br><span class="line">      filename: &apos;commons.js&apos;</span><br><span class="line">    &#125;),</span><br><span class="line">    new ExtractTextPlugin(&apos;[name].css&apos;)</span><br><span class="line">  ]</span><br></pre></td></tr></table></figure></p>
<p>å¸¸ç”¨æ’ä»¶ï¼š<br>CommonsChunkPluginï¼šå°†å¤šä¸ªæ–‡ä»¶é€šç”¨çš„ä¸œè¥¿æ‰“åŒ…æˆä¸€ä¸ªæ–‡ä»¶<br>webpack.optimize.CommonsChunkPluginï¼šrequire(â€˜webpackâ€™),ä½¿ç”¨webpackçš„optimize.CommonsChunkPluginå°†æ‰“åŒ…çš„æ–‡ä»¶è½¬åŒ–ä¸ºå…¬å…±æ–‡ä»¶<br>HtmlWebpackPluginï¼šæ˜¯ä¾æ®ä¸€ä¸ªç®€å•çš„index.htmlæ¨¡æ¿ï¼Œç”Ÿæˆä¸€ä¸ªè‡ªåŠ¨å¼•ç”¨ä½ æ‰“åŒ…åçš„JSæ–‡ä»¶çš„æ–°index.htmlã€‚è¿™åœ¨æ¯æ¬¡ç”Ÿæˆçš„jsæ–‡ä»¶åç§°ä¸åŒæ—¶éå¸¸æœ‰ç”¨ï¼ˆæ¯”å¦‚æ·»åŠ äº†hashå€¼ï¼‰ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">//æ‰“åŒ…å…¬å…±æ–‡ä»¶æ–¹å¼äºŒï¼š</span><br><span class="line"></span><br><span class="line">var path = require(&apos;path&apos;)</span><br><span class="line">var webpack = require(&apos;webpack&apos;)</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">  context: path.join(__dirname, &apos;./src&apos;),</span><br><span class="line">  entry: &#123;</span><br><span class="line">    app: &apos;./&apos;,</span><br><span class="line">    vendor: [&apos;jquery&apos;, &apos;underscore&apos;],//å°†æ–‡ä»¶ä¸­requireçš„&apos;jquery&apos;, &apos;underscore&apos;æ‰“åŒ…æˆå…¬å…±æ–‡ä»¶vendor.bundle.js</span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.join(__dirname, &apos;dist&apos;),</span><br><span class="line">    filename: &apos;bundle.js&apos;</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    new webpack.optimize.CommonsChunkPlugin(&#123; </span><br><span class="line">      name: &apos;vendor&apos;,</span><br><span class="line">      filename: &apos;vendor.bundle.js&apos;</span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><a href="http://www.jianshu.com/p/42e11515c10f" target="_blank" rel="noopener">å…¥é—¨Webpack</a></p>
<h1 id="å†™ä¸€ä¸ªwebpack-çš„loader"><a href="#å†™ä¸€ä¸ªwebpack-çš„loader" class="headerlink" title="å†™ä¸€ä¸ªwebpack çš„loader"></a>å†™ä¸€ä¸ªwebpack çš„loader</h1><p>1.ç›¸å½“äºå†™ä¸€ä¸ªæ™®é€šçš„æ¨¡å—<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">module.exports = function (source)&#123;</span><br><span class="line">  .....</span><br><span class="line">  ...</span><br><span class="line">  return xxx</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>2.è·å–é…ç½®å‚æ•°<br>æ–¹å¼ä¸€<br>ç›´æ¥ä½¿ç”¨API:this.query<br>æ–¹å¼äºŒ<br>ä½¿ç”¨loader-utilsåº“<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const loaderutils = require(&apos;loader-utils&apos;)</span><br><span class="line">const options = loaderutils.getOptions(this);</span><br></pre></td></tr></table></figure></p>
<p>3.å¤„ç†æ¨¡å—ä¾èµ–<br>æ–¹å¼ä¸€ï¼šè½¬åŒ–æˆrequireè¯­å¥<br>ä¾‹å¦‚,css-loaderå°†@importå’Œurl(â€¦)æ›¿æ¢ä¼šrequire(â€¦)<br>æ–¹å¼äºŒï¼šä½¿ç”¨this.resolveå‡½æ•°è§£æè·¯å¾„<br>ä¾‹å¦‚,less-loaderå°†lessç¼–è¯‘å™¨è¿›è¡Œæ‰©å±•è‡ªå®šä¹‰è·¯å¾„è§£æé€»è¾‘ç„¶ååˆ©ç”¨this.resolveè§£æä¾èµ–</p>
<p>4.ä¸è¦ä½¿ç”¨ç»å¯¹è·¯å¾„<br>5.å¦‚æœè¦åŒ…è£¹å¦å¤–ä¸€ä¸ªåŒ…å°†è¿™ä¸ªåŒ…ä½œä¸ºpeerDependencyåœ¨package.jsonä¸­å¼•å…¥<br>6.è¿”å›å€¼<br>å¦‚æœåªæ˜¯è¿”å›ä¸€ä¸ªå€¼å¯ä»¥ç”¨return<br>å¦‚æœè¿”å›å¤šä¸ªå€¼éœ€è¦è°ƒç”¨APIï¼šthis.callback(),ä½†ä¾ç„¶è¦åœ¨æœ€åreturnä¸€ä¸ªundefined</p>
<p>7.æœ¬åœ°é…ç½®ä½¿ç”¨</p>
<p>å•ä¸ªï¼špath.resolve(â€˜../../loader.jsâ€™)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  test: /\.js$/</span><br><span class="line">  use: [</span><br><span class="line">    &#123;</span><br><span class="line">      loader: path.resolve(&apos;path/to/loader.js&apos;),</span><br><span class="line">      options: &#123;/* ... */&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å¤šä¸ªæˆ–ä¸€ä¸ª<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: /\.js/,</span><br><span class="line">        use: [&#123;</span><br><span class="line">          loader:&apos;define-loader&apos;,</span><br><span class="line">          options:&#123;name:&apos;alice&apos;&#125;</span><br><span class="line">         &#125;</span><br><span class="line">        ],</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  resolveLoader: &#123;</span><br><span class="line">    modules: [</span><br><span class="line">      &apos;node_modules&apos;,</span><br><span class="line">      path.resolve(__dirname, &apos;loaders&apos;)</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p><a href="https://www.webpackjs.com/contribute/writing-a-loader/" target="_blank" rel="noopener">ä¸­æ–‡</a><br><a href="https://webpack.js.org/development/how-to-write-a-loader/" target="_blank" rel="noopener">How to write a loader</a><br><a href="https://webpack.js.org/api/loaders/" target="_blank" rel="noopener">loader API</a></p>
<h1 id="å†™ä¸€ä¸ªwebpack-çš„plugin"><a href="#å†™ä¸€ä¸ªwebpack-çš„plugin" class="headerlink" title="å†™ä¸€ä¸ªwebpack çš„plugin"></a>å†™ä¸€ä¸ªwebpack çš„plugin</h1><p>æŒ‰ç…§æ ¼å¼ï¼Œæ ¹æ®compiler å’Œ compilation å¯¹è±¡å¤„ç†æµç¨‹ä¸Šçš„é’©å­å‡½æ•°ï¼Œ<br>åœ¨ä¸åŒé˜¶æ®µæ’å…¥æˆ‘ä»¬è¦åšçš„äº‹æƒ…<br>1.æ ¼å¼<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">class DefPlugin &#123;</span><br><span class="line">  constructor(name) &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  apply(compiler) &#123;</span><br><span class="line">  // æŒ‡å®šæŒ‚è½½çš„webpackäº‹ä»¶é’©å­ã€‚</span><br><span class="line">    compiler.plugin(&quot;compile&quot;, function(params) &#123;</span><br><span class="line">       console.log(&quot;The compiler is starting to compile...&quot;);</span><br><span class="line">     &#125;);</span><br><span class="line">     // æŒ‡å®šæŒ‚è½½çš„webpackäº‹ä»¶é’©å­ã€‚</span><br><span class="line">    compiler.plugin(&apos;emit&apos;, function(compilation, callback) &#123;</span><br><span class="line">      // ç°åœ¨è®¾ç½®å›è°ƒæ¥è®¿é—®ç¼–è¯‘ä¸­çš„æ­¥éª¤ï¼š</span><br><span class="line">    compilation.plugin(&quot;optimize&quot;, function() &#123;</span><br><span class="line">      console.log(&quot;Assets are being optimized.&quot;);</span><br><span class="line">    &#125;);</span><br><span class="line">    //åŠŸèƒ½å®Œæˆåè°ƒç”¨webpackæä¾›çš„å›è°ƒã€‚</span><br><span class="line">    callback();</span><br><span class="line"></span><br><span class="line">  &#125;)</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">module.exports = DefPlugin</span><br></pre></td></tr></table></figure></p>
<p>2.ä½¿ç”¨<br>ç›´æ¥åœ¨webpack.config.jsæ–‡ä»¶ä¸­requireä¸€ä¸‹å°±å¥½<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">const Plugin = require(&apos;./myplugin&apos;)</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">    context: path.join(__dirname, &apos;src&apos;),</span><br><span class="line">    entry: &apos;./index.js&apos;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        libraryTarget: &apos;commonjs2&apos;,</span><br><span class="line">        path: path.join(__dirname, &apos;dist&apos;),</span><br><span class="line">        filename: &apos;./bundle.js&apos;</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        new Plugin</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>3.compiler<br>compiler å¯¹è±¡ä»£è¡¨äº†å®Œæ•´çš„ webpack ç¯å¢ƒé…ç½®ã€‚è¿™ä¸ªå¯¹è±¡åœ¨å¯åŠ¨ webpack æ—¶è¢«ä¸€æ¬¡æ€§å»ºç«‹ï¼Œå¹¶åœ¨æ‰€æœ‰å¯æ“ä½œçš„è®¾ç½®ä¸­è¢«é…ç½®ï¼ŒåŒ…æ‹¬åŸå§‹é…ç½®ï¼Œloader å’Œæ’ä»¶ã€‚å½“åœ¨ webpack ç¯å¢ƒä¸­åº”ç”¨ä¸€ä¸ªæ’ä»¶æ—¶ï¼Œæ’ä»¶å°†æ”¶åˆ°ä¸€ä¸ªç¼–è¯‘å™¨å¯¹è±¡çš„å¼•ç”¨ã€‚å¯ä»¥ä½¿ç”¨å®ƒæ¥è®¿é—® webpack çš„ä¸»ç¯å¢ƒã€‚<br><a href="https://github.com/webpack/webpack/blob/master/lib/Compiler.js" target="_blank" rel="noopener">æºç </a><br>4.compilation<br>compilation å¯¹è±¡ä»£è¡¨äº†ä¸€æ¬¡å•ä¸€çš„ç‰ˆæœ¬æ„å»ºå’Œç”Ÿæˆèµ„æºã€‚å½“è¿è¡Œ webpack å¼€å‘ç¯å¢ƒä¸­é—´ä»¶æ—¶ï¼Œæ¯å½“æ£€æµ‹åˆ°ä¸€ä¸ªæ–‡ä»¶å˜åŒ–ï¼Œä¸€æ¬¡æ–°çš„ç¼–è¯‘å°†è¢«åˆ›å»ºï¼Œä»è€Œç”Ÿæˆä¸€ç»„æ–°çš„ç¼–è¯‘èµ„æºã€‚ä¸€ä¸ªç¼–è¯‘å¯¹è±¡è¡¨ç°äº†å½“å‰çš„æ¨¡å—èµ„æºã€ç¼–è¯‘ç”Ÿæˆèµ„æºã€å˜åŒ–çš„æ–‡ä»¶ã€ä»¥åŠè¢«è·Ÿè¸ªä¾èµ–çš„çŠ¶æ€ä¿¡æ¯ã€‚ç¼–è¯‘å¯¹è±¡ä¹Ÿæä¾›äº†å¾ˆå¤šå…³é”®ç‚¹å›è°ƒä¾›æ’ä»¶åšè‡ªå®šä¹‰å¤„ç†æ—¶é€‰æ‹©ä½¿ç”¨<br><a href="https://github.com/webpack/webpack/blob/master/lib/Compilation.js" target="_blank" rel="noopener">æºç </a><br>5.tabable</p>
<h1 id="webpackæ€§èƒ½ä¼˜åŒ–"><a href="#webpackæ€§èƒ½ä¼˜åŒ–" class="headerlink" title="webpackæ€§èƒ½ä¼˜åŒ–"></a>webpackæ€§èƒ½ä¼˜åŒ–</h1><p>1.å°†ä¸å†ä½¿ç”¨çš„ä¾èµ–åŠæ—¶åˆ é™¤<br>2.ä¸è¦ä¸ºäº†å®ç°å°åŠŸèƒ½å¼•å…¥å¤§å‹lib<br>3.åˆç†é…ç½®babel<br>4.æ ¹æ®ä½¿ç”¨åœºæ™¯åˆç†ä½¿ç”¨ä¼˜åŒ–æ’ä»¶<br>ä¾‹å¦‚ä½¿ç”¨happypack,webpack-uglify-parallel åœ¨å¼€å‘é˜¶æ®µè¿›è¡Œå¤šæ ¸å¹¶è¡Œå‹ç¼©<br><a href="https://github.com/pigcan/blog/issues/1" target="_blank" rel="noopener">ç›¸å…³é“¾æ¥</a><br><a href="https://github.com/webpack-china/awesome-webpack-cn/" target="_blank" rel="noopener">å­¦ä¹ é“¾æ¥</a></p>
<h1 id="gulp"><a href="#gulp" class="headerlink" title="gulp"></a>gulp</h1><p>api:<br>taskï¼š<br>src:<br>watchï¼šç”¨æ¥ç›‘è§†æ–‡ä»¶çš„å˜åŒ–ï¼›</p>
<p>jshintï¼šjs ä»£ç æ£€æŸ¥<br>uglifyï¼šå‹ç¼©js<br>minify-css:å‹ç¼©css<br>minfy-html:å‹ç¼©html<br>concat:åˆå¹¶æ–‡ä»¶</p>
<h1 id="babel"><a href="#babel" class="headerlink" title="babel"></a>babel</h1><p>babelæ˜¯ä¸€ä¸ªjsè½¬æ¢å™¨<br>å¯ä»¥å°†es6,es7,react/jsxçš„è¯­æ³•é€šè¿‡ä»–çš„æ’ä»¶è½¬ç¼–è¯‘æˆes5çš„æˆ–è€…è¯´æ”¯æŒåœ¨ç°æœ‰ç¯å¢ƒè¿è¡Œçš„è¯­æ³•<br>ä½¿ç”¨babel,é™¤äº†å¯ä»¥ä½¿ç”¨package.jsonè¿›è¡Œé…ç½®ï¼Œä¸€èˆ¬ä¼šä¸ºå®ƒå»ºç«‹ä¸“é—¨çš„.babelrcæ–‡ä»¶è¿›è¡Œé…ç½®<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;presets&quot;: [],</span><br><span class="line">  &quot;plugins&quot;: []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨babel-preset-envè½¬æ¢es5,å°±å°†â€˜envâ€™æ·»åŠ åˆ°.babelrcçš„presentsæ•°ç»„ä¸­<br>ä½¿ç”¨babel-preset-reactè½¬æ¢jsx,å°±å°†â€˜reactâ€™æ·»åŠ åˆ°.babelrcçš„presentsæ•°ç»„ä¸­<br>ä½¿ç”¨babel-preset-stage-xè½¬æ¢es7ä¸åŒé˜¶æ®µè¯­æ³•,å°±å°†â€˜stage-xâ€™æ·»åŠ åˆ°.babelrcçš„presentsæ•°ç»„ä¸­,xç›®å‰å¯ä»¥ä¸º0,1,2,3<br>ä½¿ç”¨babel-coreæ¨¡å—ï¼Œå¯ä»¥åœ¨ä»£ç ä¸­æ‰‹åŠ¨è°ƒç”¨babelAPIè¿›è¡Œè½¬ç <br>ä½¿ç”¨babel-polyfillæ¨¡å—ï¼Œå¯ä»¥è½¬æ¢æ–°ç‰ˆes6/es7é‡Œé¢çš„API,å¦‚generator,Symbol,Promiseç­‰<br>å®‰è£…babel-cliå®ç°å‘½ä»¤è¡Œè¿›è¡Œè½¬ç <br>å¦å¤–babelç»å¸¸ç”¨äºå‰ç½®è½¬ç ï¼Œæ¯”å¦‚ä¸eslintç»“åˆè¿›è¡Œä»£ç æ£€æŸ¥ï¼Œä¸mochaè¿›è¡Œè„šæœ¬æµ‹è¯•</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/safe/http.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/safe/http.html" itemprop="url">
                  å…³äºHTTP
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-10-05T22:53:37+08:00">
                2017-10-05
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="åœ¨æµè§ˆå™¨çš„åœ°å€æ è¾“å…¥urlåå‘ç”Ÿäº†ä»€ä¹ˆ"><a href="#åœ¨æµè§ˆå™¨çš„åœ°å€æ è¾“å…¥urlåå‘ç”Ÿäº†ä»€ä¹ˆ" class="headerlink" title="åœ¨æµè§ˆå™¨çš„åœ°å€æ è¾“å…¥urlåå‘ç”Ÿäº†ä»€ä¹ˆ"></a>åœ¨æµè§ˆå™¨çš„åœ°å€æ è¾“å…¥urlåå‘ç”Ÿäº†ä»€ä¹ˆ</h1><p> ç²—ç•¥çš„å›ç­”çš„è¯ï¼Œå°±æ˜¯æµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€è¯¥url,æµè§ˆå™¨æ ¹æ®è¯¥urlæ‰¾åˆ°ç›¸åº”çš„èµ„æºï¼Œå†æŠŠèµ„æºè¿”å›ç»™æµè§ˆå™¨ï¼Œå³ä½¿æˆ‘ä»¬çœ‹åˆ°çš„é¡µé¢å†…å®¹<br> ç»†è‡´çš„å›ç­”çš„è¯ï¼Œæµè§ˆå™¨ä¼šåœ¨åº”ç”¨å±‚åˆ©ç”¨DNSåè®®è§£æåŸŸåç”Ÿæˆipåœ°å€ï¼Œåˆ©ç”¨httpåè®®ç”Ÿæˆä¸€ä¸ªhttpè¯·æ±‚ç„¶åä¼ é€’ç»™ä¼ è¾“å±‚ï¼Œä¼ è¾“å±‚å°†æ ¹æ®TCPåè®®å°†è¿™ä¸ªhttpè¯·æ±‚æŠ¥æ–‡è¿›è¡Œåˆ†å‰²å¹¶æ‰“ä¸Šåºå·æ ‡è®°ã€ç«¯å£å·å’Œä¸‰æ¬¡æ¡æ‰‹æ ‡å¿—åè½¬å‘ç»™ç½‘ç»œå±‚ï¼Œç½‘ç»œå±‚ä¼šåˆ©ç”¨ARPåè®®æ ¹æ®ipåœ°å€æŸ¥åˆ°MACåœ°å€,IPåè®®å¯¹æ•°æ®å°è£…MACåœ°å€ç­‰ä¿¡æ¯ï¼Œå°†æ‰“åŒ…å¥½çš„æ•°æ®åŒ…å‘é€ç»™é“¾è·¯å±‚å†å°è£…ç„¶åå‘é€å‡ºå»ï¼Œç»è¿‡ä¸€ç³»åˆ—è½¬å‘ï¼Œå¿½ç•¥è·¯ç”±ã€CDNçš„ç¼“å­˜ç­–ç•¥ï¼Œä¸­è½¬åˆ°è¾¾æœåŠ¡å™¨å,æœåŠ¡å™¨å†æŒ‰é“¾è·¯å±‚ï¼Œç½‘è·¯å±‚ï¼Œä¼ è¾“å±‚ï¼Œåº”ç”¨å±‚çš„é¡ºåºï¼Œä»ä¸‹åˆ°ä¸Šä¾æ¬¡è§£å°æ•°æ®ä¿¡æ¯ï¼Œæ‰¾åˆ°èµ„æºåï¼ŒåŒæ ·åˆ†å‰²ï¼Œå°è£…æ‰“åŒ…å†ä¼ ç»™å®¢æˆ·ç«¯æµè§ˆå™¨ã€‚</p>
<h2 id="é‡æ–°çœ‹å¾…è¿™ä¸ªé—®é¢˜"><a href="#é‡æ–°çœ‹å¾…è¿™ä¸ªé—®é¢˜" class="headerlink" title="é‡æ–°çœ‹å¾…è¿™ä¸ªé—®é¢˜"></a>é‡æ–°çœ‹å¾…è¿™ä¸ªé—®é¢˜</h2><p> <a href="https://www.processon.com/view/link/5f14489ce401fd06f3e2fd4b" target="_blank" rel="noopener">æµç¨‹å›¾1</a><br> <a href="https://www.processon.com/view/link/5f1448cee0b34d44f052743c" target="_blank" rel="noopener">æµç¨‹å›¾2</a><br> <img src="/image/browerurl.png" alt="browerurl"></p>
<h3 id="æµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹"><a href="#æµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹" class="headerlink" title="æµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹"></a>æµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹</h3><p> è§£æHTMLæ„å»ºDOMæ ‘æ—¶ï¼Œæ¸²æŸ“å¼•æ“ä¼šå…ˆå°†HTMLå…ƒç´ æ ‡ç­¾è§£ææˆ<br> ç”±å¤šä¸ªDOMå…ƒç´ å¯¹è±¡èŠ‚ç‚¹ç»„æˆä¸”å…·æœ‰èŠ‚ç‚¹çˆ¶å­å…³ç³»çš„DOMæ ‘ç»“æ„ï¼Œ<br> ç„¶åæ ¹æ®DOMæ ‘ç»“æ„çš„æ¯ä¸ªèŠ‚ç‚¹é¡ºåºæå–è®¡ç®—ä½¿ç”¨çš„CSSè§„åˆ™<br> å¹¶é‡æ–°è®¡ç®—DOMæ ‘ç»“æ„çš„æ ·å¼æ•°æ®ï¼Œ<br> ç”Ÿæˆä¸€ä¸ªå¸¦æœ‰æ ·å¼æè¿°çš„domæ¸²æŸ“æ ‘å¯¹è±¡<br> DOMæ¸²æŸ“æ ‘ç”Ÿæˆç»“æŸåè¿›å…¥æ¸²æŸ“æ ‘çš„å¸ƒå±€é˜¶æ®µ<br> å³æ ¹æ®æ¯ä¸ªæ¸²æŸ“æ ‘èŠ‚ç‚¹åœ¨é¡µé¢ä¸­çš„å¤§å°å’Œä½ç½®ï¼Œå°†èŠ‚ç‚¹å›ºå®šåˆ°é¡µé¢å¯¹åº”ä½ç½®ä¸Š<br> è¿™ä¸ªé˜¶æ®µä¸»è¦æ˜¯å…ƒç´ çš„å¸ƒå±€å±æ€§ï¼ˆpositionï¼Œfloat,marginç­‰å±æ€§ï¼‰<br> å³åœ¨æµè§ˆå™¨ä¸­ç»˜åˆ¶é¡µé¢ä¸Šå…ƒç´ èŠ‚ç‚¹çš„ä½ç½®<br> ç»˜åˆ¶é˜¶æ®µå°†æ¸²æŸ“æ ‘èŠ‚ç‚¹çš„èƒŒæ™¯ï¼Œé¢œè‰²ï¼Œæ–‡æœ¬ç­‰æ ·å¼ä¿¡æ¯åº”ç”¨åˆ°æ¯ä¸ªèŠ‚ç‚¹ä¸Š<br> è¿™ä¸ªé˜¶æ®µä¸»è¦æ˜¯å…ƒç´ çš„å†…éƒ¨æ˜¾ç¤ºæ ·å¼ï¼ˆcolor,background,text-shadowç­‰å±æ€§ï¼‰ç”Ÿæ•ˆ<br> æœ€ç»ˆå®Œæˆæ•´ä¸ªDOMåœ¨é¡µé¢ä¸Šçš„ç»˜åˆ¶æ˜¾ç¤º</p>
<p> ä¸åŒæµè§ˆå™¨å†…æ ¸æ¸²æŸ“è¿‡ç¨‹æœ‰åŒºåˆ«<br> Webkitå†…æ ¸(google,safari)ä¸­HTMLå’Œcssè§£æå¯ä»¥è®¤ä¸ºæ˜¯å¹¶è¡Œçš„ï¼Œç”Ÿæˆçš„æ¸²æŸ“å¯¹è±¡è¢«å«åšæ¸²æŸ“æ ‘ï¼ˆrender treeï¼‰<br> Geokoå†…æ ¸ï¼ˆfirefoxï¼‰åˆ™æ˜¯å…ˆè§£æhtmlç”Ÿæˆsinkåå†å¼€å§‹è§£æCSSï¼Œç”Ÿæˆçš„æ¸²æŸ“å¯¹è±¡ç§°ä¸ºFrameæ ‘(Frame tree)</p>
<p> åœ¨æ¸²æŸ“æ ‘ç”Ÿæˆé˜¶æ®µï¼ŒDOMæ ‘ä¸­çš„ç»“ç‚¹ä¼šåœ¨CSSåˆ†ææ ‘ä¸­æ ¹æ®å…ƒç´ ï¼Œç±»ï¼Œidé€‰æ‹©å™¨æ¥æå–ä¸ä¹‹å¯¹åº”å…ƒç´ çš„ä¸€æ¡æˆ–å¤šæ¡CSSRule,è¿›è¡ŒCSSè§„åˆ™çš„å±‚å å’Œæƒé‡è®¡ç®—ï¼Œ<br> å¾—åˆ°æœ€ç»ˆç”Ÿæˆçš„æ ·å¼CSSRuleå¹¶æ·»åŠ åˆ°DOMæ¸²æŸ“æ ‘ä¸Šï¼Œ<br> å½“æ¯ä¸ªDomèŠ‚ç‚¹æå–CSSæ ·å¼å®Œæˆæ—¶ï¼Œç”¨äºé¡µé¢å¸ƒå±€å’Œç»˜åˆ¶çš„DOMæ¸²æŸ“æ ‘ä¾¿å½¢æˆäº†<br> åœ¨ä¸€ä¸ªå·²ç»å½¢æˆçš„DOMæ¸²æŸ“æ ‘ä¸­ï¼ŒèŠ‚ç‚¹çš„CSSè§„åˆ™å¯é€šè¿‡<br> document.defaultView.getComputedStyle(element,null)<br> æ–¹æ³•è·å–</p>
<h1 id="å…³äº-TCP-IP-åè®®"><a href="#å…³äº-TCP-IP-åè®®" class="headerlink" title="å…³äº TCP/IP åè®®"></a>å…³äº TCP/IP åè®®</h1><p>1.ä¸åŒçš„ç¡¬ä»¶ã€æ“ä½œç³»ç»Ÿä¹‹é—´çš„é€šä¿¡ï¼Œæ‰€æœ‰è¿™ä¸€åˆ‡éƒ½éœ€è¦ä¸€ç§è§„åˆ™ï¼Œè¿™ç§è§„åˆ™å³åè®®<br>2.ä¸äº’è”ç½‘ç›¸å…³è”çš„åè®®é›†åˆèµ·æ¥å°±æ˜¯TCP/IP<br>3.httpåè®®æ˜¯TCP/IPåè®®çš„ä¸€ä¸ªå­é›†<br>4.URI(ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦)ï¼Œç”¨å­—ç¬¦ä¸²æ ‡è¯†æŸä¸€äº’è”ç½‘èµ„æºï¼Œè€Œurlè¡¨ç¤ºèµ„æºçš„åœ°ç‚¹</p>
<h2 id="åˆ†å±‚ç®¡ç†"><a href="#åˆ†å±‚ç®¡ç†" class="headerlink" title="åˆ†å±‚ç®¡ç†"></a>åˆ†å±‚ç®¡ç†</h2><p>å¥½å¤„:å±€éƒ¨æ”¹å˜è®¾è®¡ï¼Œåªéœ€æŠŠå˜åŠ¨çš„å±‚æ›¿æ¢ï¼Œæ— éœ€æ•´ä½“æ›¿æ¢<br>åº”ç”¨å±‚ï¼šåº”ç”¨æœåŠ¡é—´é€šä¿¡ï¼Œå¦‚FTP,DNSæœåŠ¡ï¼Œåº”ç”¨httpåè®®<br>ä¼ è¾“å±‚ï¼šç½‘ç»œè¿æ¥ä¸­ä¸¤å°è®¡ç®—æœºä¹‹é—´æ•°æ®ä¼ è¾“ï¼Œåº”ç”¨TCPå’ŒUDPåè®®<br>ç½‘ç»œå±‚ï¼šå¤„ç†ç½‘ç»œä¸ŠæµåŠ¨çš„æ•°æ®åŒ…ï¼Œåº”ç”¨IPåè®®<br>é“¾è·¯å±‚ï¼šå¤„ç†è¿æ¥ç½‘ç»œçš„ç¡¬ä»¶ä¹‹é—´é€šä¿¡ï¼ŒåŒ…æ‹¬æ“ä½œç³»ç»Ÿï¼Œç¡¬ä»¶çš„è®¾å¤‡é©±åŠ¨ï¼Œå…‰çº¤ç­‰ã€‚</p>
<h2 id="ä¸‰æ¬¡æ¡æ‰‹"><a href="#ä¸‰æ¬¡æ¡æ‰‹" class="headerlink" title="ä¸‰æ¬¡æ¡æ‰‹"></a>ä¸‰æ¬¡æ¡æ‰‹</h2><p>ç›®çš„åœ¨äºç¡®ä¿å‡†ç¡®æ— è¯¯çš„å°†æ•°æ®é€è¾¾ç›®çš„åœ°<br>TCPåè®®åœ¨å°è£…æ•°æ®æ—¶ä¼šå°è£…SYNå’ŒACKä½œä¸ºæ¡æ‰‹æ ‡è¯†<br>å‘é€ç«¯é¦–å…ˆå‘é€ä¸€ä¸ªå¸¦SYNæ ‡è¯†çš„æ•°æ®åŒ…ç»™å¯¹æ–¹ï¼Œæ¥æ”¶ç«¯æ”¶åˆ°åï¼Œå›ä¼ ä¸€ä¸ªå¸¦æœ‰SYN/ACKæ ‡è¯†çš„æ•°æ®åŒ…ä»¥ç¤ºä¼ è¾¾ç¡®è®¤ä¿¡æ¯ï¼Œæœ€åï¼Œå‘é€ç«¯å†å›ä¼ ä¸€ä¸ªå¸¦ACKæ ‡è¯†çš„æ•°æ®åŒ…ï¼Œä»£è¡¨â€˜æ¡æ‰‹â€™ç»“æŸ<br>è‹¥åœ¨æ¡æ‰‹è¿‡ç¨‹ä¸­æŸä¸ªé˜¶æ®µè«åä¸­æ–­ï¼ŒTCPåè®®ä¼šå†æ¬¡ä»¥ç›¸åŒçš„é¡ºåºå‘é€ç›¸åŒçš„æ•°æ®åŒ…</p>
<h1 id="HTTPåè®®"><a href="#HTTPåè®®" class="headerlink" title="HTTPåè®®"></a>HTTPåè®®</h1><p>1.è¯·æ±‚æŠ¥æ–‡ç”±è¯·æ±‚æ–¹æ³•ã€è¯·æ±‚URIã€åè®®ç‰ˆæœ¬ã€å¯é€‰çš„è¯·æ±‚é¦–éƒ¨å­—æ®µå’Œå†…å®¹å®ä½“æ„æˆ<br>2.å“åº”æŠ¥æ–‡åŸºæœ¬ä¸Šç”±åè®®ç‰ˆæœ¬ã€çŠ¶æ€ç (è¡¨ç¤ºè¯·æ±‚æˆåŠŸæˆ–å¤±è´¥çš„æ•°å­—ä»£ç )ã€ç”¨ä»¥è§£é‡ŠçŠ¶æ€ç çš„åŸå› çŸ­è¯­ã€å¯é€‰çš„å“åº”é¦–éƒ¨å­—æ®µä»¥åŠå®ä½“ä¸»ä½“æ„æˆ<br>3.httpæ˜¯æ— çŠ¶æ€åè®®ï¼Œå³ä¸ä¿å­˜ä¹‹å‰å‘é€è¿‡çš„è¯·æ±‚æˆ–å“åº”<br>4.æŒä¹…é“¾æ¥çš„ç‰¹ç‚¹ï¼šåªè¦ä»»æ„ä¸€ç«¯æ²¡æœ‰æ˜ç¡®æå‡ºæ–­å¼€è¿æ¥ï¼Œåˆ™ä¿æŒTCPè¿æ¥çŠ¶æ€ï¼Œ<br>æ—¨åœ¨å»ºç«‹1æ¬¡TCPè¿æ¥åè¿›è¡Œå¤šæ¬¡è¯·æ±‚å’Œå“åº”çš„äº¤äº’<br>5.ç®¡çº¿åŒ–æŠ€æœ¯ï¼šåœ¨æŒä¹…é“¾æ¥çŠ¶æ€ä¸‹ï¼Œä¸ç”¨ç­‰å¾…å“åº”äº¦å¯ç›´æ¥å‘é€ä¸‹ä¸€ä¸ªè¯·æ±‚ï¼Œå®ç°å¹¶è¡Œå‘é€å¤šä¸ªè¯·æ±‚<br>6.è¯·æ±‚æ–¹æ³•<br>GET:è®¿é—®å·²è¢«URIè¯†åˆ«çš„èµ„æº,è·å–å“åº”å†…å®¹<br>POSTï¼šä¼ è¾“å®ä½“çš„ä¸»ä½“<br>PUTï¼šåœ¨è¯·æ±‚æŠ¥æ–‡ä¸»ä½“ä¸­åŒ…å«æ–‡ä»¶å†…å®¹ï¼Œç„¶åä¿å­˜åˆ°è¯·æ±‚URIæŒ‡å®šçš„ä½ç½®ï¼Œè‡ªèº«ä¸å¸¦éªŒè¯æœºåˆ¶<br>HEAD:ç”¨äºç¡®è®¤URIçš„æœ‰æ•ˆæ€§åŠèµ„æºæ›´æ–°çš„æ—¥æœŸæ—¶é—´ç­‰<br>DELETEï¼šæŒ‰è¯·æ±‚URIåˆ é™¤æŒ‡å®šçš„èµ„æºï¼Œä¸å¸¦éªŒè¯æœºåˆ¶<br>OPTIONï¼šæŸ¥è¯¢é’ˆå¯¹è¯·æ±‚URIæŒ‡å®šçš„èµ„æºæ”¯æŒçš„æ–¹æ³•<br>TRACE: å°†ä¹‹å‰çš„è¯·æ±‚é€šä¿¡ç¯å›ç»™å®¢æˆ·ç«¯,å¯ä»¥æŸ¥è¯¢å‘é€å‡ºå»çš„è¯·æ±‚æ˜¯æ€æ ·è¢«åŠ å·¥ä¿®æ”¹/ç¯¡æ”¹çš„ï¼Œä½†å®¹æ˜“å¼•å‘XSTæ”»å‡»<br>CONNECTï¼šåœ¨ä¸ä»£ç†æœåŠ¡å™¨é€šä¿¡æ—¶å»ºç«‹éš§é“ï¼Œå®ç°ç”¨éš§é“åè®®è¿›è¡ŒTCPé€šä¿¡ã€‚ä¸»è¦ä½¿ç”¨SSLå’ŒTLSåè®®æŠŠé€šä¿¡å†…å®¹åŠ å¯†åç»ç½‘ç»œéš§é“ä¼ è¾“</p>
<h2 id="COOKIEçŠ¶æ€ç®¡ç†"><a href="#COOKIEçŠ¶æ€ç®¡ç†" class="headerlink" title="COOKIEçŠ¶æ€ç®¡ç†"></a>COOKIEçŠ¶æ€ç®¡ç†</h2><p>å®¢æˆ·ç«¯åœ¨æœªæºå¸¦cookieä¿¡æ¯çŠ¶æ€ä¸‹è¯·æ±‚æœåŠ¡å™¨æ—¶ï¼ŒæœåŠ¡å™¨ä¼šç”Ÿæˆcookieï¼Œå¹¶è®°ä½æ˜¯å‘è°å‘é€çš„ï¼Œç„¶ååœ¨å“åº”æŠ¥æ–‡å¤´ä¸­æ·»åŠ ä¸€ä¸ªå«Set-Cookieçš„å­—æ®µä¿¡æ¯ï¼Œé€šçŸ¥å®¢æˆ·ç«¯ä¿å­˜Cookieã€‚<br>å½“ä¸‹æ¬¡å®¢æˆ·ç«¯å†å¾€è¯¥æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œå®¢æˆ·ç«¯ä¼šè‡ªåŠ¨åœ¨è¯·æ±‚æŠ¥æ–‡ä¸­åŠ å…¥Cookieå€¼åå‘é€å‡ºå»<br>æœåŠ¡å™¨ç«¯å‘ç°å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„Cookieåï¼Œä¼šå»æ£€æŸ¥ç©¶ç«Ÿæ˜¯ä»å“ªä¸€ä¸ªå®¢æˆ·ç«¯å‘æ¥çš„è¿æ¥è¯·æ±‚ï¼Œç„¶åå¯¹æ¯”æœåŠ¡å™¨ä¸Šçš„è®°å½•ï¼Œæœ€åå¾—åˆ°ä¹‹å‰çš„çŠ¶æ€ä¿¡æ¯.<br>7.æŠ¥æ–‡ç”±æŠ¥æ–‡é¦–éƒ¨ã€ç©ºæ ¼å’ŒæŠ¥æ–‡ä¸»ä½“æ„æˆ</p>
<p>è¯·æ±‚æŠ¥æ–‡çš„æŠ¥æ–‡é¦–éƒ¨åˆ†ä¸ºï¼šè¯·æ±‚è¡Œ(è¯·æ±‚æ–¹æ³•,URI,HTTPç‰ˆæœ¬)ã€è¯·æ±‚é¦–éƒ¨å­—æ®µã€é€šç”¨é¦–éƒ¨å­—æ®µã€å®ä½“é¦–éƒ¨å­—æ®µã€å…¶ä»–<br>å“åº”æŠ¥æ–‡çš„æŠ¥æ–‡é¦–éƒ¨åˆ†ä¸ºï¼šçŠ¶æ€è¡Œ(çŠ¶æ€ç ,åŸå› çŸ­è¯­,HTTPç‰ˆæœ¬)ã€å“åº”é¦–éƒ¨å­—æ®µã€é€šç”¨é¦–éƒ¨å­—æ®µã€å®ä½“é¦–éƒ¨å­—æ®µã€å…¶ä»–</p>
<p>æŠ¥æ–‡ä¸»ä½“å³ä¼ è¾“è¯·æ±‚æˆ–å“åº”çš„å®ä½“ä¸»ä½“</p>
<p>æå‡ä¼ è¾“æ•ˆç‡é‡‡å–çš„æ–¹æ³•ï¼šä¼ è¾“ç¼–ç ï¼Œå¯¹å®ä½“è¿›è¡Œâ€˜å†…å®¹ç¼–ç â€™ï¼Œå‹ç¼©ä¼ è¾“å†…å®¹ï¼Œåˆ†å—ä¼ è¾“ç¼–ç </p>
<p>å‘é€ä¸åŒç±»å‹æ•°æ®æ—¶ï¼Œéœ€è¦é¦–éƒ¨å­—æ®µContent-Type<br>è¯·æ±‚æŠ¥æ–‡çš„Content-Typeèµ‹å€¼mulitipart/form-data,<br>å“åº”æŠ¥æ–‡çš„Content-Typeèµ‹å€¼mulitipart/byteranges,</p>
<p>è¯·æ±‚æŒ‡å®šèŒƒå›´æ•°æ®æ—¶ï¼Œå¯ä»¥ç”¨é¦–éƒ¨å­—æ®µRangeæŒ‡å®šèµ„æºçš„byteèŒƒå›´<br>ä¾‹ï¼šè¯·æ±‚å¼€å§‹åˆ°3000ï¼Œå’Œ5000åˆ°7000å­—èŠ‚çš„å¤šé‡èŒƒå›´<br>Range:bytes=-3000,5000-7000<br>å“åº”çŠ¶æ€ç ä¼šè¿”å›206ï¼Œå¤šé‡èŒƒå›´ä¼šåœ¨é¦–éƒ¨æ·»åŠ Content-Typeï¼šmulitipart/byteranges<br>å¦‚æœæœåŠ¡å™¨æ— æ³•å“åº”èŒƒå›´è¯·æ±‚ï¼Œåˆ™ä¼šè¿”å›çŠ¶æ€ç 200OKå’Œå®Œæ•´çš„å®ä½“å†…å®¹</p>
<p>å†…å®¹åå•†æœºåˆ¶ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å°±å“åº”çš„èµ„æºå†…å®¹è¿›è¡Œäº¤æ¶‰ï¼Œç„¶åæä¾›ç»™å®¢æˆ·ç«¯æœ€ä¸ºé€‚åˆçš„èµ„æºã€‚<br>å†…å®¹åå•†ä¼šä»¥å“åº”èµ„æºçš„è¯­è¨€ã€å­—ç¬¦é›†ã€ç¼–ç æ–¹å¼ç­‰ä½œä¸ºåˆ¤æ–­çš„åŸºå‡†<br>å¯¹åº”é¦–éƒ¨å­—æ®µæœ‰ï¼šAccept,Accept-Charset,Accept-Encoding,Accept-Language,Content-Language<br>å†…å®¹åå•†æŠ€æœ¯æœ‰ä¸‰ç±»ï¼š<br>æœåŠ¡å™¨é©±åŠ¨åå•†ï¼šä»¥è¯·æ±‚é¦–éƒ¨å­—æ®µä¸ºå‚è€ƒï¼Œåœ¨æœåŠ¡å™¨ç«¯è‡ªåŠ¨å¤„ç†<br>å®¢æˆ·ç«¯é©±åŠ¨åå•†ï¼šç”¨æˆ·åœ¨æµè§ˆå™¨å¯é€‰åˆ—è¡¨ä¸­æ‰‹åŠ¨é€‰æ‹©<br>é€æ˜åå•†ï¼šå‰ä¸¤è€…çš„ç»“åˆä½“ï¼Œç”±æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯å„è‡ªè¿›è¡Œå†…å®¹åå•†çš„ä¸€ç§æ–¹æ³•</p>
<p>8.çŠ¶æ€ç </p>
<p>1XX:è¯·æ±‚æ­£åœ¨å¤„ç†<br>2XX:è¯·æ±‚æ­£å¸¸é‚£ä¸ªå¤„ç†å®Œæ¯•<br>3XXï¼šé‡å®šå‘ï¼Œéœ€è¦è¿›è¡Œé™„åŠ æ“ä½œä»¥å®Œæˆè¯·æ±‚ï¼Œ<br>4XXï¼šæœåŠ¡å™¨æ— æ³•å¤„ç†è¯·æ±‚,å®¢æˆ·ç«¯æœ‰é”™è¯¯å‘ç”Ÿ<br>5XXï¼šæœåŠ¡å™¨å¤„ç†è¯·æ±‚å‡ºé”™</p>
<p>200 OK å®¢æˆ·ç«¯çš„è¯·æ±‚åœ¨æœåŠ¡å™¨è¢«æ­£å¸¸å¤„ç†äº†<br>204 No Content ï¼Œæ­£å¸¸å¤„ç†ï¼Œä½†å“åº”ä¸å«å®ä½“<br>206 Partial Content  æˆåŠŸå¤„ç†äº†èŒƒå›´è¯·æ±‚ï¼Œå“åº”åªå«æŒ‡å®šèŒƒå›´å®ä½“</p>
<p>301 Moved Permanently æ°¸ä¹…é‡å®šå‘<br>302 Found ä¸´æ—¶é‡å®šå‘<br>303 See Other ä¸´æ—¶é‡å®šå‘ï¼Œä½†åªèƒ½ä½¿ç”¨getæ–¹æ³•è®¿é—®è¯¥èµ„æº<br>304 Not Modified æœåŠ¡å™¨æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆå®¢æˆ·ç«¯é™„å¸¦æ¡ä»¶(If-Match,If-Rangeç­‰æŠ¥æ–‡é¦–éƒ¨)çš„èµ„æºï¼Œå“åº”ä¸å«ä¸»ä½“ï¼Œä¸é‡å®šå‘æ— å…³,æœåŠ¡å™¨å‘Šè¯‰å®¢æˆ·ï¼ŒåŸæ¥ç¼“å†²çš„æ–‡æ¡£è¿˜å¯ä»¥ç»§ç»­ä½¿ç”¨<br>307 Temporary Redirect ä¸´æ—¶é‡å®šå‘ï¼ŒæŒ‰ç…§æµè§ˆå™¨æ ‡å‡†ä¸ä¼šä»postå˜æˆGETã€‚ä½†æµè§ˆå™¨ä¸åŒï¼Œå‡ºç°æƒ…å†µä¹Ÿå¯èƒ½ä¸åŒ</p>
<p>400 Bad Request è¯·æ±‚æŠ¥æ–‡å­˜åœ¨è¯­æ³•é”™è¯¯<br>401 Unauthorized æºå¸¦ä¿¡æ¯æœªé€šè¿‡HTTPè®¤è¯ï¼Œæ²¡æœ‰æƒé™è®¿é—®èµ„æº<br>403 Forbidden è¯·æ±‚çš„èµ„æºè¢«æœåŠ¡å™¨æ‹’ç»è®¿é—®<br>404 Not Found æ— æ³•æ‰¾åˆ°è¯·æ±‚èµ„æº</p>
<p>500 Internal Server Error æœåŠ¡å™¨åœ¨æ‰§è¡Œè¯·æ±‚æ—¶å‘ç”Ÿäº†é”™è¯¯ï¼Œä¹Ÿå¯èƒ½æ˜¯webåº”ç”¨å­˜åœ¨bugæˆ–ä¸´æ—¶æ•…éšœ<br>502 bad gateway ç½‘å…³é”™è¯¯<br>503 Service Unavailable æœåŠ¡å™¨æš‚æ—¶å¤„äºè¶…è´Ÿè½½æˆ–æ­£åœ¨è¿›è¡Œåœæœºç»´æŠ¤</p>
<p>9.é€šä¿¡æ•°æ®è½¬å‘ç¨‹åº<br>ä»£ç†ï¼šæ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚å¹¶è½¬å‘ç»™æºæœåŠ¡å™¨ï¼Œä¸æ”¹å˜URI,ä½†åœ¨è½¬å‘æ—¶ä¼šæ·»åŠ viaé¦–éƒ¨<br>å¥½å¤„ï¼šåˆ©ç”¨ç¼“å­˜æŠ€æœ¯å‡å°‘ç½‘ç»œå¸¦å®½çš„æµé‡ï¼Œç»„ç»‡å†…éƒ¨é’ˆå¯¹ç‰¹å®šç½‘ç«™çš„è®¿é—®æ§åˆ¶ï¼Œä»¥è·å–è®¿é—®æ—¥å¿—ä¸ºä¸»è¦ç›®çš„ç­‰ç­‰<br>ä½¿ç”¨æ–¹æ³•åˆ†ä¸¤ç±»ï¼š<br>1.æ˜¯å¦ä½¿ç”¨ç¼“å­˜,ä¾‹,ç¼“å­˜ä»£ç†(é¢„å…ˆå°†èµ„æºå‰¯æœ¬å­˜åœ¨ä»£ç†æœåŠ¡å™¨ä¸Š);<br>2.æ˜¯å¦ä¼šä¿®æ”¹æŠ¥æ–‡,ä¾‹,é€æ˜ä»£ç†(å¯¹æŠ¥æ–‡ä¸åšä»»ä½•åŠ å·¥ï¼Œåä¹‹éé€æ˜ä»£ç†)</p>
<p>ç½‘å…³ï¼šè½¬å‘å…¶ä»–æœåŠ¡å™¨æ•°æ®çš„æœåŠ¡å™¨ï¼Œæ¥æ”¶ä»å®¢æˆ·ç«¯å‘æ¥çš„è¯·æ±‚å¹¶å¯¹è¯·æ±‚è¿›è¡Œå¤„ç†<br>å¥½å¤„ï¼šèƒ½ä½¿é€šä¿¡çº¿è·¯ä¸ŠæœåŠ¡å™¨æä¾›éHTTPåè®®æœåŠ¡ï¼Œèƒ½æé«˜é€šä¿¡å®‰å…¨æ€§</p>
<p>éš§é“ï¼šåœ¨ç›¸éš”ç”šè¿œçš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´è¿›è¡Œä¸­è½¬ï¼Œå¹¶ä¿æŒåŒæ–¹é€šä¿¡è¿æ¥çš„åº”ç”¨ç¨‹åº<br>ç›®çš„ï¼šç¡®ä¿å®¢æˆ·ç«¯èƒ½ä¸æœåŠ¡å™¨è¿›è¡Œå®‰å…¨çš„é€šä¿¡ï¼Œé€šä¿¡åŒå‘æ–­å¼€è¿æ¥æ—¶ç»“æŸ</p>
<p>ç¼“å­˜ï¼šä»£ç†æœåŠ¡å™¨æˆ–å®¢æˆ·ç«¯æœ¬åœ°ç£ç›˜å†…ä¿å­˜çš„èµ„æºå‰¯æœ¬ ï¼Œå…¶å®ç›¸å½“äºæ˜¯ä¸€ç§ä»£ç†æœåŠ¡å™¨<br>ç›®çš„ï¼šå‡å°‘å¯¹æºæœåŠ¡å™¨çš„è®¿é—®ï¼Œä»è€ŒèŠ‚çœé€šä¿¡æµé‡å’Œé€šä¿¡æ—¶é—´<br>æœºåˆ¶ï¼šè¶…è¿‡æœ‰æ•ˆæœŸä¹‹åï¼Œä¼šå‘æºæœåŠ¡å™¨ç¡®è®¤èµ„æºæœ‰æ•ˆæ€§ï¼Œè‹¥åˆ¤æ–­ç¼“å­˜å¤±æ•ˆï¼Œåˆ™å†æ¬¡ä»æºæœåŠ¡å™¨ä¸Šè·å–â€˜æ–°â€™èµ„æº</p>
<p>10.é¦–éƒ¨å­—æ®µ<br>åˆ†ä¸¤ç±»ï¼šç¼“å­˜ä»£ç†å’Œéç¼“å­˜ä»£ç†<br>ç¼“å­˜ä»£ç†ï¼Œå³ç«¯åˆ°ç«¯é¦–éƒ¨ï¼Œè¿™ç±»é¦–éƒ¨ä¼šè¢«å¸¦åˆ°å®¢æˆ·ç«¯æˆ–æœåŠ¡ç«¯ï¼Œä¸”ä¼šä¿å­˜åœ¨ç¼“å­˜ä¸­<br>éç¼“å­˜ä»£ç†ï¼Œå³é€è·³é¦–éƒ¨ï¼Œåªå¯¹å•è¯è½¬å‘æœ‰æ•ˆï¼Œä¼šå› é€šè¿‡ç¼“å­˜æˆ–ä»£ç†è€Œä¸å†è½¬å‘</p>
<p>é€šç”¨é¦–éƒ¨ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½ä¼šç”¨çš„é¦–éƒ¨<br><img src="/image/header1.png" alt="header1"><br>è¯·æ±‚é¦–éƒ¨<br><img src="/image/header2.png" alt="header2"><br>å“åº”é¦–éƒ¨<br><img src="/image/header3.png" alt="header3"><br>å®ä½“é¦–éƒ¨<br><img src="/image/header4.png" alt="header4"><br>cookie ç›¸å…³é¦–éƒ¨<br><img src="/image/header5.png" alt="header5"><br>ä¸€äº›éœ€è¦æ³¨æ„çš„å­—æ®µ<br>connection:close å®Œæˆæœ¬æ¬¡å“åº”åï¼Œæ— éœ€ç­‰å¾…åç»­è¯·æ±‚ï¼Œæ–­å¼€é“¾æ¥<br>connection:keep-alive å®Œæˆæœ¬æ¬¡å“åº”åä¿æŒé“¾æ¥ç­‰å¾…åç»­è¯·æ±‚</p>
<p>connection:upgrade<br>upgrade:websocket<br>è¿™ä¸¤è€…ç»„åˆåœ¨ä¸€èµ·æ—¶ï¼Œè¡¨ç¤ºå®¢æˆ·ç«¯ç”³è¯·çš„æ›´æ¢åè®®ï¼Œ<br>æœåŠ¡ç«¯å…è®¸åˆ‡æ¢ï¼Œæ­¤æ—¶æŠ¥å¤´ä¸º101ï¼Œè¡¨ç¤ºè¿˜éœ€è¦ç­‰å¾…å®Œæˆåˆ‡æ¢çš„è¿‡ç¨‹</p>
<p>content-Encoding è¡¨ç¤ºæœåŠ¡ç«¯å‹ç¼©æ–¹æ³•<br>Transfer-Encoding è¡¨ç¤ºæœåŠ¡ç«¯ç¼–ç æ–¹æ³•</p>
<h1 id="https"><a href="#https" class="headerlink" title="https"></a>https</h1><p>httpç¼ºç‚¹</p>
<p>1.é€šä¿¡ä½¿ç”¨æ˜æ–‡(ä¸åŠ å¯†)ï¼Œå†…å®¹å¯èƒ½ä¼šè¢«çªƒå¬<br>é€ æˆåŸå› ï¼šé€šä¿¡çº¿è·¯ä¸Šçš„ç½‘ç»œè®¾å¤‡ã€å…‰çº¤ç­‰ä¸å¯èƒ½æ˜¯ä¸ªäººç§æœ‰ç‰©ï¼Œä¸æ’é™¤æŸä¸ªç¯èŠ‚ä¼šé­åˆ°æ¶æ„çª¥è§†æˆ–çªƒå¬<br>è§£å†³åŠæ³•ï¼šåŠ å¯†å¤„ç†é˜²æ­¢è¢«çªƒå¬<br>æ–¹å¼ä¸€ï¼šé€šä¿¡åŠ å¯†ï¼Œä½¿ç”¨SSLå’ŒTLSå»ºç«‹å®‰å…¨é€šä¿¡çº¿è·¯ï¼Œå†åœ¨è¿™æ¡çº¿è·¯ä¸Šè¿›è¡ŒHTTPé€šä¿¡<br>æ–¹å¼äºŒï¼šå†…å®¹åŠ å¯†ï¼Œå¯¹HTTPåè®®ä¼ è¾“çš„å†…å®¹æœ¬èº«åŠ å¯†ï¼Œå‰æè¦æ±‚æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯éƒ½å…·å¤‡åŠ å¯†è§£å¯†æœºåˆ¶</p>
<p>2.ä¸éªŒè¯é€šä¿¡æ–¹çš„èº«ä»½ï¼Œå› æ­¤å¯èƒ½é­é‡ä¼ªè£…<br>é€ æˆåŸå› ï¼šæœåŠ¡å™¨ä¸ç®¡è°å‘æ¥çš„è¯·æ±‚éƒ½ä¼šç»™ä¸€ä¸ªå“åº”ï¼Œå®¢æˆ·ç«¯ä¸ç®¡æ˜¯è°çš„å“åº”éƒ½æ¥æ”¶<br>è§£å†³åŠæ³•ï¼šæŸ¥æ˜å¯¹æ–¹è¯ä¹¦ï¼Œè¯ä¹¦ç”±ç¬¬ä¸‰å‘é¢å‘ï¼Œé€šä¿¡å‰å…ˆç¡®è®¤å¯¹æ–¹è¯ä¹¦,éªŒè¯æ—¶è¦é€šä¿¡çš„åŒæ–¹åï¼Œå†ç»§ç»­é€šä¿¡</p>
<p>3.æ— æ³•è¯æ˜æŠ¥æ–‡å®Œæ•´æ€§ï¼Œæ‰€ä»¥æœ‰å¯èƒ½å·²é­ç¯¡æ”¹<br>ä¸­é—´äººæ”»å‡»ï¼šè¯·æ±‚æˆ–å“åº”åœ¨ä¼ è¾“é€”ä¸­ï¼Œé­æ”»å‡»è€…æ‹¦æˆªå¹¶ç¯¡æ”¹å†…å®¹çš„æ”»å‡»<br>é€ æˆåŸå› ï¼šä¸­é—´äººæ”»å‡»<br>è§£å†³åŠæ³•ï¼šMD5å’ŒSHA-1ç­‰æ•£åˆ—å€¼æ ¡éªŒçš„æ–¹æ³•,ä»¥åŠç”¨æ¥ç¡®è®¤æ–‡ä»¶çš„æ•°å­—ç­¾åæ–¹æ³•,ä½†ä»¥ä¸Šæ–¹æ³•éƒ½éœ€è¦ç”¨æˆ·æœ¬äººè‡ªå·±éªŒè¯</p>
<h2 id="HTTP-åŠ å¯†-è®¤è¯-å®Œæ•´æ€§ä¿æŠ¤-HTTPS"><a href="#HTTP-åŠ å¯†-è®¤è¯-å®Œæ•´æ€§ä¿æŠ¤-HTTPS" class="headerlink" title="HTTP+åŠ å¯†+è®¤è¯+å®Œæ•´æ€§ä¿æŠ¤ = HTTPS"></a>HTTP+åŠ å¯†+è®¤è¯+å®Œæ•´æ€§ä¿æŠ¤ = HTTPS</h2><p>HTTPé€šä¿¡æ¥å£éƒ¨åˆ†ç”¨SSLå’ŒTLSåè®®ä»£æ›¿ï¼Œå³ä¸å†æ˜¯httpä¸TCPé€šä¿¡ï¼Œè€Œæ˜¯httpå’ŒSSLå†å’ŒTCPé€šä¿¡<br>å…±äº«/å¯¹ç§°å¯†é’¥åŠ å¯†ï¼šåŠ å¯†å’Œè§£å¯†ç”¨åŒä¸€ä¸ªå¯†é’¥<br>å…¬å¼€å¯†é’¥åŠ å¯†ï¼š<br>ä½¿ç”¨ä¸€å¯¹éå¯¹ç§°çš„å¯†é’¥,ä¸€æŠŠå«åšç§æœ‰å¯†é’¥ï¼Œå¦ä¸€æŠŠå«åšå…¬å¼€å¯†é’¥,<br>ä½¿ç”¨å…¬å¼€å¯†é’¥è¿›è¡ŒåŠ å¯†å‘é€å¯†æ–‡ï¼Œæ”¶ä¿¡æ–¹æ”¶åˆ°ä¿¡æ¯åç”¨ç§æœ‰å¯†é’¥è¿›è¡Œè§£å¯†<br>å…¬å¼€å¯†é’¥åŠ å¯†æ–¹å¼æ¯”å…±äº«å¯†é’¥åŠ å¯†æ–¹å¼å¤„ç†èµ·æ¥æ›´éº»çƒ¦</p>
<p>HTTPSæ··åˆåŠ å¯†ï¼šåœ¨äº¤æ¢å¯†é’¥ç¯èŠ‚ä½¿ç”¨å…¬å¼€å¯†é’¥åŠ å¯†æ–¹å¼ï¼Œä¹‹åçš„å»ºç«‹é€šä¿¡äº¤æ¢æŠ¥æ–‡é˜¶æ®µåˆ™ä½¿ç”¨å…±äº«å¯†é’¥åŠ å¯†æ–¹å¼<br>ç¼ºç‚¹ï¼šæ— æ³•ä¿è¯å…¬å¼€å¯†é’¥æœ¬èº«æ˜¯çœŸæ­£çš„å…¬å¼€å¯†é’¥<br>è§£å†³åŠæ³•ï¼šä½¿ç”¨æ•°å­—è¯ä¹¦è¿›è¡ŒéªŒè¯ï¼Œå®¢æˆ·ç«¯æ ¹æ®æ•°å­—è¯ä¹¦æœºæ„çš„å…¬å¼€å¯†é’¥éªŒè¯æ•°å­—ç­¾åï¼Œä»è€ŒéªŒè¯æœåŠ¡å™¨å…¬å¼€å¯†é’¥<br><img src="/image/header6.png" alt="header6"><br>å…³äºè¯ä¹¦ï¼š<br>å®¢æˆ·ç«¯è¯ä¹¦ä¸€èˆ¬ç”±é“¶è¡Œç­‰ç‰¹æ®Šä¸šåŠ¡é¢å‘ï¼Œå› ä¸ºå®¢æˆ·ç«¯è¯ä¹¦éœ€è¦è´¹ç”¨æ”¯å‡º<br>è‡ªç­¾åè¯ä¹¦æ— æ³•ä¿è¯é€šä¿¡çœŸå®æ€§<br>ä¸­çº§è®¤è¯æœºæ„çš„è¯ä¹¦å¯èƒ½å˜æˆè‡ªè®¤è¯è¯ä¹¦<br>HTTPSçš„å®‰å…¨é€šä¿¡æœºåˆ¶<br><img src="/image/header7.png" alt="header7"><br><img src="/image/header8.png" alt="header8"><br>æ­¥éª¤12ç»“æŸä¹‹åï¼Œå®¢æˆ·ç«¯å†å‘é€TCP FINæŠ¥æ–‡æ¥å…³é—­ä¸TCPçš„é€šä¿¡<br>ç¼ºç‚¹ï¼š<br>1.ç”±äºåŠ å¯†è§£å¯†è¿‡ç¨‹æ¶ˆè€—å¤§é‡CPUä»¥åŠå†…å­˜ç­‰èµ„æºï¼Œå¯¼è‡´å¤„ç†é€Ÿåº¦å˜æ…¢<br>2.ç”±äºSSLé€šä¿¡éƒ¨åˆ†æ¶ˆè€—ç½‘ç»œèµ„æºï¼Œå¤„ç†é€šä¿¡éƒ¨åˆ†åˆä¼šæ¶ˆè€—ä¸€å®šæ—¶é—´ï¼Œå› æ­¤ç›¸æ¯”httpåˆä¼šå˜æ…¢<br>è§£å†³åŠæ³•ï¼šä½¿ç”¨SSLåŠ é€Ÿå™¨ä»¥åˆ†æ‹…è´Ÿè½½</p>
<p>ä¸ä½¿ç”¨httpsåŸå› ï¼š<br>1.å®¢æˆ·ç«¯è¦è€ƒè™‘æ¶ˆè€—cpu,å†…å­˜èµ„æºï¼ŒæœåŠ¡å™¨ç«¯è¦è€ƒè™‘è´Ÿè½½<br>2.è´­ä¹°è¯ä¹¦éœ€è¦å¼€é”€</p>
<h1 id="ç”¨æˆ·è®¤è¯"><a href="#ç”¨æˆ·è®¤è¯" class="headerlink" title="ç”¨æˆ·è®¤è¯"></a>ç”¨æˆ·è®¤è¯</h1><p>æ–¹æ³•æœ‰BASICè®¤è¯ï¼ŒDIGESTè®¤è¯ï¼ŒSSLå®¢æˆ·ç«¯è®¤è¯ï¼ŒFormBaseè®¤è¯</p>
<h1 id="HTTP-2-O"><a href="#HTTP-2-O" class="headerlink" title="HTTP/2.O"></a>HTTP/2.O</h1><p>http2.0åè®®ä¼˜ç‚¹<br>1.é‡‡ç”¨äºŒè¿›åˆ¶è¿›è¡Œæµå¼ä¼ è¾“ï¼Œä½¿ç”¨HPACKå‹ç¼©æ¶ˆæ¯å¤´ï¼ŒèŠ‚çœå®½å¸¦<br>2.ä½¿ç”¨tcpå¤šè·¯å¤ç”¨ï¼Œé™ä½ç½‘ç»œè¯·æ±‚é“¾æ¥æ—¶å»ºç«‹å…³é—­çš„å¼€é”€<br>è¿™é‡Œè¦ä¸åŒºåˆ«keep-aliveä½œåŒºåˆ†<br>keep-aliveå‘ç”Ÿåœ¨åº”ç”¨å±‚ï¼Œè€Œtcpå¤ç”¨å‘ç”Ÿåœ¨ä¼ è¾“å±‚<br>keep-aliveå¤šæ–‡ä»¶åªèƒ½ä¸²è¡Œä¼ è¾“ï¼Œä¸€ä¸ªä¼ å®Œå†ä¼ ä¸€ä¸ªï¼Œè€ŒTCPå¤šæ–‡ä»¶å¯ä»¥å¹¶è¡ŒåŒæ—¶ä¼ è¾“<br>3.å¯ä»¥æ§åˆ¶ä¼ è¾“æµä¼˜å…ˆçº§å’Œæµé‡<br>4.æ”¯æŒæœåŠ¡ç«¯æ¨é€</p>
<h2 id="å¤šè·¯å¤ç”¨"><a href="#å¤šè·¯å¤ç”¨" class="headerlink" title="å¤šè·¯å¤ç”¨"></a>å¤šè·¯å¤ç”¨</h2><h3 id="è§£å†³çš„é—®é¢˜"><a href="#è§£å†³çš„é—®é¢˜" class="headerlink" title="è§£å†³çš„é—®é¢˜"></a>è§£å†³çš„é—®é¢˜</h3><p>åœ¨http/1.xä¸‹,æµè§ˆå™¨å®¢æˆ·ç«¯åœ¨åŒä¸€æ—¶é—´ï¼Œé’ˆå¯¹åŒä¸€åŸŸåä¸‹çš„è¯·æ±‚æœ‰ä¸€å®šæ•°é‡é™åˆ¶ã€‚è¶…è¿‡é™åˆ¶æ•°ç›®çš„è¯·æ±‚ä¼šè¢«é˜»å¡<br>çªå‘æ€§å’ŒçŸ­æ—¶æ€§çš„ HTTP è¿æ¥å› ä¸ºä¸‰æ¬¡æ¡æ‰‹å’Œæ…¢å¯åŠ¨çš„å­˜åœ¨ï¼Œéå¸¸æµªè´¹æ—¶é—´(â€“&gt;å•ä¸€é•¿è¿æ¥)<br>(æ…¢å¯åŠ¨:TCPè¿æ¥åœ¨ä¸€å¼€å§‹ä¼šé™åˆ¶è¿æ¥æœ€å¤§é€Ÿåº¦ï¼Œç¡®è®¤æ•°æ®èƒ½å¤ŸæˆåŠŸä¼ è¾“åï¼Œéšæ—¶é—´æ¨ç§»æ‰ä¼šæ…¢æ…¢æé«˜ä¼ è¾“é€Ÿåº¦)</p>
<h3 id="å®ç°â€“äºŒè¿›åˆ¶åˆ†å¸§"><a href="#å®ç°â€“äºŒè¿›åˆ¶åˆ†å¸§" class="headerlink" title="å®ç°â€“äºŒè¿›åˆ¶åˆ†å¸§"></a>å®ç°â€“äºŒè¿›åˆ¶åˆ†å¸§</h3><p>åœ¨åº”ç”¨å±‚å’Œä¼ è¾“å±‚ä¹‹é—´å¢åŠ äºŒè¿›åˆ¶åˆ†å¸§å±‚,åº”ç”¨å±‚ç”Ÿæˆçš„æŠ¥æ–‡ä¼šåˆ†å‰²å°è£…ä¸ºæ›´å°çš„æ¶ˆæ¯å’Œå¸§ï¼Œå¹¶è¿›è¡ŒäºŒè¿›åˆ¶ç¼–ç <br>å…¶ä¸­é¦–éƒ¨headerå’Œè¯·æ±‚ä¸»ä½“request bodyåˆ†åˆ«è¢«å°è£…ä¸ºheader frame å’Œdata frame<br>åŒä¸€è¯·æ±‚æˆ–å“åº”çš„å¸§ä¼šæœ‰ç›¸åŒæ ‡å¿—ï¼Œä¼šæŒ‰ç…§ä¸€å®šå…ˆåé¡ºåºè¢«å‘é€ï¼Œ<br>æ‰€ä»¥ä¸åŒçš„è¯·æ±‚æˆ–è€…å“åº”å¯ä»¥äº’ç›¸ç©¿æ’ç€ç»™åˆ°å¯¹æ–¹<br>æœ€ç»ˆå®ç°å°±æ˜¯<br>ä¸€ä¸ªåŒ…å«ä¸Šç™¾ä¸ªèµ„æºçš„é¡µé¢ï¼Œåœ¨http1.xåè®®ä¸‹ä¼šåˆ›å»ºå¤šæ¡TCPé“¾æ¥æ¥è¿›è¡Œä¸²è¡Œè¯·æ±‚<br>åœ¨http/2.0ä¸‹åªä¼šåˆ›å»ºä¸€ä¸ªé•¿TCPé“¾æ¥ï¼Œæ‰€æœ‰çš„èµ„æºè¯·æ±‚åœ¨å‹ç¼©å¤„ç†åä¸€æ¬¡æ€§å‘å‡ºå»,å¹¶è¡Œåœ°åœ¨ä¸€ä¸ªTCPè¿æ¥ä¸ŠåŒå‘äº¤æ¢ä¿¡æ¯<br>ï¼ˆåŒä¸€é“¾æ¥ä¸Šæœ‰å¤šä¸ªä¸åŒæ–¹å‘çš„æ•°æ®æµåœ¨ä¼ è¾“ã€‚å®¢æˆ·ç«¯å¯ä»¥ä¸€è¾¹ä¹±åºå‘é€streamï¼Œä¹Ÿå¯ä»¥ä¸€è¾¹æ¥æ”¶æœåŠ¡å™¨çš„å“åº”ï¼Œè€ŒæœåŠ¡å™¨é‚£ç«¯åŒç†ã€‚ï¼‰</p>
<p>è€Œä¸”å¯ä»¥å¯¹èµ„æºè®¾ç½®ä¼˜å…ˆçº§ï¼Œä¼˜å…ˆçº§èƒ½åŠ¨æ€çš„è¢«æ”¹å˜ï¼Œä¼˜å…ˆçº§é«˜çš„èµ„æºèƒ½å¤Ÿè¢«æ›´å¿«çš„ä¸‹è½½ä¸‹æ¥å¹¶å¾—åˆ°æ‰§è¡Œ</p>
<h3 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h3><p>ç”±äº TCP è¿æ¥çš„å‡å°‘è€Œä½¿ç½‘ç»œæ‹¥å¡çŠ¶å†µå¾—ä»¥æ”¹å–„,ä½¿æ‹¥å¡å’Œä¸¢åŒ…æ¢å¤é€Ÿåº¦æ›´å¿«<br>å•ä¸€é•¿è¿æ¥å¤šèµ„æºçš„æ–¹å¼ï¼Œå‡å°‘æœåŠ¡ç«¯çš„é“¾æ¥å‹åŠ›,é¿å…ç½‘ç»œå¼€é”€ï¼Œå†…å­˜å ç”¨æ›´å°‘,æé«˜è¿æ¥ååé‡</p>
<h2 id="å‹ç¼©å¤´éƒ¨"><a href="#å‹ç¼©å¤´éƒ¨" class="headerlink" title="å‹ç¼©å¤´éƒ¨"></a>å‹ç¼©å¤´éƒ¨</h2><p>é€šä¿¡è¿æ¥å»ºç«‹ä¹‹åï¼Œç”±äºcookieå’Œuser agentå¾ˆå®¹æ˜“è†¨èƒ€ï¼Œ<br>æ¯æ¬¡è¯·æ±‚çš„å¤´éƒ¨å¦‚æœæœ‰ç›¸åŒçš„éƒ¨åˆ†ï¼Œè¿˜è¦ä»¥çº¯æ–‡æœ¬ä¼ è¾“é‡å¤å‘é€çš„è¯ï¼Œå°±ä¼šé€ æˆæµé‡æµªè´¹<br>å› æ­¤åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å­˜æ”¾ä¸€ä¸ªé¦–éƒ¨è¡¨ï¼Œæ¥è·Ÿè¸ªå’Œå­˜å‚¨ä¹‹å‰å‘é€çš„é”®å€¼å¯¹ï¼Œå¯¹äºç›¸åŒçš„å¤´éƒ¨ï¼Œä¸å¿…å†é€šè¿‡è¯·æ±‚å‘é€ï¼Œåªéœ€å‘é€ä¸€æ¬¡<br>å¦‚æœé¦–éƒ¨å‘ç”Ÿå˜åŒ–ï¼Œå°±åœ¨å‹ç¼©æ—¶åªå°†å˜åŒ–çš„æ•°æ®æ”¾åœ¨headerå¸§é‡Œé¢è¿›è¡Œå‘é€ï¼Œ<br>æ— è®ºæ˜¯å®¢æˆ·ç«¯è¿˜æ˜¯æœåŠ¡å™¨ç«¯æ”¶åˆ°é¦–éƒ¨å¸§åï¼Œå°±å¯¹é¦–éƒ¨è¡¨è¿›è¡Œæ›´æ–°</p>
<h2 id="æœåŠ¡å™¨æ¨é€"><a href="#æœåŠ¡å™¨æ¨é€" class="headerlink" title="æœåŠ¡å™¨æ¨é€"></a>æœåŠ¡å™¨æ¨é€</h2><p>å°±æ˜¯å®¢æˆ·ç«¯è¯·æ±‚ä¸€æ¬¡èµ„æºï¼ŒæœåŠ¡å™¨ç»™å¤šä¸ªå“åº”ï¼Œè¿™äº›å¤šä¸ªå“åº”å¾ˆæœ‰å¯èƒ½æ˜¯æµè§ˆå™¨è§£æHtmlåç»§ç»­è¦è¯·æ±‚çš„èµ„æºï¼Œå³ä¸»åŠ¨å°†èµ„æºæ¨é€ç»™å®¢æˆ·ç«¯<br>è€Œå®¢æˆ·ç«¯å¯ä»¥åšçš„å°±æ˜¯å¯ä»¥å°†ä»–ä»¬ç¼“å­˜èµ·æ¥åšå¤‡ç”¨</p>
<h2 id="å»¶ä¼¸é—®é¢˜"><a href="#å»¶ä¼¸é—®é¢˜" class="headerlink" title="å»¶ä¼¸é—®é¢˜"></a>å»¶ä¼¸é—®é¢˜</h2><p>1.å¦‚ä½•è§£å†³æ¨é€èµ„æºé‡å¤æˆ–ä¸éœ€è¦çš„é—®é¢˜ï¼Ÿ<br>å®¢æˆ·ç«¯ä½¿ç”¨ä¸€ä¸ªç®€æ´çš„ Cache Digest æ¥å‘Šè¯‰æœåŠ¡å™¨ï¼Œå“ªäº›ä¸œè¥¿å·²ç»åœ¨ç¼“å­˜ï¼Œå› æ­¤æœåŠ¡å™¨ä¹Ÿå°±ä¼šçŸ¥é“å“ªäº›æ˜¯å®¢æˆ·ç«¯æ‰€éœ€è¦çš„ã€‚<br><a href="https://www.zhihu.com/question/24774343/answer/96586977" target="_blank" rel="noopener">ç›¸å…³é“¾æ¥</a></p>
<p>2.ä¸ºä»€ä¹ˆHTTP2èƒ½å»æ‰SSLåœ¨HTTP1.xä¸Šçš„å¼€é”€<br>å•ä¸€çš„é•¿è¿æ¥ï¼Œå‡å°‘äº†SSLæ¡æ‰‹çš„å¼€é”€<br>å¤´éƒ¨è¢«å‹ç¼©ï¼Œå‡å°‘äº†æ•°æ®ä¼ è¾“é‡<br>å¤šè·¯å¤ç”¨èƒ½å¤§å¹…æé«˜ä¼ è¾“æ•ˆç‡ï¼Œä¸ç”¨ç­‰å¾…ä¸Šä¸€ä¸ªè¯·æ±‚çš„å“åº”<br>ä¸ç”¨åƒhttp1.xé‚£æ ·æŠŠå¤šä¸ªæ–‡ä»¶æˆ–è€…èµ„æºå¼„æˆä¸€ä¸ªæ–‡ä»¶æˆ–è€…èµ„æºï¼ˆhttp1.xå¸¸è§çš„ä¼˜åŒ–æ‰‹æ®µï¼‰ï¼Œ<br>è¿™æ—¶å€™ï¼Œç¼“å­˜å°±èƒ½æ›´å®¹æ˜“å‘½ä¸­å•Šï¼ˆhttp1.xé‡Œé¢ä½ æ‰æˆä¸€å›¢çš„ä¸œè¥¿æ€ä¹ˆå‘½ä¸­ç¼“å­˜ï¼Ÿï¼‰<br><a href="https://www.qcloud.com/community/article/541321?fromSource=gwzcw.93399.93399.93399" target="_blank" rel="noopener">ç›¸å…³é“¾æ¥</a></p>
<p><a href="https://www.zhihu.com/question/34074946" target="_blank" rel="noopener">ç›¸å…³é“¾æ¥</a></p>
<h2 id="é—ç•™ç–‘é—®"><a href="#é—ç•™ç–‘é—®" class="headerlink" title="é—ç•™ç–‘é—®"></a>é—ç•™ç–‘é—®</h2><p>äºŒè¿›åˆ¶åˆ†å¸§å’ŒTCPåˆ‡å‰²åˆ†åŒ…æ˜¯å¦‚ä½•å…·ä½“å®ç°çš„ï¼ŒäºŒè¿›åˆ¶åˆ†å¸§ä¼˜åŠ¿å…·ä½“åœ¨å“ªé‡Œï¼Ÿ<br>http/2.0å„å±‚åè®®å…·ä½“å·¥ä½œ<br><a href="https://github.com/zqjflash/http2-protocol" target="_blank" rel="noopener">å¾…è¯»</a></p>
<h1 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h1><p>ä»è¾“å…¥ URL åˆ°é¡µé¢å±•ç°ä¸­é—´å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ&lt;å¦å¤–çš„è§’åº¦çœ‹é—®é¢˜&gt;</p>
<p>DNS æŸ¥è¯¢ DNS ç¼“å­˜<br>å»ºç«‹ TCP è¿æ¥ï¼ˆä¸‰æ¬¡æ¡æ‰‹ï¼‰è¿æ¥å¤ç”¨<br>å‘é€ HTTP è¯·æ±‚ï¼ˆè¯·æ±‚çš„å››éƒ¨åˆ†ï¼‰<br>åå°å¤„ç†è¯·æ±‚<br>ç›‘å¬ 80 ç«¯å£<br>è·¯ç”±<br>æ¸²æŸ“ HTML æ¨¡æ¿<br>ç”Ÿæˆå“åº”<br>å‘é€ HTTP å“åº”<br>å…³é—­ TCP è¿æ¥ï¼ˆå››æ¬¡æŒ¥æ‰‹ï¼‰<br>è§£æ HTML<br>ä¸‹è½½ CSSï¼ˆç¼“å­˜<br>è§£æ CSS<br>ä¸‹è½½ JSï¼ˆç¼“å­˜<br>è§£æ JS<br>ä¸‹è½½å›¾ç‰‡<br>è§£æå›¾ç‰‡<br>æ¸²æŸ“ DOM æ ‘<br>æ¸²æŸ“æ ·å¼æ ‘<br>æ‰§è¡Œ JS</p>
<p>ä¸ƒå±‚åè®®<br>åº”ç”¨å±‚<br>è¡¨ç¤ºå±‚<br>ä¼šè¯å±‚<br>ä¼ è¾“å±‚<br>ç½‘ç»œå±‚<br>æ•°æ®é“¾è·¯å±‚<br>ç‰©ç†å±‚</p>
<h1 id="å®æ—¶é€šä¿¡åè®®"><a href="#å®æ—¶é€šä¿¡åè®®" class="headerlink" title="å®æ—¶é€šä¿¡åè®®"></a>å®æ—¶é€šä¿¡åè®®</h1><p>webSocket<br>Pollè½®è¯¢<br>Long-poll é•¿è½®è¯¢ ï¼ˆäºŒç»´ç ç™»å½•ï¼‰<br>DDP(åˆ†å¸ƒå¼æ•°æ®åè®®)[ä½¿ç”¨jsonæ•°æ®æ ¼å¼åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯è¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œä½†å­˜åœ¨å…¼å®¹é—®é¢˜]</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/js/promise.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/js/promise.html" itemprop="url">
                  å…³äºpromise
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-31T22:19:37+08:00">
                2017-08-31
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="promise"><a href="#promise" class="headerlink" title="promise"></a>promise</h1><p>Promise æ˜¯å¼‚æ­¥ç¼–ç¨‹çš„ä¸€ç§è§£å†³æ–¹æ¡ˆ</p>
<h1 id="ç®€å•ä½¿ç”¨"><a href="#ç®€å•ä½¿ç”¨" class="headerlink" title="ç®€å•ä½¿ç”¨"></a>ç®€å•ä½¿ç”¨</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">var promise = new Promise(function(resolve, reject) &#123;</span><br><span class="line">  // ... some code</span><br><span class="line"></span><br><span class="line">  if (/* å¼‚æ­¥æ“ä½œæˆåŠŸ */)&#123;</span><br><span class="line">    resolve(value);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    reject(error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">promise</span><br><span class="line">.then(function(value) &#123;      //resolve(value);å›è°ƒå‡½æ•°</span><br><span class="line">  // success</span><br><span class="line">&#125;, function(error) &#123;         // reject(error);å›è°ƒå‡½æ•°</span><br><span class="line">  // failure</span><br><span class="line">&#125;)</span><br><span class="line">.catch(function(error) &#123;</span><br><span class="line">  // å¤„ç† getJSON å’Œ å‰ä¸€ä¸ªå›è°ƒå‡½æ•°è¿è¡Œæ—¶å‘ç”Ÿçš„é”™è¯¯</span><br><span class="line">  console.log(&apos;å‘ç”Ÿé”™è¯¯ï¼&apos;, error);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>1ã€Promiseå¯¹è±¡æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°,ç”¨æ¥ç”ŸæˆPromiseå®ä¾‹,<br>2ã€Promiseæ„é€ å‡½æ•°çš„å‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°,è¯¥å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°,åˆ†åˆ«æ˜¯ä¸¤ä¸ªå‡½æ•°:resolveå’Œ reject<br>3ã€resolveå‡½æ•°åœ¨promiseå¯¹è±¡çŠ¶æ€ä»Pendingå˜ä¸ºFulfiledæ—¶è°ƒç”¨,å³å¼‚æ­¥æ“ä½œæˆåŠŸçš„æ—¶å€™è°ƒç”¨,å‚æ•°ä¸€èˆ¬ä¸ºè·å–çš„ç»“æœï¼Œæ–¹ä¾¿å›è°ƒå‡½æ•°ä½¿ç”¨ï¼Œæˆ–è€…å¦ä¸€ä¸ªpromiseå®ä¾‹,ç»§ç»­è¿›è¡Œå›è°ƒ<br>   rejectå‡½æ•°åœ¨promiseå¯¹è±¡çŠ¶æ€ä»Pendingå˜ä¸ºRejectedæ—¶è°ƒç”¨,å³å¼‚æ­¥æ“ä½œå¤±è´¥çš„æ—¶å€™è°ƒç”¨ï¼Œå‚æ•°ä¸€èˆ¬ä¸ºé”™è¯¯Errorå¯¹è±¡,æŠ¥å‡ºé”™è¯¯<br>4ã€Promiseå®ä¾‹ç”Ÿæˆä»¥åï¼Œå¯ä»¥ç”¨thenæ–¹æ³•åˆ†åˆ«æŒ‡å®šResolvedçŠ¶æ€å’ŒRejectedçŠ¶æ€çš„å›è°ƒå‡½æ•°<br>5ã€thenæ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œå‡ä¸ºåŒ¿åå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªåŒ¿åå‡½æ•°ä¸ºresolve()çš„å®šä¹‰,ç¬¬äºŒä¸ªå‚æ•°ä¸ºreject()çš„å®šä¹‰<br>6ã€Promiseå¯¹è±¡çŠ¶æ€å˜ä¸ºResolvedï¼Œåˆ™ä¼šè°ƒç”¨thenæ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°;å¦‚æœå¼‚æ­¥æ“ä½œæŠ›å‡ºé”™è¯¯,çŠ¶æ€å°±ä¼šå˜ä¸ºRejected,å°±ä¼šè°ƒç”¨catchæ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°,å¤„ç†è¿™ä¸ªé”™è¯¯ã€‚<br>   å¦å¤–,thenæ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œå¦‚æœè¿è¡Œä¸­æŠ›å‡ºé”™è¯¯ï¼Œä¹Ÿä¼šè¢«catchæ–¹æ³•æ•è·ã€‚<br>   æ³¨æ„,å¦‚æœthenæ–¹æ³•å®šä¹‰äº†reject(),å°†ä¸ä¼šå†è°ƒç”¨catchæ–¹æ³•,å¦‚æœthené‡Œé¢æ²¡æœ‰rejectï¼Œå‘ç”Ÿé”™è¯¯æ—¶å°†ä¼šè°ƒç”¨catch</p>
<h1 id="æ‰§è¡Œæµç¨‹"><a href="#æ‰§è¡Œæµç¨‹" class="headerlink" title="æ‰§è¡Œæµç¨‹"></a>æ‰§è¡Œæµç¨‹</h1><p>1.thenæ–¹æ³•ä¼šåœ¨ä¸promiseåŒæ­¥çš„ä»»åŠ¡å®Œæˆä¹‹åå†æ‰§è¡Œ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">let promise = new Promise(function(resolve, reject) &#123;</span><br><span class="line">  console.log(&apos;Promise&apos;);</span><br><span class="line">  resolve();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">promise.then(function() &#123;</span><br><span class="line">  console.log(&apos;Resolved.&apos;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">console.log(&apos;Hi!&apos;);</span><br><span class="line">//æ‰“å°é¡ºåº</span><br><span class="line">&quot;Promise&quot;</span><br><span class="line">&quot;Hi!&quot;</span><br><span class="line">&quot;Resolved.&quot;</span><br></pre></td></tr></table></figure></p>
<p>Promise æ–°å»ºåç«‹å³æ‰§è¡Œï¼Œæ‰€ä»¥é¦–å…ˆè¾“å‡ºçš„æ˜¯Promiseã€‚ç„¶å,thenæ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°,å°†åœ¨å½“å‰è„šæœ¬æ‰€æœ‰åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ‰ä¼šæ‰§è¡Œ,æ‰€ä»¥Resolvedæœ€åè¾“å‡ºã€‚</p>
<p>2ã€å¦‚æœPromise1çš„resolvedè¿”å›å¦ä¸€ä¸ªpromise2,é‚£Promise1çš„thenä¼šæ ¹æ®promise2çš„çŠ¶æ€å†³å®šæ‰§è¡Œrejectè¿˜æ˜¯resolved<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var p1 = new Promise(function (resolve, reject) &#123;</span><br><span class="line">  setTimeout(() =&gt; reject(new Error(&apos;fail&apos;)), 3000)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">var p2 = new Promise(function (resolve, reject) &#123;</span><br><span class="line">  setTimeout(() =&gt; resolve(p1), 1000)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">p2</span><br><span class="line">  .then(result =&gt; console.log(result))</span><br><span class="line">  .catch(error =&gt; console.log(error))</span><br><span class="line">// Error: fail</span><br></pre></td></tr></table></figure></p>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œp1æ˜¯ä¸€ä¸ªPromiseï¼Œ3ç§’ä¹‹åå˜ä¸ºrejectedã€‚p2çš„çŠ¶æ€åœ¨1ç§’ä¹‹åæ”¹å˜ï¼Œresolveæ–¹æ³•è¿”å›çš„æ˜¯p1ã€‚ç”±äºp2è¿”å›çš„æ˜¯å¦ä¸€ä¸ª Promiseï¼Œå¯¼è‡´p2è‡ªå·±çš„çŠ¶æ€æ— æ•ˆäº†ï¼Œç”±p1çš„çŠ¶æ€å†³å®šp2çš„çŠ¶æ€ã€‚æ‰€ä»¥ï¼Œåé¢çš„thenè¯­å¥éƒ½å˜æˆé’ˆå¯¹åè€…ï¼ˆp1ï¼‰ã€‚åˆè¿‡äº†2ç§’ï¼Œp1å˜ä¸ºrejectedï¼Œå¯¼è‡´è§¦å‘catchæ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚</p>
<p>3ã€åœ¨Promiseæ„é€ å‡½æ•°çš„å‚æ•°å‡½æ•°é‡Œ,åœ¨è°ƒç”¨resolve()æˆ–reject()ä¹‹å,ä»ä¼šæ‰§è¡Œåç»­è¯­å¥,ä½†å¦‚æœæ˜¯æŠ›é”™è¯­å¥å°†ä¸ä¼šæ‰§è¡Œ,åŒæ ·åœ¨æŠ›é”™è¯­å¥ä¹‹åçš„resolve()è°ƒç”¨ä¹Ÿä¸ä¼šè¢«æ‰§è¡Œ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">var promise = new Promise(function(resolve, reject) &#123;</span><br><span class="line">  resolve(&apos;ok&apos;);</span><br><span class="line">  console.log(&apos;1111&apos;)</span><br><span class="line">&#125;);</span><br><span class="line">promise</span><br><span class="line">  .then(function(value) &#123; console.log(value) &#125;)</span><br><span class="line">  .catch(function(error) &#123; console.log(&apos;æŠ¥é”™å•¦&apos;) &#125;);</span><br><span class="line">//1111</span><br><span class="line">//ok</span><br><span class="line">//å› ä¸ºç«‹å³ resolved çš„ Promise æ˜¯åœ¨æœ¬è½®äº‹ä»¶å¾ªç¯çš„æœ«å°¾æ‰§è¡Œï¼Œæ€»æ˜¯æ™šäºæœ¬è½®å¾ªç¯çš„åŒæ­¥ä»»åŠ¡,æ‰€ä»¥ä¼šå…ˆæ‰“å°1111,,å†æ‰“å°ok</span><br><span class="line"></span><br><span class="line">var promise = new Promise(function(resolve, reject) &#123;</span><br><span class="line">  return resolve(&apos;ok&apos;);</span><br><span class="line">  console.log(&apos;1111&apos;)</span><br><span class="line">&#125;);</span><br><span class="line">promise</span><br><span class="line">  .then(function(value) &#123; console.log(value) &#125;)</span><br><span class="line">  .catch(function(error) &#123; console.log(&apos;æŠ¥é”™å•¦&apos;) &#125;);</span><br><span class="line">//ok</span><br><span class="line">//return æ–¹æ³•é˜»æ­¢ç»§ç»­æ‰§è¡Œåç»­æ“ä½œ</span><br><span class="line"></span><br><span class="line">var promise = new Promise(function(resolve, reject) &#123;</span><br><span class="line">  resolve(&apos;ok&apos;);</span><br><span class="line">  throw new Error(&apos;test&apos;);</span><br><span class="line">&#125;);</span><br><span class="line">promise</span><br><span class="line">  .then(function(value) &#123; console.log(value) &#125;)</span><br><span class="line">  .catch(function(error) &#123; console.log(&apos;æŠ¥é”™å•¦&apos;) &#125;);</span><br><span class="line">  //ok</span><br><span class="line"></span><br><span class="line">var promise = new Promise(function(resolve, reject) &#123;</span><br><span class="line">  throw new Error(&apos;test&apos;);</span><br><span class="line">  resolve(&apos;ok&apos;);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line">promise</span><br><span class="line">  .then(function(value) &#123; console.log(value) &#125;)</span><br><span class="line">  .catch(function(error) &#123; console.log(&apos;æŠ¥é”™å•¦&apos;) &#125;);</span><br><span class="line">//æŠ¥é”™å•¦</span><br></pre></td></tr></table></figure></p>
<p>4ã€thenæ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªpromiseå¯¹è±¡ï¼Œå› æ­¤å¯ä»¥ç»§ç»­åœ¨thenå‡½æ•°åé¢åŠ thenå‡½æ•°,è¿™æ—¶å‰é¢thenå‡½æ•°åº”è¯¥ä¼šreturnä¸€ä¸ªç»“æœå€¼ä½œä¸ºåé¢thenå‡½æ•°çš„å‚æ•°,<br>   å‰é¢thenå‡½æ•°å¦‚æœæ‰§è¡Œresolve()åˆ™åé¢thenå‡½æ•°ä¹Ÿä¼šæ‰§è¡Œresolve(),å‰é¢thenå‡½æ•°å¦‚æœæ‰§è¡Œreject()åˆ™åé¢thenå‡½æ•°ä¹Ÿä¼šæ‰§è¡Œreject(),<br>   ä½†å¦‚æœå‰é¢thenå‡½æ•°returnä¸€ä¸ªpromiseå¯¹è±¡,é‚£åé¢çš„thenå‡½æ•°å°†ä¼šæ ¹æ®è¿™ä¸ªpromiseçš„æ‰§è¡Œç»“æœå»æ‰§è¡Œresolve()è¿˜æ˜¯reject()<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">var promise = new Promise(function(resolve, reject)&#123;</span><br><span class="line">    resolve(123)</span><br><span class="line">  &#125;);</span><br><span class="line">promise.then(function(json) &#123;</span><br><span class="line">  console.log(&apos;Contents: &apos; + json);</span><br><span class="line">  return 1223;</span><br><span class="line">&#125;, function(error) &#123;</span><br><span class="line">  console.error(&apos;å‡ºé”™äº†&apos;, error);</span><br><span class="line">  return &apos;2423&apos;</span><br><span class="line">&#125;)</span><br><span class="line">.then(function(val)&#123;</span><br><span class="line">  console.log(val);</span><br><span class="line">&#125;,function(val)&#123;</span><br><span class="line">  console.log(val)</span><br><span class="line">&#125;);</span><br><span class="line">//&quot;Contents: 123&quot;</span><br><span class="line">//1223</span><br><span class="line"></span><br><span class="line">var promise = new Promise(function(resolve, reject)&#123;</span><br><span class="line">    reject(456)</span><br><span class="line">  &#125;);</span><br><span class="line">promise.then(function(json) &#123;</span><br><span class="line">  console.log(&apos;Contents: &apos; + json);</span><br><span class="line">  return 1223;</span><br><span class="line">&#125;, function(val,error) &#123;</span><br><span class="line">  console.log(val);</span><br><span class="line">  console.error(&apos;å‡ºé”™äº†&apos;, error);</span><br><span class="line">  return &apos;2423&apos;</span><br><span class="line">&#125;)</span><br><span class="line">.then(function(val)&#123;</span><br><span class="line">  console.log(val);</span><br><span class="line">&#125;,function(val)&#123;</span><br><span class="line">  console.log(val)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">//456</span><br><span class="line">//&quot;å‡ºé”™äº†&quot;</span><br><span class="line">//&quot;2423&quot;</span><br><span class="line"></span><br><span class="line">var promise = new Promise(function(resolve, reject)&#123;</span><br><span class="line">//     resolve(123)</span><br><span class="line">    reject(456)</span><br><span class="line">  &#125;);</span><br><span class="line">var promise1 = new Promise(function(resolve, reject)&#123;</span><br><span class="line">    resolve(789)</span><br><span class="line">  &#125;);</span><br><span class="line">promise.then(function(json) &#123;</span><br><span class="line">  console.log(&apos;Contents: &apos; + json);</span><br><span class="line">  return 1223;</span><br><span class="line">&#125;, function(val,error) &#123;</span><br><span class="line">  console.log(val);</span><br><span class="line">  console.error(&apos;å‡ºé”™äº†&apos;, error);</span><br><span class="line">  return promise1</span><br><span class="line">&#125;)</span><br><span class="line">.then(function(val)&#123;</span><br><span class="line">  console.log(111+val);</span><br><span class="line">&#125;,function(val)&#123;</span><br><span class="line">  console.log(222+val)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">//456</span><br><span class="line">//&quot;å‡ºé”™äº†&quot;</span><br><span class="line">//900</span><br></pre></td></tr></table></figure></p>
<p>then æ–¹æ³•é“¾å¼è°ƒç”¨ç®­å¤´å‡½æ•°æ ¼å¼<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">promise.then(</span><br><span class="line">  param1 =&gt; &#123;&#125;</span><br><span class="line">).then(</span><br><span class="line">  param2 =&gt; &#123;&#125;,</span><br><span class="line">  err =&gt; &#123;&#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>5ã€promise å¦‚æœå‘ç”Ÿäº†é”™è¯¯,æ— è®ºreject()æˆ–è€…catchåœ¨å“ªä¸€å±‚ï¼Œä¼šä¸€ç›´å‘åä¼ é€’ï¼Œç›´åˆ°è¢«æ•è·ä¸ºæ­¢ï¼Œå³é‡åˆ°reject()æˆ–è€…catchå°±ä¼šæŠ›å‡ºæ¥,å¦‚æœåç»­æ‰€æœ‰å›è°ƒå‡½æ•°ä¸­éƒ½æ²¡æœ‰reject()æˆ–è€…catch,é”™è¯¯å°±ä¸ä¼šè¢«æŠ›å‡ºæ¥<br>  catchæ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªpromise,æ‰€ä»¥å¯ä»¥ç»§ç»­å†™then(),catch()æŠ›å®Œé”™ä¹‹åä¼šç»§ç»­æ‰§è¡Œåé¢è¿™ä¸ªthen()<br>  catch()é‡Œé¢è¿˜å¯ä»¥å†æŠ›é”™ï¼Œå¦‚æœcatchåé¢æ²¡æœ‰reject()æˆ–è€…catch()ï¼Œé”™è¯¯å°†ä¸ä¼šè¢«æŠ›å‡ºæ¥<br>  å¦‚æœcatchä¹‹å‰çš„promiseæ²¡æœ‰é‡åˆ°é”™è¯¯,catchä¹‹ååˆæœ‰then(),åˆ™æ‰§è¡Œæµç¨‹ä¼šè·³è¿‡catch,ç»§ç»­æ‰§è¡Œcatchåé¢çš„then<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">var promise = new Promise(function(resolve, reject) &#123;</span><br><span class="line">  throw new Error(&apos;test&apos;);</span><br><span class="line">&#125;);</span><br><span class="line">promise</span><br><span class="line">  .then(function(value) &#123; console.log(value); return &apos;2&apos;&#125;, function() &#123; //æ•è·test</span><br><span class="line">  throw new Error(&apos;test1&apos;);</span><br><span class="line">&#125;)</span><br><span class="line">  .then(function(value) &#123; console.log(value);return &apos;3&apos; &#125;)</span><br><span class="line">  .catch(function(error) &#123; console.log(error);return &apos;4&apos;&#125;) //æ•è·test1</span><br><span class="line">  .then(function(value) &#123; console.log(value); &#125;) //4</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">var promise = new Promise(function(resolve, reject) &#123;</span><br><span class="line">  resolve(&apos;1&apos;)</span><br><span class="line">&#125;);</span><br><span class="line">promise</span><br><span class="line">  .then(function(value) &#123; console.log(value); return &apos;2&apos;&#125;, function() &#123; //1</span><br><span class="line">  throw new Error(&apos;test1&apos;);</span><br><span class="line">&#125;)</span><br><span class="line">  .then(function(value) &#123; console.log(value);return &apos;3&apos; &#125;)//2</span><br><span class="line">  .catch(function(error) &#123; console.log(error) return &apos;4&apos;&#125;)</span><br><span class="line">  .then(function(value) &#123; console.log(value); &#125;)//3 æ²¡é‡åˆ°é”™è¯¯ç›´æ¥è·³è¿‡æ¥</span><br><span class="line"></span><br><span class="line">var promise = new Promise(function(resolve, reject) &#123;</span><br><span class="line">  throw new Error(&apos;test&apos;);</span><br><span class="line">&#125;);</span><br><span class="line">promise</span><br><span class="line">  .then(function(value) &#123; console.log(value); return &apos;2&apos;&#125;, function(error) &#123; //æ•è·test</span><br><span class="line">  console.log(error)</span><br><span class="line">  throw new Error(&apos;test1&apos;);</span><br><span class="line">&#125;)</span><br><span class="line">  .then(function(value) &#123; console.log(value);return &apos;3&apos; &#125;)</span><br><span class="line">  .catch(function(error) &#123; console.log(error);throw new Error(&apos;test2&apos;); return &apos;4&apos;&#125;) //æ•è·test1</span><br><span class="line">  .then(function(value) &#123; console.log(value); &#125;,function(error)&#123;//æ•è·test2</span><br><span class="line">   console.log(error)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>6.promise resolve return err å¹¶ä¸ä¼šè¢«catch æˆ–è€…rejectæ•è·,ä¼šå°†é”™è¯¯ä»¥å‚æ•°å½¢å¼ä¼ ç»™thençš„resolveå›è°ƒå‡½æ•°<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Promise.resolve()</span><br><span class="line">  .then(() =&gt; &#123;</span><br><span class="line">    return new Error(&apos;error!!!&apos;)</span><br><span class="line">  &#125;)</span><br><span class="line">  .then((res) =&gt; &#123;</span><br><span class="line">    console.log(&apos;then: &apos;, res) //æ‰“å°å‡ºerr</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch((err) =&gt; &#123;</span><br><span class="line">    console.log(&apos;catch: &apos;, err)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure></p>
<p>then æˆ– .catch è¿”å›çš„å€¼ä¸èƒ½æ˜¯ promise æœ¬èº«ï¼Œå¦åˆ™ä¼šé€ æˆæ­»å¾ªç¯<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const promise = Promise.resolve()</span><br><span class="line">  .then(() =&gt; &#123;</span><br><span class="line">    return promise</span><br><span class="line">  &#125;)</span><br><span class="line">promise.catch(console.error)</span><br><span class="line"></span><br><span class="line">//æŠ›é”™</span><br></pre></td></tr></table></figure></p>
<p>.then æˆ–è€… .catch çš„å‚æ•°æœŸæœ›æ˜¯å‡½æ•°ï¼Œä¼ å…¥éå‡½æ•°åˆ™ä¼šå‘ç”Ÿå€¼ç©¿é€<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Promise.resolve(1)</span><br><span class="line">  .then(2)</span><br><span class="line">  .then(Promise.resolve(3))</span><br><span class="line">  .then(console.log) ///æ‰“å°1</span><br></pre></td></tr></table></figure></p>
<h1 id="API"><a href="#API" class="headerlink" title="API"></a>API</h1><h2 id="Promise-all"><a href="#Promise-all" class="headerlink" title="Promise.all"></a>Promise.all</h2><p>ç”¨äºå°†å¤šä¸ª Promise å®ä¾‹ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„ Promise å®ä¾‹<br>var p = Promise.all([p1, p2, p3])<br>pçš„çŠ¶æ€ç”±p1ã€p2ã€p3å†³å®šï¼Œåˆ†æˆä¸¤ç§æƒ…å†µã€‚<br>ï¼ˆ1ï¼‰åªæœ‰p1ã€p2ã€p3çš„çŠ¶æ€éƒ½å˜æˆfulfilledï¼Œpçš„çŠ¶æ€æ‰ä¼šå˜æˆfulfilledï¼Œæ­¤æ—¶p1ã€p2ã€p3çš„è¿”å›å€¼ç»„æˆä¸€ä¸ªæ•°ç»„ï¼Œä¼ é€’ç»™pçš„å›è°ƒå‡½æ•°ã€‚</p>
<p>ï¼ˆ2ï¼‰åªè¦p1ã€p2ã€p3ä¹‹ä¸­æœ‰ä¸€ä¸ªè¢«rejectedï¼Œpçš„çŠ¶æ€å°±å˜æˆrejectedï¼Œæ­¤æ—¶ç¬¬ä¸€ä¸ªè¢«rejectçš„å®ä¾‹çš„è¿”å›å€¼ï¼Œä¼šä¼ é€’ç»™pçš„å›è°ƒå‡½æ•°ã€‚</p>
<h2 id="Promise-race"><a href="#Promise-race" class="headerlink" title="Promise.race"></a>Promise.race</h2><p>å°†å¤šä¸ªPromiseå®ä¾‹ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„Promiseå®ä¾‹<br>var p = Promise.race([p1, p2, p3]);<br>åªè¦p1ã€p2ã€p3ä¹‹ä¸­æœ‰ä¸€ä¸ªå®ä¾‹ç‡å…ˆæ”¹å˜çŠ¶æ€ï¼Œpçš„çŠ¶æ€å°±è·Ÿç€æ”¹å˜ã€‚é‚£ä¸ªç‡å…ˆæ”¹å˜çš„ Promise å®ä¾‹çš„è¿”å›å€¼ï¼Œå°±ä¼ é€’ç»™pçš„å›è°ƒå‡½æ•°</p>
<h2 id="Promise-resolve"><a href="#Promise-resolve" class="headerlink" title="Promise.resolve"></a>Promise.resolve</h2><p>å°†ç°æœ‰å¯¹è±¡è½¬ä¸ºPromiseå¯¹è±¡<br>var Promise = Promise.resolve(å‚æ•°);</p>
<h2 id="Promise-reject"><a href="#Promise-reject" class="headerlink" title="Promise.reject"></a>Promise.reject</h2><p>è¿”å›ä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ï¼Œè¯¥å®ä¾‹çš„çŠ¶æ€ä¸ºrejectedã€‚<br>var p = Promise.reject(â€˜å‡ºé”™äº†â€™);<br>Promise.reject()æ–¹æ³•çš„å‚æ•°ï¼Œä¼šåŸå°ä¸åŠ¨åœ°ä½œä¸ºrejectçš„ç†ç”±ï¼Œå˜æˆåç»­æ–¹æ³•çš„å‚æ•°</p>
<h2 id="done-finally"><a href="#done-finally" class="headerlink" title="done finally"></a>done finally</h2><p>doneæ–¹æ³•ï¼Œæ€»æ˜¯å¤„äºå›è°ƒé“¾çš„å°¾ç«¯ï¼Œä¿è¯æŠ›å‡ºä»»ä½•å¯èƒ½å‡ºç°çš„é”™è¯¯ï¼Œæ²¡æœ‰å‚æ•°<br>finallyæ–¹æ³•ç”¨äºæŒ‡å®šä¸ç®¡Promiseå¯¹è±¡æœ€åçŠ¶æ€å¦‚ä½•ï¼Œéƒ½ä¼šæ‰§è¡Œçš„æ“ä½œ<br>å¯ä»¥æ¥å—ä¸€ä¸ªæ™®é€šçš„å›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°ä¸ç®¡æ€æ ·éƒ½å¿…é¡»æ‰§è¡Œã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/js/obj.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/js/obj.html" itemprop="url">
                  å¯¹è±¡æ„é€ å’Œç»§æ‰¿
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-19T09:56:37+08:00">
                2017-08-19
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="å¯¹è±¡ç‰¹æ€§"><a href="#å¯¹è±¡ç‰¹æ€§" class="headerlink" title="å¯¹è±¡ç‰¹æ€§"></a>å¯¹è±¡ç‰¹æ€§</h1><p>å¯¹è±¡çš„å±æ€§åœ¨å®šä¹‰æ—¶ï¼Œéƒ½å¸¦æœ‰ä¸€äº›ç‰¹å¾å€¼ï¼Œjsé€šè¿‡è¿™äº›ç‰¹å¾å€¼å®šä¹‰ä»–ä»¬çš„è¡Œä¸º<br>è¿™äº›ç‰¹å¾å€¼æè¿°å¯¹è±¡å±æ€§çš„å„ç§ç‰¹å¾,æˆä¸ºå¯¹è±¡å±æ€§çš„ç‰¹æ€§<br>ç‰¹æ€§æ˜¯å†…éƒ¨å€¼,æ”¾åœ¨ä¸¤å¯¹æ–¹æ‹¬å·ä¸­è®¿é—®<br>ç‰¹æ€§åˆ†ä¸ºæ•°æ®å±æ€§å’Œè®¿é—®å™¨å±æ€§<br>æ•°æ®å±æ€§ï¼šConfigurableã€Enumerableã€Writableã€Value<br>è®¿é—®å™¨å±æ€§ï¼šConfigurableã€Enumerableã€Getã€Set<br>å®šä¹‰æŸä¸ªå±æ€§çš„ç‰¹æ€§ï¼šObject.defineProperty(å¯¹è±¡å,å¯¹è±¡å±æ€§å,{ç‰¹æ€§1ï¼šå€¼,ç‰¹æ€§2ï¼šå€¼â€¦})<br>å®šä¹‰å¤šä¸ªå±æ€§ç‰¹æ€§:Object.defineProperties(å¯¹è±¡å,{å±æ€§1ï¼š{ç‰¹æ€§1ï¼šå€¼,ç‰¹æ€§2ï¼šå€¼â€¦},å±æ€§2ï¼š{ç‰¹æ€§1:å€¼â€¦.}})<br>è¯»å–å±æ€§:Object.getOwnPropertyDescriptor(å¯¹è±¡å,å±æ€§å) è¿”å›ä¸€ä¸ªå¯¹è±¡</p>
<h1 id="æ„é€ å¯¹è±¡"><a href="#æ„é€ å¯¹è±¡" class="headerlink" title="æ„é€ å¯¹è±¡"></a>æ„é€ å¯¹è±¡</h1><h2 id="å·¥å‚æ¨¡å¼"><a href="#å·¥å‚æ¨¡å¼" class="headerlink" title="å·¥å‚æ¨¡å¼"></a>å·¥å‚æ¨¡å¼</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">function createobj(name,age)&#123;</span><br><span class="line">  var o=new Object();</span><br><span class="line">  o.name = name;</span><br><span class="line">  o.age = age;</span><br><span class="line">  o.sayName = function()&#123;</span><br><span class="line">    console.log(this.name)</span><br><span class="line">  &#125;;</span><br><span class="line">  return o;</span><br><span class="line">&#125;</span><br><span class="line">var person1 = createobj(&apos;gray&apos;,25);</span><br><span class="line">var person2 = createobj(&apos;black&apos;,26);</span><br><span class="line">person1.sayName()//gray</span><br><span class="line">person2.sayName()//black</span><br><span class="line">console.log(typeof person1)//object</span><br><span class="line">console.log(person1 instanceof createobj) //false</span><br></pre></td></tr></table></figure>
<p>ç¼ºç‚¹ï¼šæ— æ³•è¯†åˆ«å¯¹è±¡ç±»å‹</p>
<h2 id="å¯„ç”Ÿæ„é€ å‡½æ•°"><a href="#å¯„ç”Ÿæ„é€ å‡½æ•°" class="headerlink" title="å¯„ç”Ÿæ„é€ å‡½æ•°"></a>å¯„ç”Ÿæ„é€ å‡½æ•°</h2><p>å®šä¹‰æ ·å­åŒå·¥å‚æ¨¡å¼,åªä¸è¿‡åˆ›å»ºå®ä¾‹æ—¶ç”¨new æ“ä½œç¬¦<br>å°†åŒ…è£…å‡½æ•°å«åš æ„é€ å‡½æ•°<br>å®ä¾‹ä¸æ„é€ å‡½æ•°åŠå…¶åŸå‹æ²¡æœ‰å…³ç³»<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">function createobj(name,age)&#123;  //æ„é€ å‡½æ•°</span><br><span class="line">  var o=new Object();</span><br><span class="line">  o.name = name;</span><br><span class="line">  o.age = age;</span><br><span class="line">  o.sayName = function()&#123;</span><br><span class="line">    console.log(this.name)</span><br><span class="line">  &#125;;</span><br><span class="line">  return o;</span><br><span class="line">&#125;</span><br><span class="line">var person1 = new createobj(&apos;gray&apos;,25);</span><br><span class="line">person1.sayName()//gray</span><br><span class="line">console.log(person1 instanceof createobj) //false</span><br><span class="line">console.log(person1 instanceof Object) //true</span><br></pre></td></tr></table></figure></p>
<p>åº”ç”¨:ä¸ºæ— æ³•ä¿®æ”¹æ„é€ å‡½æ•°çš„å¯¹è±¡æ·»åŠ æ–¹æ³•<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//ç»™æ•°ç»„å¢åŠ ç‰¹æ®Šæ–¹æ³•</span><br><span class="line">function specialArray()&#123;</span><br><span class="line">  var values = new Array();</span><br><span class="line">  values.push.apply(values,arguments);</span><br><span class="line">  values.toPiedString = function(str)&#123; //ç‰¹æ®Šæ–¹æ³•</span><br><span class="line">    return this.join(str);</span><br><span class="line">  &#125;;</span><br><span class="line">  return values;</span><br><span class="line">&#125;</span><br><span class="line">var colors = new specialArray(&apos;red&apos;,&apos;blue&apos;);</span><br><span class="line">console.log(colors.toPiedString(&apos;|&apos;));//&quot;red|blue&quot;</span><br></pre></td></tr></table></figure></p>
<h2 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">function createobj(name,age)&#123;</span><br><span class="line">  this.name = name;</span><br><span class="line">  this.age = age;</span><br><span class="line">  this.sayName = function()&#123;</span><br><span class="line">    console.log(this.name)</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line">var person1 = new createobj(&apos;gray&apos;,25);</span><br><span class="line">person1.sayName(); //gray</span><br><span class="line"></span><br><span class="line">console.log(person1 instanceof createobj)//true</span><br><span class="line">console.log(person1 instanceof Object)//true</span><br><span class="line"></span><br><span class="line">console.log(window.name)//&apos;&apos;</span><br><span class="line">var person2 = createobj(&apos;black&apos;,26);</span><br><span class="line">console.log(person2) //undefined</span><br><span class="line">console.log(window.name) //black</span><br><span class="line">console.log(person1.sayName == window.sayName)//false</span><br><span class="line"></span><br><span class="line">var person3 = new createobj(&apos;orange&apos;,25);</span><br><span class="line">console.log(person1.sayName == person3.sayName)//false</span><br><span class="line"></span><br><span class="line">console.log(person1.constructor == createobj)//true</span><br><span class="line">console.log(person3.constructor == person1.constructor)//true</span><br></pre></td></tr></table></figure>
<p>1ã€æ„é€ å‡½æ•°çš„å®ä¾‹å‡æŒ‡å‘æ„é€ å‡½æ•°ã€‚ä¾‹ï¼šperson1ã€person3çš„constructorå‡æŒ‡å‘createobj)<br>2ã€ä¸ä½¿ç”¨new å…³é”®å­—è°ƒç”¨æ„é€ å‡½æ•°,æ„é€ å‡½æ•°çš„æ–¹æ³•å’Œå±æ€§ä¼šæŒ‚åˆ°windowä¸Šé¢ã€‚ä¾‹ï¼šperson2<br>3ã€å®šä¹‰åœ¨æ„é€ å‡½æ•°ä¸Šçš„æ–¹æ³•,åˆ›å»ºä¸åŒå®ä¾‹å,ä¸åŒå®ä¾‹å„è‡ªæ‹¥æœ‰è‡ªå·±çš„è¯¥æ–¹æ³•,ä¸åŒå®ä¾‹ä¹‹é—´æ„é€ å‡½æ•°æ–¹æ³•ä¸ç›¸ç­‰,ä¸å…±äº«</p>
<p>ä½¿ç”¨æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡,å¦‚æœç›¸è®©å¯¹è±¡æ–¹æ³•åœ¨ä¸åŒå®ä¾‹å®ç°å…±äº«,åˆ™åœ¨å®šä¹‰æ–¹æ³•æ—¶ï¼Œé‡‡ç”¨å¼•ç”¨å‡½æ•°çš„æ–¹æ³•<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function createobj(name,age)&#123;</span><br><span class="line">  this.name = name;</span><br><span class="line">  this.age = age;</span><br><span class="line">  this.sayName = sayName;</span><br><span class="line">&#125;</span><br><span class="line">function sayName()&#123;</span><br><span class="line">   console.log(this.name)</span><br><span class="line">&#125;</span><br><span class="line">var person1 = new createobj(&apos;gray&apos;,25);</span><br><span class="line">var person3 = new createobj(&apos;orange&apos;,25);</span><br><span class="line">console.log(person1.sayName == person3.sayName)//true</span><br></pre></td></tr></table></figure></p>
<p>ç¼ºç‚¹:è‹¥å¯¹è±¡éœ€è¦å®šä¹‰å¤šä¸ªæ–¹æ³•åˆ™éœ€è¦åˆ›å»ºå¤šä¸ªå…¨å±€å‡½æ•°ä¾›æ„é€ å‡½æ•°å¼•ç”¨,å¤±å»å°è£…æ€§</p>
<h2 id="åŸå‹æ¨¡å¼"><a href="#åŸå‹æ¨¡å¼" class="headerlink" title="åŸå‹æ¨¡å¼"></a>åŸå‹æ¨¡å¼</h2><p>åœ¨å¯¹è±¡çš„prototypeä¸­å®šä¹‰çš„å±æ€§å’Œæ–¹æ³•,å¯ä»¥åœ¨æ‰€æœ‰å®ä¾‹ä¸­å…±äº«<br>å®šä¹‰æ–¹æ³•ä¸€<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">function createobj(name,age)&#123;&#125;</span><br><span class="line">createobj.prototype.name = &apos;black&apos;;</span><br><span class="line">createobj.prototype.age = 26;</span><br><span class="line">createobj.prototype.sayName = function()&#123;</span><br><span class="line">   console.log(this.name)</span><br><span class="line">&#125;</span><br><span class="line">var person1 = new createobj();</span><br><span class="line">var person2 = new createobj();</span><br><span class="line">person1.sayName();//black</span><br><span class="line">person2.sayName();//black</span><br><span class="line">console.log(person1.sayName == person2.sayName)//true</span><br><span class="line"></span><br><span class="line">console.log(person1.constructor == createobj)//true</span><br><span class="line">console.log(person2.constructor == person1.constructor)//true</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">console.log(person1.age)   //26 æ¥è‡ªåŸå‹</span><br><span class="line">person1.age = 27;          //ç›¸å½“äºåˆ›å»ºäº†ä¸€ä¸ªå®ä¾‹å±æ€§</span><br><span class="line">console.log(person1.age)   //27 æ¥è‡ªå®ä¾‹å±æ€§</span><br><span class="line">console.log(person2.age)   //26 æ¥è‡ªåŸå‹</span><br><span class="line">delete person1.age;        //åˆ é™¤å®ä¾‹å±æ€§</span><br><span class="line">console.log(person1.age)   //26 æ¥è‡ªåŸå‹</span><br><span class="line">delete person1.age;        //ä¸èƒ½åˆ é™¤åŸå‹å±æ€§</span><br><span class="line">console.log(person1.age)   //26</span><br><span class="line">console.log(person2.age)   //26</span><br><span class="line"></span><br><span class="line">console.log(person1 == createobj.prototype)//false</span><br><span class="line">console.log(person1.prototype == createobj.prototype)//false</span><br><span class="line">console.log(createobj.prototype.isPrototypeOf(person1))//true</span><br><span class="line">console.log(person1.prototype) //undefined</span><br><span class="line">console.log(Object.getPrototypeOf(person1));//createobj.prototype</span><br><span class="line"></span><br><span class="line">console.log(person1.hasOwnProperty(&apos;name&apos;));//false</span><br><span class="line">console.log(&apos;name&apos; in person1);//true</span><br><span class="line">console.log(Object.keys(createobj.prototype));//[&quot;name&quot;, &quot;age&quot;, &quot;sayName&quot;]</span><br><span class="line">console.log(Object.getOwnPropertyNames(createobj.prototype));//[&quot;constructor&quot;, &quot;name&quot;, &quot;age&quot;, &quot;sayName&quot;]</span><br></pre></td></tr></table></figure></p>
<p><img src="/image/obj1.png" alt="obj1"><br>1ã€å®ä¾‹çš„å†…éƒ¨æŒ‡é’ˆ[[Prototype]] ä¼šæŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡,å®ƒæ˜¯ä¸èƒ½ç›´æ¥è®¿é—®çš„<br>2ã€æ„é€ å‡½æ•°çš„prototypeä¹Ÿä¼šæŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡,ä½†ä»–æ˜¯æ„é€ å‡½æ•°çš„ä¸€ä¸ªå±æ€§ï¼Œå¯ä»¥ç›´æ¥è®¿é—®<br>3ã€Object.getPrototypeOf(å®ä¾‹å); è¿”å›å®ä¾‹çš„åŸå‹å¯¹è±¡ .å³[[Prototype]]æŒ‡å‘çš„å¯¹è±¡<br>4ã€å®ä¾‹å.hasOwnProperty(å±æ€§åå­—ç¬¦ä¸²) ; åªæ£€æŸ¥å®ä¾‹çš„å®ä¾‹å±æ€§ä¸­æ˜¯å¦æœ‰è¯¥å±æ€§,æ²¡æœ‰çš„è¯,è¿”å›false,å¯ç”¨äºæ£€æŸ¥è¯¥å±æ€§åœ¨å®ä¾‹å±æ€§ä¸­ï¼Œè¿˜æ˜¯åœ¨åŸå‹å±æ€§ä¸­<br>5ã€åœ¨è·å–å±æ€§å€¼æ—¶ï¼Œå®ä¾‹å±æ€§ä¸­æœ‰è¯¥å±æ€§å°±å–è¯¥å®ä¾‹å±æ€§çš„å€¼,æ²¡æœ‰åˆ™ç”¨åŸå‹å±æ€§å€¼,åŸå‹å±æ€§ä¹Ÿæ²¡æœ‰çš„è¯åˆ™è¿”å›undefined<br>6ã€å®ä¾‹å±æ€§å¯ç”¨deleteåˆ é™¤,å®ä¾‹æ— æ³•æ›´æ”¹åŸå‹å±æ€§çš„å€¼<br>7ã€å±æ€§åå­—ç¬¦ä¸² in å®ä¾‹å; æ£€æŸ¥å®ä¾‹å’ŒåŸå‹æ‰€æœ‰å±æ€§ä¸­æ˜¯å¦æœ‰è¯¥å±æ€§,æœ‰çš„è¯å°±è¿”å›true;for-inå¾ªç¯å¯æšä¸¾çš„å±æ€§,åŒ…æ‹¬å®ä¾‹å±æ€§å’ŒåŸå‹å±æ€§<br>8ã€Object.keys(å¯¹è±¡å);è¿”å›å¯¹è±¡å¯æšä¸¾å±æ€§çš„å­—ç¬¦ä¸²æ•°ç»„<br>9ã€Object.getOwnPropertyNames(å¯¹è±¡å);è¿”å›æ‰€æœ‰å¯¹è±¡çš„å®ä¾‹å±æ€§,æ— è®ºå®ƒæ˜¯å¦æšä¸¾</p>
<p>å®šä¹‰æ–¹æ³•äºŒ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">function createobj()&#123;&#125;</span><br><span class="line">createobj.prototype=&#123;</span><br><span class="line">  name:&apos;seven&apos;,</span><br><span class="line">  sayName:function()&#123;</span><br><span class="line">    console.log(this.name)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">var person1 = new createobj();</span><br><span class="line">person1.sayName();//seven</span><br><span class="line">console.log(person1.constructor == createobj);//false</span><br><span class="line">console.log(person1.constructor == createobj.prototype);//false</span><br><span class="line">console.log(person1.constructor == Object);//true</span><br><span class="line">console.log(person1.constructor == createobj.prototype.constructor);//true</span><br><span class="line">console.log(person1.constructor);//function object()&#123;&#125;</span><br><span class="line"></span><br><span class="line">console.log(person1 instanceof Object);//true</span><br><span class="line">console.log(person1 instanceof createobj);//true</span><br></pre></td></tr></table></figure></p>
<p>1ã€å°†æŒ‚åœ¨æ„é€ å‡½æ•°åŸå‹ä¸Šçš„å±æ€§ä»¥ä¸€ä¸ªå¯¹è±¡çš„å½¢å¼ï¼Œä¸€èµ·èµ‹ç»™æ„é€ å‡½æ•°åŸå‹,å³æ„é€ å‡½æ•°åŸå‹è¢«èµ‹å€¼ä¸ºä¸€ä¸ªå¯¹è±¡<br>2ã€æ„é€ å‡½æ•°åŸå‹è¢«Objectåˆ›å»º,å®ä¾‹ã€æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡çš„æ„é€ å‡½æ•°ä¸ºObjectå¯¹è±¡<br>3ã€è‹¥åœ¨å®šä¹‰åŸå‹å¯¹è±¡æ—¶,æŒ‡å®šåŸå‹å¯¹è±¡çš„constructor,åˆ™å¯¹è±¡å®ä¾‹çš„constructorä¹Ÿä¼šè·Ÿç€æŒ‡åˆ°ç›¸åº”çš„å€¼<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">function createobj()&#123;&#125;</span><br><span class="line">createobj.prototype=&#123;</span><br><span class="line">  constructor:createobj, //æ˜ç¡®æŒ‡å‡º,åŒæ—¶ç‰¹æ€§çš„æšä¸¾å±æ€§ä¼šè¢«è®¾ç½®ä¸ºtrue,é»˜è®¤ä¸ºfalse</span><br><span class="line">  name:&apos;seven&apos;,</span><br><span class="line">  sayName:function()&#123;</span><br><span class="line">    console.log(this.name)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">var person1 = new createobj();</span><br><span class="line">person1.sayName();//seven</span><br><span class="line">console.log(person1.constructor == createobj);//true</span><br><span class="line">console.log(person1.constructor == createobj.prototype);//false</span><br><span class="line">console.log(person1.constructor == Object);//false</span><br><span class="line">console.log(person1.constructor == createobj.prototype.constructor);//true</span><br><span class="line">console.log(person1.constructor);//function createobj()&#123;&#125;</span><br><span class="line"></span><br><span class="line">console.log(person1 instanceof Object);//true</span><br><span class="line">console.log(person1 instanceof createobj);//true</span><br></pre></td></tr></table></figure></p>
<p>4ã€ å®ä¾‹ä¸­çš„æŒ‡é’ˆæŒ‡å‘åŸå‹ï¼Œä¸æŒ‡å‘æ„é€ å‡½æ•°<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">function createobj()&#123;&#125;</span><br><span class="line"></span><br><span class="line">var person1 = new createobj();</span><br><span class="line">console.log(person1 instanceof createobj);//true</span><br><span class="line">createobj.prototype=&#123;</span><br><span class="line">  constructor:createobj,</span><br><span class="line">  name:&apos;seven&apos;,</span><br><span class="line">  sayName:function()&#123;</span><br><span class="line">    console.log(this.name)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">//person1.sayName();//person1.sayName is not a function</span><br><span class="line">console.log(person1.constructor == createobj);//true</span><br><span class="line">console.log(person1.constructor == createobj.prototype);//false</span><br><span class="line">console.log(person1.constructor == Object);//false</span><br><span class="line">console.log(person1.constructor == createobj.prototype.constructor);//true</span><br><span class="line">console.log(person1.constructor);//function createobj()&#123;&#125;</span><br><span class="line"></span><br><span class="line">console.log(person1 instanceof Object);//true</span><br><span class="line">console.log(person1 instanceof createobj);//false</span><br></pre></td></tr></table></figure></p>
<p><img src="/image/obj2.png" alt="obj2"><br>å¯¹è±¡ç”Ÿæˆå®ä¾‹å,å†å»é‡å†™æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡,ä¼šå°†æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡æŒ‡å‘åæ¥è¢«èµ‹çš„å¯¹è±¡,<br>åˆ‡æ–­ä¸æ—§çš„åŸå‹å¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼Œæ–°çš„åŸå‹å¯¹è±¡ä¸å®ä¾‹æ²¡æœ‰ä»»ä½•å…³ç³»,å®ä¾‹ä»å¼•ç”¨æ—§çš„åŸå‹å¯¹è±¡</p>
<p>åŸå‹æ–¹æ³•å¯ç”¨äºä¿®æ”¹æ·»åŠ åŸç”Ÿå¯¹è±¡çš„å±æ€§æ–¹æ³•<br>ç¼ºç‚¹:åœ¨åŸå‹å¯¹è±¡prototypeä¸­çš„å±æ€§æ–¹æ³•å…¨éƒ½å…±äº«,å½“æ›´æ”¹ä¸€ä¸ªå®ä¾‹ä¸­çš„å±æ€§å€¼æ—¶,å…¶ä»–å®ä¾‹ä¸€èµ·å˜<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">//å®šä¹‰ä¸€</span><br><span class="line">function createobj(name,age)&#123;&#125;</span><br><span class="line">createobj.prototype.name = [1,2];</span><br><span class="line">createobj.prototype.sayName = function()&#123;</span><br><span class="line">   console.log(this.name)</span><br><span class="line">&#125;</span><br><span class="line">var person1 = new createobj();</span><br><span class="line">var person2 = new createobj();</span><br><span class="line">person1.sayName();//[1, 2]</span><br><span class="line">person2.sayName();//[1, 2]</span><br><span class="line">person1.name.push(3);</span><br><span class="line">person1.sayName();//[1, 2, 3]</span><br><span class="line">person2.sayName();//[1, 2, 3]</span><br><span class="line">//å®šä¹‰äºŒ</span><br><span class="line">function createobj()&#123;&#125;</span><br><span class="line">createobj.prototype=&#123;</span><br><span class="line">  constructor:createobj,</span><br><span class="line">  name:[1,2],</span><br><span class="line">  sayName:function()&#123;</span><br><span class="line">    console.log(this.name)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">var person1 = new createobj();</span><br><span class="line">var person2 = new createobj();</span><br><span class="line">console.log(person1.name)//[1, 2]</span><br><span class="line">console.log(person2.name)//[1, 2]</span><br><span class="line">person1.name.push(3);</span><br><span class="line">console.log(person1.name)//[1, 2, 3]</span><br><span class="line">console.log(person2.name)//[1, 2, 3]</span><br></pre></td></tr></table></figure></p>
<h2 id="æ„é€ å‡½æ•°-åŸå‹æ¨¡å¼"><a href="#æ„é€ å‡½æ•°-åŸå‹æ¨¡å¼" class="headerlink" title="æ„é€ å‡½æ•°+åŸå‹æ¨¡å¼"></a>æ„é€ å‡½æ•°+åŸå‹æ¨¡å¼</h2><p>æ„é€ å‡½æ•°å®šä¹‰å®ä¾‹å±æ€§ï¼Œ<br>åŸå‹æ¨¡å¼å®šä¹‰æ–¹æ³•å’Œå…±äº«å±æ€§<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">function createobj(name,age)&#123;</span><br><span class="line">  this.name = name;</span><br><span class="line">  this.age = age;</span><br><span class="line">  this.friends = [1,2];</span><br><span class="line">&#125;</span><br><span class="line">createobj.prototype=&#123;</span><br><span class="line">  constructor:createobj,</span><br><span class="line">  sayName:function()&#123;</span><br><span class="line">    console.log(this.name)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">var person1 = new createobj(&apos;halo&apos;,24);</span><br><span class="line">var person2 = new createobj(&apos;jack&apos;,25);</span><br><span class="line">person1.friends.push(3);</span><br><span class="line">console.log(person1.friends);//[1, 2, 3]</span><br><span class="line">console.log(person2.friends);//[1, 2]</span><br></pre></td></tr></table></figure></p>
<p>æ˜¯ç”¨æ¥å®šä¹‰å¼•ç”¨ç±»å‹çš„ä¸€ç§é»˜è®¤æ¨¡å¼</p>
<h2 id="åŠ¨æ€åŸå‹æ¨¡å¼"><a href="#åŠ¨æ€åŸå‹æ¨¡å¼" class="headerlink" title="åŠ¨æ€åŸå‹æ¨¡å¼"></a>åŠ¨æ€åŸå‹æ¨¡å¼</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">function createobj(name,age)&#123;</span><br><span class="line">  this.name = name;</span><br><span class="line">  this.age = age;</span><br><span class="line">  if(typeof this.sayName !=&apos;function&apos;)&#123;</span><br><span class="line">    createobj.prototype.sayName = function()&#123;</span><br><span class="line">     console.log(this.name)</span><br><span class="line">  &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">var person1 = new createobj(&apos;halo&apos;,24);</span><br><span class="line">var person2 = new createobj(&apos;jack&apos;,26);</span><br><span class="line">person1.sayName();//halo</span><br><span class="line">person2.sayName();//jack</span><br><span class="line"></span><br><span class="line">//ä¿®æ”¹åŸå‹</span><br><span class="line">createobj.prototype.sayName = function()&#123;</span><br><span class="line">     console.log(&apos;111&apos;)</span><br><span class="line">  &#125;</span><br><span class="line">person1.sayName();//111</span><br><span class="line">person2.sayName();//111</span><br><span class="line"></span><br><span class="line">//ä½¿ç”¨å­—é¢æ–¹å¼é‡å†™</span><br><span class="line">createobj.prototype=&#123;</span><br><span class="line">  constructor:createobj,</span><br><span class="line">  sayName:function()&#123;</span><br><span class="line">    console.log(222)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">var person3 = new createobj(&apos;kitty&apos;,24);</span><br><span class="line">person1.sayName();//111</span><br><span class="line">person2.sayName();//111</span><br><span class="line">person3.sayName();//222</span><br><span class="line">console.log(person1.prototype);//undefined</span><br><span class="line"></span><br><span class="line">//é‡å†™ä¸€ä¸ªåŸå‹æ–¹æ³•</span><br><span class="line">person1.sayName=function()&#123;</span><br><span class="line">  console.log(&apos;333&apos;);</span><br><span class="line">&#125;</span><br><span class="line">person1.sayName();//333</span><br><span class="line">person2.sayName();//111</span><br></pre></td></tr></table></figure>
<p>1ã€åˆ¤æ–­sayNameå‡½æ•°æ˜¯å¦å­˜åœ¨çš„è¯­å¥ï¼Œåªä¼šåœ¨åˆæ¬¡è°ƒç”¨æ„é€ å‡½æ•°çš„æ—¶å€™è¿è¡Œï¼Œå³ç¬¬ä¸€æ¬¡åˆ›å»ºå®ä¾‹çš„æ—¶å€™è¿è¡Œï¼Œ<br>  è¿è¡Œè¿‡åï¼Œæ„é€ å‡½æ•°åŸå‹ä¸­å°±ä¼šå­˜åœ¨sayNameå‡½æ•°ï¼Œå³å®Œæˆåˆå§‹åŒ–ï¼Œä¹‹åå°±ä¸ä¼šåœ¨è¿è¡Œ<br>2ã€å¯¹åŸå‹æ¨¡å¼å®šä¹‰çš„æ–¹æ³•å±æ€§èƒ½å¤Ÿåœ¨æ‰€æœ‰å®ä¾‹ä¸­ç«‹å³å¾—åˆ°æ”¾æ˜ <br>3ã€å¦‚æœå¯¹æ„é€ å‡½æ•°åŸå‹ä½¿ç”¨å­—é¢æ–¹å¼é‡å†™ï¼Œå°†åˆ‡æ–­å·²æœ‰å®ä¾‹ä¸æ„é€ å‡½æ•°åŸå‹çš„è”ç³»ï¼Œ<br>   å·²æœ‰å®ä¾‹ä¼šæŒ‡å‘å°±åŸå‹å¯¹è±¡ï¼Œæ–°å»ºå®ä¾‹ä¼šæŒ‡å‘æ–°åŸå‹å¯¹è±¡<br>4ã€åœ¨ä¸€ä¸ªå®ä¾‹ä¸­é‡å†™ä¸€ä¸ªåŸå‹æ–¹æ³•ï¼Œä¸ä¼šå½±å“åŸå‹å¯¹è±¡æ–¹æ³•ï¼Œå…¶ä»–å®ä¾‹å’Œæ–°å»ºå®ä¾‹ä»ä¼šè°ƒç”¨åŸå‹å¯¹è±¡æ–¹æ³•</p>
<h2 id="ç¨³å¦¥æ„é€ å‡½æ•°"><a href="#ç¨³å¦¥æ„é€ å‡½æ•°" class="headerlink" title="ç¨³å¦¥æ„é€ å‡½æ•°"></a>ç¨³å¦¥æ„é€ å‡½æ•°</h2><p>åˆ›å»ºå¯¹è±¡çš„å®ä¾‹æ–¹æ³•ï¼Œä¸ä½¿ç”¨this<br>ä¸ä½¿ç”¨newè°ƒç”¨æ„é€ å‡½æ•°<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">function createobj(name,age)&#123;  //æ„é€ å‡½æ•°</span><br><span class="line">  var o=new Object();</span><br><span class="line">  o.name = name;</span><br><span class="line">  o.age = age;</span><br><span class="line">  o.sayName = function()&#123;</span><br><span class="line">    console.log(this.name)ï¼›</span><br><span class="line">    console.log(this == o) </span><br><span class="line">  &#125;;</span><br><span class="line">  return o;</span><br><span class="line">&#125;</span><br><span class="line">var person1 = createobj(&apos;gray&apos;,25);</span><br><span class="line">person1.sayName()//gray true</span><br><span class="line"></span><br><span class="line">console.log(person1 instanceof createobj) //false</span><br></pre></td></tr></table></figure></p>
<p>åªç”¨é€šè¿‡sayNameå‡½æ•°è®¿é—®ä¼ å…¥åˆ°æ„é€ å‡½æ•°ä¸­çš„åŸå§‹æˆå‘˜</p>
<h1 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h1><h2 id="å®ä¾‹åŸå‹é“¾æ¨¡å¼"><a href="#å®ä¾‹åŸå‹é“¾æ¨¡å¼" class="headerlink" title="å®ä¾‹åŸå‹é“¾æ¨¡å¼"></a>å®ä¾‹åŸå‹é“¾æ¨¡å¼</h2><p>ç»§æ‰¿å‡½æ•°çš„åŸå‹è¢«èµ‹å€¼ä¸ºç¥–å…ˆå‡½æ•°çš„å®ä¾‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">//ç¥–å…ˆå‡½æ•°</span><br><span class="line">function Superfn()&#123;</span><br><span class="line">  this.pro = true;</span><br><span class="line">  this.color = [1,2];</span><br><span class="line">  this.getsuper = function()&#123;</span><br><span class="line">    console.log(&apos;aaa&apos;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">Superfn.prototype.getsuper=function()&#123;</span><br><span class="line">  console.log(&apos;bbb&apos;);</span><br><span class="line">&#125;</span><br><span class="line">//ç»§æ‰¿å‡½æ•°</span><br><span class="line">function Subfn()&#123;</span><br><span class="line">  this.subpro = false;</span><br><span class="line">  this.getsuper = function()&#123;</span><br><span class="line">    console.log(&apos;000&apos;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">Subfn.prototype = new Superfn();</span><br><span class="line">Subfn.prototype.getsuper = function()&#123;</span><br><span class="line">    console.log(&apos;ccc&apos;)</span><br><span class="line">  &#125;</span><br><span class="line">var ins = new Subfn();</span><br><span class="line">ins.getsuper();</span><br><span class="line"></span><br><span class="line">console.log(ins instanceof Object); //true</span><br><span class="line">console.log(ins instanceof Superfn); //true</span><br><span class="line">console.log(ins instanceof Subfn); //true</span><br><span class="line">console.log(Object.prototype.isPrototypeOf(ins)); //true</span><br><span class="line">console.log(Superfn.prototype.isPrototypeOf(ins)); //true</span><br><span class="line">console.log(Subfn.prototype.isPrototypeOf(ins)); //true</span><br><span class="line"></span><br><span class="line">var ins1 = new Subfn();</span><br><span class="line">console.log(ins.color)//[1,2]</span><br><span class="line">console.log(ins1.color)//[1,2]</span><br><span class="line">ins1.color.push(4);</span><br><span class="line">console.log(ins.color)//[1,2,4]</span><br><span class="line">console.log(ins1.color)//[1,2,4]</span><br></pre></td></tr></table></figure></p>
<p>1.ç»§æ‰¿å‡½æ•°å®ä¾‹çš„å±æ€§/æ–¹æ³•è°ƒç”¨é¡ºåºï¼š<br>è‡ªå·±å®šä¹‰çš„-&gt;ç»§æ‰¿å‡½æ•°å®ä¾‹-&gt;ç»§æ‰¿å‡½æ•°prototype-&gt;ç¥–å…ˆå‡½æ•°å®ä¾‹å±æ€§-&gt;ç¥–å…ˆå‡½æ•°prototype<br>2.å› ä¸ºæ‰€æœ‰å¼•ç”¨ç±»å‹é»˜è®¤ç»§æ‰¿object,æ‰€ä»¥è°ƒç”¨toStringç­‰æ–¹æ³•æ—¶ï¼Œå…¶å®è°ƒç”¨çš„çš„æ˜¯objectçš„prototype<br>3.é‡å†™åŸå‹ä¸­ç¥–å…ˆå‡½æ•°çš„æ–¹æ³•,ä¸€å®šè¦åœ¨ç»§æ‰¿å‡½æ•°åŸå‹è¢«èµ‹å€¼ç¥–å…ˆå‡½æ•°å®ä¾‹ä¹‹åï¼Œç›¸å½“äºç”¨å®ä¾‹æ–¹æ³•è¦†ç›–åŸå‹æ–¹æ³•<br>ä½†æ³¨æ„ä¸èƒ½ç”¨å­—é¢é‡æ–¹æ³•é‡å†™ç»§æ‰¿å‡½æ•°åŸå‹,è¿™æ ·ä¼šå¯¼è‡´ç»§æ‰¿å‡½æ•°åŸå‹é‡æ–°æŒ‡å‘æ–°å¯¹è±¡ï¼Œåˆ‡æ–­ä¸ç¥–å…ˆå‡½æ•°è”ç³»<br>4.å› ä¸ºç»§æ‰¿å‡½æ•°prototypeæŒ‡å‘ç¥–å…ˆå‡½æ•°å®ä¾‹æ—¶,ç¥–å…ˆå‡½æ•°æ‰€æœ‰å±æ€§ç›¸å½“äºç»§æ‰¿å‡½æ•°prototypeå±æ€§ï¼Œ<br>æ„é€ å‡½æ•°åŸå‹çš„å±æ€§ä¼šè¢«æ‰€æœ‰å®ä¾‹å…±äº«ï¼Œæ‰€ä»¥åˆ›å»ºç»§æ‰¿å‡½æ•°å®ä¾‹æ—¶,<br>ä¸èƒ½åƒç¥–å…ˆå‡½æ•°çš„æ„é€ å‡½æ•°ä¸­ä¼ é€’å‚æ•°,å› ä¸ºä¼šå¯¼è‡´å…¶ä»–å®ä¾‹åŒæ—¶å…±äº«è¿™äº›å‚æ•°å¯¼è‡´çš„åæœ</p>
<h2 id="å€Ÿç”¨æ„é€ å‡½æ•°"><a href="#å€Ÿç”¨æ„é€ å‡½æ•°" class="headerlink" title="å€Ÿç”¨æ„é€ å‡½æ•°"></a>å€Ÿç”¨æ„é€ å‡½æ•°</h2><p>ä½¿ç”¨apply()æˆ–è€…call()æ–¹æ³•ã€‚åœ¨ç»§æ‰¿å‡½æ•°æ„é€ å‡½æ•°ä¸­è°ƒç”¨ç¥–å…ˆå‡½æ•°æ„é€ å‡½æ•°ï¼Œè¿™æ ·ï¼Œ<br>åœ¨new ä¸€ä¸ªç»§æ‰¿å‡½æ•°å®ä¾‹æ—¶ï¼Œå°±ä¼šå»æ‰§è¡Œç¥–å…ˆå‡½æ•°ä¸­æ‰€æœ‰å¯¹è±¡åˆå§‹åŒ–ä»£ç ï¼Œæ¯ä¸ªå®ä¾‹éƒ½ä¼šå…·æœ‰è‡ªå·±çš„ç¥–å…ˆå‡½æ•°å±æ€§çš„å‰¯æœ¬<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">function Superfn(time)&#123;</span><br><span class="line">  this.color = [1,2];</span><br><span class="line">  this.time = time;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Superfn.prototype.getsuper=function()&#123;</span><br><span class="line">  console.log(&apos;bbb&apos;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Subfn()&#123;</span><br><span class="line">  Superfn.call(this,&apos;11:23:30&apos;);</span><br><span class="line">  this.age = 29;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var ins = new Subfn();</span><br><span class="line">var ins1 = new Subfn();</span><br><span class="line">console.log(ins.color) //[1, 2]</span><br><span class="line">console.log(ins1.color)//[1, 2]</span><br><span class="line">ins1.color.push(4);</span><br><span class="line">console.log(ins.color)//[1, 2]</span><br><span class="line">console.log(ins1.color)//[1, 2, 4]</span><br><span class="line"></span><br><span class="line">console.log(ins.time);//&quot;11:23:30&quot;</span><br><span class="line">console.log(ins.age);//29</span><br><span class="line"></span><br><span class="line">ins.getsuper();//ins.getsuper is not a function</span><br></pre></td></tr></table></figure></p>
<p>1ã€å¯ä»¥åƒç¥–å…ˆå‡½æ•°æ„é€ å‡½æ•°ä¸­ä¼ é€’å‚æ•°ï¼›<br>2ã€å®šä¹‰ç»§æ‰¿å‡½æ•°è‡ªå·±çš„å±æ€§å¿…é¡»æ”¾åœ¨è°ƒç”¨ç¥–å…ˆå‡½æ•°ä¹‹åï¼Œé˜²æ­¢ç¥–å…ˆå‡½æ•°é‡å†™ç»§æ‰¿å‡½æ•°å±æ€§<br>ç¼ºç‚¹ï¼š æ‰€æœ‰çš„å±æ€§åªèƒ½ä½¿ç”¨æ„é€ å‡½æ•°æ¨¡å¼å®šä¹‰ï¼Œè€Œä¸”,ç»§æ‰¿å‡½æ•°å®ä¾‹ï¼Œä¸èƒ½è°ƒç”¨ç¥–å…ˆå‡½æ•°åŸå‹ä¸Šçš„æ–¹æ³•</p>
<h2 id="ç»„åˆç»§æ‰¿"><a href="#ç»„åˆç»§æ‰¿" class="headerlink" title="ç»„åˆç»§æ‰¿"></a>ç»„åˆç»§æ‰¿</h2><p>åœ¨ç»§æ‰¿å‡½æ•°æ„é€ å‡½æ•°ä¸­è°ƒç”¨ç¥–å…ˆå‡½æ•°ï¼Œå®ç°å±æ€§ç»§æ‰¿<br>å°†ç»§æ‰¿å‡½æ•°çš„åŸå‹èµ‹å€¼ä¸ºç¥–å…ˆå‡½æ•°å®ä¾‹ï¼Œå®ç°æ–¹æ³•å¤åˆ¶<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">function Superfn(time)&#123;</span><br><span class="line">  this.color = [1,2];</span><br><span class="line">  this.time = time;</span><br><span class="line">&#125;</span><br><span class="line">Superfn.prototype.getsuper=function()&#123;</span><br><span class="line">  console.log(&apos;bbb&apos;);</span><br><span class="line">&#125;</span><br><span class="line">function Subfn()&#123;</span><br><span class="line">  Superfn.call(this,&apos;11:23:30&apos;);</span><br><span class="line">  this.age = 29;</span><br><span class="line">&#125;</span><br><span class="line">Subfn.prototype= new Superfn();</span><br><span class="line">var ins = new Subfn();</span><br><span class="line">var ins1 = new Subfn();</span><br><span class="line">console.log(ins.color)</span><br><span class="line">console.log(ins1.color)</span><br><span class="line">ins1.color.push(4);</span><br><span class="line">console.log(ins.color)</span><br><span class="line">console.log(ins1.color)</span><br><span class="line"></span><br><span class="line">console.log(ins.time);//&quot;11:23:30&quot;</span><br><span class="line">console.log(ins.age);//29</span><br><span class="line"></span><br><span class="line">ins.getsuper();//bbb</span><br></pre></td></tr></table></figure></p>
<p>ç¼ºç‚¹ï¼šè°ƒç”¨äº†ä¸¤æ¬¡Superfn()ï¼Œåˆå§‹åŒ–æ—¶ï¼ŒSubfn.prototypeä¸­çš„Superfnçš„å®ä¾‹å±æ€§ä¼šè¢«æ„é€ å‡½æ•°ä¸­åˆ›å»ºçš„Superfnçš„å®ä¾‹å±æ€§è¦†ç›–ï¼Œ<br>é‡å¤åˆ›å»ºï¼Œæ²¡å¿…è¦</p>
<h2 id="åŸå‹å¼ç»§æ‰¿"><a href="#åŸå‹å¼ç»§æ‰¿" class="headerlink" title="åŸå‹å¼ç»§æ‰¿"></a>åŸå‹å¼ç»§æ‰¿</h2><p>Object.creat()æ–¹æ³•åŸç†åƒå¦‚ä¸‹å‡½æ•°<br>function object(o){<br>    function F(){<br>      F.prototype = o;<br>    }<br>  return new F();<br>}<br>åŸå‹å¼ç»§æ‰¿ å³ä½¿ç”¨Object.creat(ç¥–å…ˆå¯¹è±¡)å®šä¹‰å®ä¾‹,å®ä¾‹ä¼šå…±äº«ç¥–å…ˆå¯¹è±¡å±æ€§æ–¹æ³•ï¼Œé€šè¿‡æ·»åŠ ç¬¬äºŒä¸ªå‚æ•°ï¼Œè¦†ç›–ç¥–å…ˆå¯¹è±¡å±æ€§ï¼Œæˆ–æ–°å¢å±æ€§<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Superfn=&#123;</span><br><span class="line">  color:[&apos;red&apos;,&apos;green&apos;],</span><br><span class="line">  getsuper:function()&#123;</span><br><span class="line">  console.log(222);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var test = Object.create(Superfn,&#123;getsuper:&#123;value:function()&#123;console.log(111)&#125;&#125;&#125;);</span><br><span class="line">var test1 = Object.create(Superfn,&#123;color:&#123;value:[1,2]&#125;,name:&#123;value:&apos;jack&apos;&#125;&#125;);</span><br><span class="line">console.log(test.color);//[&apos;red&apos;,&apos;green&apos;]</span><br><span class="line">console.log(test1.color,test1.name); //[1,2] jack</span><br><span class="line">console.log(test.name);//undefined</span><br><span class="line">test.getsuper(); //111</span><br><span class="line">test1.getsuper();//222</span><br></pre></td></tr></table></figure></p>
<h2 id="å¯„ç”Ÿå¼ç»§æ‰¿"><a href="#å¯„ç”Ÿå¼ç»§æ‰¿" class="headerlink" title="å¯„ç”Ÿå¼ç»§æ‰¿"></a>å¯„ç”Ÿå¼ç»§æ‰¿</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">function createAnthoer(oriobj)&#123;</span><br><span class="line">  var clone = Object(oriobj);//åˆ›å»ºoriobjå¯¹è±¡å‰¯æœ¬</span><br><span class="line">  clone.sayHi=function()&#123;//ä»¥æŸç§æ–¹å¼å¢å¼ºè¿™ä¸ªå¯¹è±¡ï¼Œä¾‹å¦‚å®šä¹‰è‡ªå·±çš„æ–¹æ³•</span><br><span class="line">    console.log(&apos;hi&apos;)</span><br><span class="line">  &#125;</span><br><span class="line">  return clone;</span><br><span class="line">&#125;</span><br><span class="line">var Superfn=&#123;</span><br><span class="line">  color:[&apos;red&apos;,&apos;green&apos;],</span><br><span class="line">&#125;</span><br><span class="line">var test = createAnthoer(Superfn);</span><br><span class="line">test.sayHi()//hi</span><br><span class="line">console.log(test.color);//[&quot;red&quot;, &quot;green&quot;]</span><br></pre></td></tr></table></figure>
<h2 id="æœ€ç†æƒ³ç»§æ‰¿-å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿"><a href="#æœ€ç†æƒ³ç»§æ‰¿-å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿" class="headerlink" title="æœ€ç†æƒ³ç»§æ‰¿-å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿"></a>æœ€ç†æƒ³ç»§æ‰¿-å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿</h2><p>å¯¹æ¯”ç»„åˆå¼ç»§æ‰¿<br>ä»…è°ƒç”¨ä¸€æ¬¡superfnå‡½æ•°ï¼Œé¿å…åœ¨Subfn.prototypeä¸­åˆ›å»ºå¤šä½™superfnå®ä¾‹å±æ€§<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">function inhertPrototype(subfn,superfn)&#123;</span><br><span class="line">  var prototype = Object(superfn.prototype);//åˆ›å»ºå¯¹è±¡ ï¼Œä»…ç»§æ‰¿ç¥–å…ˆå‡½æ•°åŸå‹</span><br><span class="line">  prototype.constructor = subfn;//å¢å¼ºå¯¹è±¡</span><br><span class="line">  subfn.prototype = prototype;//æŒ‡å®šå¯¹è±¡</span><br><span class="line">&#125;</span><br><span class="line">function Superfn(name)&#123;</span><br><span class="line">  this.color = [1,2];</span><br><span class="line">  this.name = name;</span><br><span class="line">&#125;</span><br><span class="line">Superfn.prototype.getsuper=function()&#123;</span><br><span class="line">  console.log(&apos;bbb&apos;);</span><br><span class="line">&#125;</span><br><span class="line">function Subfn(name,age)&#123;</span><br><span class="line">  Superfn.call(this,name); //ä»…ç»§æ‰¿ç¥–å…ˆå‡½æ•°å®ä¾‹å±æ€§ï¼Œä¸ä¼šç»§æ‰¿ç¥–å…ˆå‡½æ•°åŸå‹</span><br><span class="line">  this.age = age;</span><br><span class="line">&#125;</span><br><span class="line">Subfn.prototype.getsuper=function()&#123;</span><br><span class="line">  console.log(&apos;ccc&apos;);</span><br><span class="line">&#125;</span><br><span class="line">inhertPrototype(subfn,superfn);</span><br></pre></td></tr></table></figure></p>
<h1 id="ç±»"><a href="#ç±»" class="headerlink" title="ç±»"></a>ç±»</h1><p>ç±»çš„å®šä¹‰ç›¸å½“äºes5 å¯¹è±¡æ„é€ å‡½æ•°çš„å¦ä¸€ç§å†™æ³•ï¼Œä¸€ç§æ–°è¯­æ³•<br>es5 çš„ç»§æ‰¿ï¼Œå®è´¨æ˜¯å…ˆåˆ›é€ å­ç±»çš„å®ä¾‹å¯¹è±¡thisï¼Œç„¶åå†å°†çˆ¶ç±»çš„æ–¹æ³•æ·»åŠ åˆ°thisä¸Šé¢<br>es6 ç±»çš„ç»§æ‰¿ï¼Œå®è´¨æ˜¯å…ˆåˆ›é€ çˆ¶ç±»çš„å®ä¾‹å¯¹è±¡thisï¼ˆå¿…é¡»å…ˆè°ƒç”¨superæ–¹æ³•ï¼‰ï¼Œç„¶åå†ç”¨å­ç±»çš„æ„é€ å‡½æ•°ä¿®æ”¹this</p>
<h2 id="ç±»çš„å®šä¹‰"><a href="#ç±»çš„å®šä¹‰" class="headerlink" title="ç±»çš„å®šä¹‰"></a>ç±»çš„å®šä¹‰</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">//es5</span><br><span class="line">function Point(x, y) &#123;</span><br><span class="line">  this.x = x;</span><br><span class="line">  this.y = y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Point.prototype.toString = function () &#123;</span><br><span class="line">  return &apos;(&apos; + this.x + &apos;, &apos; + this.y + &apos;)&apos;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">var p = new Point(1, 2);</span><br><span class="line">//es6</span><br><span class="line">let methodName = &apos;getArea&apos;;</span><br><span class="line">class Point &#123;</span><br><span class="line">  constructor(x, y) &#123;</span><br><span class="line">    this.x = x;</span><br><span class="line">    this.y = y;</span><br><span class="line">    this.toString = function()&#123;</span><br><span class="line">      console.log(111);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  toString() &#123;</span><br><span class="line">    return &apos;(&apos; + this.x + &apos;, &apos; + this.y + &apos;)&apos;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  [methodName]() &#123;</span><br><span class="line">    console.log(666);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var temp = new Point(&apos;helo&apos;,&apos;world&apos;);</span><br><span class="line">console.log(temp)// constructorå®šä¹‰çš„å†…å®¹</span><br><span class="line">console.log(temp.toString()) //å…ˆæ‰¾å®ä¾‹å±æ€§ï¼Œåœ¨å»åŸå‹æ‰¾å±æ€§</span><br><span class="line"></span><br><span class="line">console.log(typeof Point) // &quot;function&quot;</span><br><span class="line">console.log(Point === Point.prototype.constructor) // true</span><br><span class="line"></span><br><span class="line">console.log(Object.keys(Point.prototype));//[]</span><br><span class="line">console.log(Object.getOwnPropertyNames(Point.prototype));//[&quot;constructor&quot;, &quot;toString&quot;]</span><br><span class="line">Object.assign(Point.prototype, &#123;</span><br><span class="line">  toString222()&#123;console.log(222);&#125;,</span><br><span class="line">  toValue()&#123;console.log(333);&#125;</span><br><span class="line">&#125;);</span><br><span class="line">temp.toString222()</span><br><span class="line">console.log(Object.keys(Point.prototype));//[&quot;toString222&quot;, &quot;toValue&quot;]</span><br><span class="line">console.log(Object.getOwnPropertyNames(Point.prototype));//[&quot;constructor&quot;, &quot;toString&quot;, &quot;toString222&quot;, &quot;toValue&quot;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">temp[methodName]() //666</span><br><span class="line"></span><br><span class="line">class Foo &#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    return Object.create(null);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">console.log(Foo.name)//Foo</span><br><span class="line">console.log(new Foo() instanceof Foo)//false</span><br><span class="line">var tt = new Foo();</span><br><span class="line">console.log(tt.__proto__ == Point) //TRUE</span><br><span class="line"></span><br><span class="line">var p1 = new Point(2,3);</span><br><span class="line">var p2 = new Point(3,2);</span><br><span class="line">console.log(p1.__proto__ === p2.__proto__)//true</span><br><span class="line">p1.__proto__.printName = function () &#123; console.log(&apos;Oops&apos;) &#125;;</span><br><span class="line">p1.printName() // &quot;Oops&quot;</span><br><span class="line">p2.printName() // &quot;Oops&quot;</span><br><span class="line">var p3 = new Point(4,2);</span><br><span class="line">p3.printName() // &quot;Oops</span><br><span class="line"></span><br><span class="line">//è¿™ä¸ªç±»çš„åå­—æ˜¯MyClassè€Œä¸æ˜¯Meï¼ŒMeåªåœ¨ Class çš„å†…éƒ¨ä»£ç å¯ç”¨ï¼ŒæŒ‡ä»£å½“å‰ç±»ã€‚</span><br><span class="line">const MyClass = class Me &#123;</span><br><span class="line">  getClassName() &#123;</span><br><span class="line">    console.log(Me.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">let inst = new MyClass();</span><br><span class="line">inst.getClassName() // Me</span><br><span class="line">console.log(MyClass.name)//me</span><br><span class="line"></span><br><span class="line">//ç«‹å³æ‰§è¡Œçš„ Class</span><br><span class="line">let person = new class &#123;</span><br><span class="line">  constructor(name) &#123;</span><br><span class="line">    this.name = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  sayName() &#123;</span><br><span class="line">    console.log(this.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;(&apos;å¼ ä¸‰&apos;);</span><br><span class="line"></span><br><span class="line">person.sayName(); // &quot;å¼ ä¸‰&quot;</span><br><span class="line"></span><br><span class="line">class MyClass &#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    // ...</span><br><span class="line">  &#125;</span><br><span class="line">  get prop() &#123;</span><br><span class="line">    return &apos;getter&apos;;</span><br><span class="line">  &#125;</span><br><span class="line">  set prop(value) &#123;</span><br><span class="line">    console.log(&apos;setter: &apos;+value);</span><br><span class="line">  s&#125;</span><br><span class="line">let inst = new MyClass();</span><br><span class="line">inst.prop = 123;// setter: 123</span><br><span class="line">console.log(inst.prop)// &apos;getter&apos;</span><br></pre></td></tr></table></figure>
<p>1.constructorå‡½æ•°å®šä¹‰å®ä¾‹å±æ€§ï¼Œthisä»£è¡¨å®ä¾‹å¯¹è±¡ï¼Œç”Ÿæˆå¯¹è±¡å®ä¾‹æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•ï¼Œ<br>  é»˜è®¤è¿”å›å®ä¾‹å¯¹è±¡thisï¼Œä¹Ÿå¯ä»¥æŒ‡å®šè¿”å›å¦å¤–ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™ç”Ÿæˆçš„å®ä¾‹å°†æ˜¯å¦å¤–è¿™ä¸ªå¯¹è±¡çš„å®ä¾‹<br>  å¦‚æœæ²¡æœ‰æ˜¾å¼å®šä¹‰ï¼Œä¸€ä¸ªç©ºçš„constructoræ–¹æ³•ä¼šè¢«é»˜è®¤æ·»åŠ ã€‚<br>  å…¶ä»–åœ¨constructorå‡½æ•°ä¹‹å¤–å®šä¹‰çš„å‡½æ•°å…¨éƒ½æŒ‚åœ¨ç±»çš„prototypeå¯¹è±¡ä¸Š(æ²¡æœ‰å®šä¹‰åœ¨thisä¸Šçš„å…¨éƒ½å®šä¹‰åœ¨classä¸Š)<br>  å…¶å®constructorå‡½æ•°ä¹ŸæŒ‚åœ¨prototypeå¯¹è±¡ä¸Š<br>2.å®šä¹‰åŸå‹æ–¹æ³•æ—¶ï¼Œä¸éœ€è¦åŠ ä¸Šfunctionè¿™ä¸ªå…³é”®å­—ï¼Œæ–¹æ³•ä¹‹é—´ä¸éœ€è¦é€—å·åˆ†éš”<br>3.ç±»çš„æ•°æ®ç±»å‹å°±æ˜¯å‡½æ•°ï¼Œç±»æœ¬èº«å°±æŒ‡å‘æ„é€ å‡½æ•°<br>4.ä½¿ç”¨Object.assign()æ–°å¢åŸå‹æ–¹æ³•,å®šä¹‰ç±»æ—¶å®šä¹‰çš„åŸå‹æ–¹æ³•æ˜¯ä¸å¯æšä¸¾çš„ï¼Œä½†Object.assign()æ–°å¢çš„å¯æšä¸¾<br>5.å¯ä»¥ä½¿ç”¨å˜é‡å€¼åšåŸå‹æ–¹æ³•å<br>6.å®šä¹‰å®ä¾‹ä»ä½¿ç”¨newå…³é”®å­—,ä¸”å¿…é¡»ä½¿ç”¨newå®šä¹‰ï¼Œå¦åˆ™ä¼šæŠ¥é”™<br>7.ç±»çš„æ‰€æœ‰å®ä¾‹å…±äº«ä¸€ä¸ªåŸå‹å¯¹è±¡,ä½¿ç”¨å®ä¾‹çš„<strong>proto</strong>å±æ€§æ”¹å†™åŸå‹,ä¼šæ”¹å˜â€œç±»â€çš„åŸå§‹å®šä¹‰ï¼Œå½±å“åˆ°æ‰€æœ‰å®ä¾‹<br>8.ç±»ä¹Ÿå¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼çš„å½¢å¼å®šä¹‰,é‡‡ç”¨ Class è¡¨è¾¾å¼ï¼Œå¯ä»¥å†™å‡ºç«‹å³æ‰§è¡Œçš„ Class<br>9.ç±»å¿…é¡»å…ˆå®šä¹‰å†ä½¿ç”¨ï¼Œæ— è®ºæ˜¯ç”Ÿæˆå®ä¾‹è¿˜æ˜¯è¿›è¡Œç»§æ‰¿<br>10.ç±»çš„nameå±æ€§æ€»æ˜¯è¿”å›ç´§è·Ÿåœ¨classå…³é”®å­—åé¢çš„ç±»åã€‚<br>11.å¯¹æŸä¸ªå±æ€§è®¾ç½®å¯¹åº”çš„å­˜å€¼å‡½æ•°å’Œå–å€¼å‡½æ•°ï¼Œå› æ­¤èµ‹å€¼å’Œè¯»å–è¡Œä¸ºéƒ½è¢«è‡ªå®šä¹‰äº†ã€‚å­˜å€¼å‡½æ•°å’Œå–å€¼å‡½æ•°æ˜¯è®¾ç½®åœ¨å±æ€§çš„ Descriptor å¯¹è±¡ä¸Šçš„ã€‚<br>12.é™æ€æ–¹æ³•,è¯¥æ–¹æ³•ä¸ä¼šè¢«å®ä¾‹ç»§æ‰¿ï¼Œè€Œæ˜¯ç›´æ¥é€šè¿‡ç±»æ¥è°ƒç”¨<br>å¦‚æœé™æ€æ–¹æ³•åŒ…å«thiså…³é”®å­—ï¼Œè¿™ä¸ªthisæŒ‡çš„æ˜¯ç±»ï¼Œè€Œä¸æ˜¯å®ä¾‹<br>çˆ¶ç±»çš„é™æ€æ–¹æ³•ï¼Œå¯ä»¥è¢«å­ç±»ç»§æ‰¿ã€‚<br>é™æ€æ–¹æ³•ä¹Ÿæ˜¯å¯ä»¥ä»superå¯¹è±¡ä¸Šè°ƒç”¨çš„<br>13.<br>ES6 ä¸ºnewå‘½ä»¤å¼•å…¥äº†ä¸€ä¸ªnew.targetå±æ€§ï¼Œè¯¥å±æ€§ä¸€èˆ¬ç”¨åœ¨æ„é€ å‡½æ•°ä¹‹ä¸­ï¼Œè¿”å›newå‘½ä»¤ä½œç”¨äºçš„é‚£ä¸ªæ„é€ å‡½æ•°ã€‚å¦‚æœæ„é€ å‡½æ•°ä¸æ˜¯é€šè¿‡newå‘½ä»¤è°ƒç”¨çš„ï¼Œnew.targetä¼šè¿”å›undefinedï¼Œå› æ­¤è¿™ä¸ªå±æ€§å¯ä»¥ç”¨æ¥ç¡®å®šæ„é€ å‡½æ•°æ˜¯æ€ä¹ˆè°ƒç”¨çš„ã€‚</p>
<h2 id="ç±»çš„ç»§æ‰¿"><a href="#ç±»çš„ç»§æ‰¿" class="headerlink" title="ç±»çš„ç»§æ‰¿"></a>ç±»çš„ç»§æ‰¿</h2><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">class Point &#123;</span><br><span class="line">  constructor(x, y) &#123;</span><br><span class="line">    this.x = x;</span><br><span class="line">    this.y = y;</span><br><span class="line">    console.log(new.target.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class ColorPoint extends Point &#123;</span><br><span class="line">  constructor(x, y, color) &#123;</span><br><span class="line">    super(x, y);</span><br><span class="line">    this.color = color;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let cp0 = new Point(25, 8);//&quot;Point&quot;</span><br><span class="line">let cp = new ColorPoint(25, 8, &apos;green&apos;);//&quot;ColorPoint&quot; super()ä½¿ç”¨</span><br><span class="line"></span><br><span class="line">console.log(cp instanceof ColorPoint)//true</span><br><span class="line">console.log(cp instanceof Point)//true</span><br><span class="line">console.log(Object.getPrototypeOf(ColorPoint) === Point)</span><br><span class="line"></span><br><span class="line">console.log(ColorPoint.__proto__ === Point) // true</span><br><span class="line">console.log(ColorPoint.prototype.__proto__ === Point.prototype) // true</span><br><span class="line"></span><br><span class="line">console.log(cp.__proto__.__proto__ === cp0.__proto__ )// true</span><br><span class="line">cp.__proto__.__proto__.printName = function () &#123;</span><br><span class="line">  console.log(&apos;Ha&apos;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">cp0.printName() // &quot;Ha&quot;</span><br></pre></td></tr></table></figure>
<p>1ã€ä½¿ç”¨extendså…³é”®å­—è¿›è¡Œç»§æ‰¿ï¼šclass å­ç±»å extends çˆ¶ç±»å{}<br>2ã€åœ¨å­ç±»æ„é€ å‡½æ•°constructorä¸­ä½¿ç”¨superå…³é”®å­—ç»§æ‰¿çˆ¶ç±»thiså¯¹è±¡,å¿…éœ€åœ¨superè¯­å¥ä¹‹åä½¿ç”¨this<br>3ã€Object.getPrototypeOfæ–¹æ³•å¯ä»¥ç”¨æ¥ä»å­ç±»ä¸Šè·å–çˆ¶ç±»<br>4ã€å­ç±»çš„<strong>proto</strong>å±æ€§ï¼Œè¡¨ç¤ºæ„é€ å‡½æ•°çš„ç»§æ‰¿ï¼Œæ€»æ˜¯æŒ‡å‘çˆ¶ç±»ã€‚<br>   å­ç±»prototypeå±æ€§çš„<strong>proto</strong>å±æ€§ï¼Œè¡¨ç¤ºæ–¹æ³•çš„ç»§æ‰¿ï¼Œæ€»æ˜¯æŒ‡å‘çˆ¶ç±»çš„prototypeå±æ€§ã€‚<br>5ã€å­ç±»çš„åŸå‹çš„åŸå‹ï¼Œæ˜¯çˆ¶ç±»çš„åŸå‹ï¼Œé€šè¿‡å­ç±»å®ä¾‹çš„<strong>proto</strong>.<strong>proto</strong>å±æ€§ï¼Œå¯ä»¥ä¿®æ”¹çˆ¶ç±»å®ä¾‹çš„è¡Œä¸º</p>
<h3 id="å…³äºsuperå…³é”®å­—"><a href="#å…³äºsuperå…³é”®å­—" class="headerlink" title="å…³äºsuperå…³é”®å­—"></a>å…³äºsuperå…³é”®å­—</h3><p>1ã€ç”¨ä½œå‡½æ•°<br>ä½œä¸ºå‡½æ•°æ—¶ï¼Œsuper()åªèƒ½ç”¨åœ¨å­ç±»çš„æ„é€ å‡½æ•°ä¹‹ä¸­ï¼Œç”¨åœ¨å…¶ä»–åœ°æ–¹å°±ä¼šæŠ¥é”™ï¼Œä»£è¡¨è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°<br>super()åœ¨è¿™é‡Œç›¸å½“äºparent.prototype.constructor.call(this),thisæŒ‡å­ç±»</p>
<p>2ã€ç”¨ä½œå¯¹è±¡</p>
<p>ä½œä¸ºå¯¹è±¡ä½¿ç”¨æ—¶,åœ¨æ™®é€šæ–¹æ³•ä¸­æŒ‡å‘çˆ¶ç±»åŸå‹å¯¹è±¡<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">class A &#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    this.p = 2;</span><br><span class="line">  &#125;</span><br><span class="line">  q() &#123;</span><br><span class="line">    console.log(this.p)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class B extends A &#123;</span><br><span class="line">    constructor() &#123;</span><br><span class="line">    super();</span><br><span class="line">    this.p =3</span><br><span class="line">    super.q();</span><br><span class="line">    super.p = 5;</span><br><span class="line">    console.log(super.p); // undefined</span><br><span class="line">    console.log(this.p); // 5</span><br><span class="line">    super.tt = 6;</span><br><span class="line">    console.log(this.tt); // 6</span><br><span class="line">    console.log(super.valueOf() instanceof B); // true</span><br><span class="line">  &#125;</span><br><span class="line">  get m() &#123;</span><br><span class="line">    return super.p;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let b = new B();//3</span><br><span class="line">console.log(b.m) // undefined</span><br></pre></td></tr></table></figure></p>
<p>åœ¨æ™®é€šæ–¹æ³•ä¸­æŒ‡å‘çˆ¶ç±»åŸå‹å¯¹è±¡,å³ä½¿ç”¨super.xxxx(),ç›¸å½“äºä½¿ç”¨parent.prototype.xxxx(),<br>æ‰€ä»¥åªèƒ½è°ƒç”¨çˆ¶ç±»åŸå‹å±æ€§æ–¹æ³•,ä¸èƒ½ä½¿ç”¨å®ä¾‹å±æ€§æ–¹æ³•</p>
<p>é€šè¿‡superè°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•æ—¶,superä¼šç»‘å®šå­ç±»çš„this,<br>å³åœ¨å­ç±»ä½¿ç”¨super.xxxx()æ—¶,xxxx()é‡Œé¢çš„thisæŒ‡å­ç±»<br>é€šè¿‡superå¯¹æŸä¸ªå±æ€§èµ‹å€¼,èµ‹å€¼çš„å±æ€§ä¼šå˜æˆå­ç±»å®ä¾‹çš„å±æ€§</p>
<p>åœ¨é™æ€æ–¹æ³•ä¸­ä½¿ç”¨superå°†æŒ‡å‘çˆ¶ç±»ï¼Œè€Œä¸æ˜¯çˆ¶ç±»çš„åŸå‹å¯¹è±¡ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">class Parent &#123;</span><br><span class="line">  static myMethod(msg) &#123;</span><br><span class="line">    console.log(&apos;static&apos;, msg);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  myMethod(msg) &#123;</span><br><span class="line">    console.log(&apos;instance&apos;, msg);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Child extends Parent &#123;</span><br><span class="line">  static myMethod(msg) &#123;</span><br><span class="line">    super.myMethod(msg);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  myMethod(msg) &#123;</span><br><span class="line">    super.myMethod(msg);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Child.myMethod(1); // static 1 superåœ¨é™æ€æ–¹æ³•ä¹‹ä¸­æŒ‡å‘çˆ¶ç±»</span><br><span class="line"></span><br><span class="line">var child = new Child();</span><br><span class="line">child.myMethod(2); // instance 2 åœ¨æ™®é€šæ–¹æ³•ä¹‹ä¸­æŒ‡å‘çˆ¶ç±»çš„åŸå‹å¯¹è±¡ã€‚</span><br></pre></td></tr></table></figure></p>
<h3 id="extendsç‰¹æ®Šå¯¹è±¡"><a href="#extendsç‰¹æ®Šå¯¹è±¡" class="headerlink" title="extendsç‰¹æ®Šå¯¹è±¡"></a>extendsç‰¹æ®Šå¯¹è±¡</h3><p>ç¬¬ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œå­ç±»ç»§æ‰¿Objectç±»ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">class A extends Object &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">A.__proto__ === Object // true</span><br><span class="line">A.prototype.__proto__ === Object.prototype // true</span><br></pre></td></tr></table></figure></p>
<p>è¿™ç§æƒ…å†µä¸‹ï¼ŒAå…¶å®å°±æ˜¯æ„é€ å‡½æ•°Objectçš„å¤åˆ¶ï¼ŒAçš„å®ä¾‹å°±æ˜¯Objectçš„å®ä¾‹ã€‚</p>
<p>ç¬¬äºŒç§ç‰¹æ®Šæƒ…å†µï¼Œä¸å­˜åœ¨ä»»ä½•ç»§æ‰¿ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">class A &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">A.__proto__ === Function.prototype // true</span><br><span class="line">A.prototype.__proto__ === Object.prototype // true</span><br></pre></td></tr></table></figure></p>
<p>è¿™ç§æƒ…å†µä¸‹ï¼ŒAä½œä¸ºä¸€ä¸ªåŸºç±»ï¼ˆå³ä¸å­˜åœ¨ä»»ä½•ç»§æ‰¿ï¼‰ï¼Œå°±æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œæ‰€ä»¥ç›´æ¥ç»§æ‰¿Function.prototypeã€‚ä½†æ˜¯ï¼ŒAè°ƒç”¨åè¿”å›ä¸€ä¸ªç©ºå¯¹è±¡ï¼ˆå³Objectå®ä¾‹ï¼‰ï¼Œæ‰€ä»¥A.prototype.<strong>proto</strong>æŒ‡å‘æ„é€ å‡½æ•°ï¼ˆObjectï¼‰çš„prototypeå±æ€§ã€‚</p>
<p>ç¬¬ä¸‰ç§ç‰¹æ®Šæƒ…å†µï¼Œå­ç±»ç»§æ‰¿nullã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">class A extends null &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">A.__proto__ === Function.prototype // true</span><br><span class="line">A.prototype.__proto__ === undefined // true</span><br></pre></td></tr></table></figure></p>
<p>è¿™ç§æƒ…å†µä¸ç¬¬äºŒç§æƒ…å†µéå¸¸åƒã€‚Aä¹Ÿæ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œæ‰€ä»¥ç›´æ¥ç»§æ‰¿Function.prototypeã€‚ä½†æ˜¯ï¼ŒAè°ƒç”¨åè¿”å›çš„å¯¹è±¡ä¸ç»§æ‰¿ä»»ä½•æ–¹æ³•ï¼Œæ‰€ä»¥å®ƒçš„<strong>proto</strong>æŒ‡å‘Function.prototypeï¼Œå³å®è´¨ä¸Šæ‰§è¡Œäº†ä¸‹é¢çš„ä»£ç ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">class C extends null &#123;</span><br><span class="line">  constructor() &#123; return Object.create(null); &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ç¬¬å››ç§æƒ…å†µ,å…è®¸ç»§æ‰¿åŸç”Ÿæ„é€ å‡½æ•°å®šä¹‰å­ç±»,ä½†æ— æ³•é€šè¿‡superæ–¹æ³•å‘çˆ¶ç±»Objectä¼ å‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class NewObj extends Object&#123;</span><br><span class="line">  constructor()&#123;</span><br><span class="line">    super(...arguments);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">var o = new NewObj(&#123;attr: true&#125;);</span><br><span class="line">console.log(o.attr === true)  // false</span><br></pre></td></tr></table></figure></p>
<h3 id="Mixin-æ¨¡å¼"><a href="#Mixin-æ¨¡å¼" class="headerlink" title="Mixin æ¨¡å¼"></a>Mixin æ¨¡å¼</h3><p>ä½¿ç”¨å¦‚ä¸‹mixå‡½æ•°å°†å¤šä¸ªå¯¹è±¡åˆæˆä¸ºä¸€ä¸ªç±»<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">function mix(...mixins) &#123;</span><br><span class="line">  class Mix &#123;&#125;</span><br><span class="line"></span><br><span class="line">  for (let mixin of mixins) &#123;</span><br><span class="line">    copyProperties(Mix, mixin);</span><br><span class="line">    copyProperties(Mix.prototype, mixin.prototype);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return Mix;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function copyProperties(target, source) &#123;</span><br><span class="line">  for (let key of Reflect.ownKeys(source)) &#123;</span><br><span class="line">    if ( key !== &quot;constructor&quot;</span><br><span class="line">      &amp;&amp; key !== &quot;prototype&quot;</span><br><span class="line">      &amp;&amp; key !== &quot;name&quot;</span><br><span class="line">    ) &#123;</span><br><span class="line">      let desc = Object.getOwnPropertyDescriptor(source, key);</span><br><span class="line">      Object.defineProperty(target, key, desc);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//ä½¿ç”¨ï¼šç»§æ‰¿è¿”å›çš„åˆæˆç±»</span><br><span class="line">class DistributedEdit extends mix(Loggable, Serializable) &#123;</span><br><span class="line">  // ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="å‡ ç§åˆ›å»ºæ–¹å¼å¯¹æ¯”"><a href="#å‡ ç§åˆ›å»ºæ–¹å¼å¯¹æ¯”" class="headerlink" title="å‡ ç§åˆ›å»ºæ–¹å¼å¯¹æ¯”"></a>å‡ ç§åˆ›å»ºæ–¹å¼å¯¹æ¯”</h1><p>let a = null                     ===&gt; null<br>let b = Object.create(null)      ===&gt; {} ä½†æ²¡æœ‰ä»»ä½•å±æ€§<br>let c = {}                       ===&gt; {} <strong>proto</strong>æŒ‡å‘Object<br>let d = new Object()             ===&gt; {} <strong>proto</strong>æŒ‡å‘Object<br>let e = new Object(null)         ===&gt; {} <strong>proto</strong>æŒ‡å‘Object<br>let f = Object.create(c)         ===&gt; {} <strong>proto</strong>æŒ‡å‘c, <strong>proto</strong>.<strong>proto</strong>æŒ‡å‘Object<br>!(obj4)[/image/ob4.png]<br>c instanceof Object , d instanceof Object ,e instanceof Object ===&gt; true</p>
<p>let dd = {a:1}<br>let cc = new Object(dd)<br>let ee = Object.create(dd)<br>console.log(cc,ee)<br>!(obj3)[/image/ob3.png]<br>dd.isPrototypeOf(cc)  ===&gt;false<br>dd.isPrototypeOf(ee)  ===&gt;true</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/safe/ajax.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/safe/ajax.html" itemprop="url">
                  Ajaxå’Œè·¨åŸŸ
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-19T09:56:37+08:00">
                2017-08-19
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="ajax"><a href="#ajax" class="headerlink" title="ajax"></a>ajax</h1><p>ajaxå…¨ç§°Asynchronous JavaScript and XMLï¼ˆå¼‚æ­¥çš„JavaScriptä¸XMLï¼‰ï¼Œæ˜¯ç½‘é¡µæ— éœ€åˆ·æ–°é¡µé¢ã€ä½¿ç”¨jsä¸æœåŠ¡å™¨è¿›è¡Œäº¤äº’çš„ä¸€ç§æŠ€æœ¯ã€‚</p>
<p>ajaxçš„åŸºæœ¬æµç¨‹å¯ä»¥æ¦‚æ‹¬ä¸ºï¼šé¡µé¢ä¸Šjsè„šæœ¬å®ä¾‹åŒ–ä¸€ä¸ªXMLHttpRequestå¯¹è±¡ï¼Œè®¾ç½®å¥½æœåŠ¡å™¨ç«¯çš„urlã€å¿…è¦çš„æŸ¥è¯¢å‚æ•°ã€å›è°ƒå‡½æ•°ä¹‹åï¼Œå‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œ<br>æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚ä¹‹åå°†å¤„ç†ç»“æœè¿”å›ç»™é¡µé¢ï¼Œè§¦å‘äº‹å…ˆç»‘å®šçš„å›è°ƒå‡½æ•°ã€‚<br>è¿™æ ·ï¼Œé¡µé¢è„šæœ¬å¦‚æœæƒ³è¦æ”¹å˜ä¸€ä¸ªåŒºåŸŸçš„å†…å®¹ï¼Œåªéœ€è¦é€šè¿‡ajaxå‘æœåŠ¡å™¨è·å–ä¸è¯¥åŒºåŸŸæœ‰å…³çš„å°‘é‡æ•°æ®ï¼Œåœ¨å›è°ƒå‡½æ•°ä¸­å°†è¯¥åŒºåŸŸçš„å†…å®¹æ›¿æ¢æ‰å³å¯ï¼Œä¸éœ€è¦åˆ·æ–°æ•´ä¸ªé¡µé¢ã€‚</p>
<p>XMLHttpRequeståœ¨å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼šåŒæ­¥ä¸å¼‚æ­¥ã€‚<br>åŒæ­¥æ–¹å¼æ˜¯è¯·æ±‚å‘å‡ºåï¼Œä¸€ç›´åˆ°æ”¶åˆ°æœåŠ¡å™¨è¿”å›çš„æ•°æ®ä¸ºæ­¢ï¼Œæµè§ˆå™¨è¿›ç¨‹è¢«é˜»å¡ï¼Œé¡µé¢ä¸Šä»€ä¹ˆäº‹ä¹Ÿåšä¸äº†ã€‚<br>è€Œå¼‚æ­¥æ–¹å¼åˆ™ä¸ä¼šé˜»å¡æµè§ˆå™¨è¿›ç¨‹ï¼Œåœ¨æœåŠ¡ç«¯è¿”å›æ•°æ®å¹¶è§¦å‘å›è°ƒå‡½æ•°ä¹‹å‰ï¼Œç”¨æˆ·ä¾ç„¶å¯ä»¥åœ¨è¯¥é¡µé¢ä¸Šè¿›è¡Œå…¶ä»–æ“ä½œã€‚<br>ajaxçš„æ ¸å¿ƒæ˜¯å¼‚æ­¥æ–¹å¼ï¼Œè€ŒåŒæ­¥æ–¹å¼åªæœ‰åœ¨æå…¶ç‰¹æ®Šçš„æƒ…å†µä¸‹æ‰ä¼šè¢«ç”¨åˆ°ã€‚</p>
<p>XMLHttpRequest å¯¹è±¡æ˜¯ä¸€ä¸ªæ¥å£ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªhttpè¯·æ±‚å¯¹è±¡å®ä¾‹,æ‰“å¼€ä¸€ä¸ªURLï¼Œç„¶åå‘é€è¿™ä¸ªè¯·æ±‚,<br>å½“ä¼ è¾“å®Œæ¯•åï¼Œç»“æœçš„HTTPçŠ¶æ€ä»¥åŠè¿”å›çš„å“åº”å†…å®¹ä¹Ÿå¯ä»¥ä»è¯·æ±‚å¯¹è±¡ä¸­è·å–<br>äº”ç§çŠ¶æ€<br>0ï¼šæœªæ‰“å¼€<br>1ï¼šæœªå‘é€<br>2ï¼šä»¥è·å–å“åº”å¤´<br>3ï¼šæ­£åœ¨ä¸‹è½½å“åº”ä½“<br>4ï¼šè¯·æ±‚å®Œæˆ<br><a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest" target="_blank" rel="noopener">XMLHttpRequest API</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">const xhr = new XMLHttpRequest()</span><br><span class="line"></span><br><span class="line">xhr.onreadystatechange = function () &#123;</span><br><span class="line">  switch (xhr.readyState) &#123;</span><br><span class="line">    case 0:</span><br><span class="line">      // UNSENT (æœªæ‰“å¼€)</span><br><span class="line">      debugger</span><br><span class="line">      break</span><br><span class="line">    case 1:</span><br><span class="line">      // OPENED  (æœªå‘é€)</span><br><span class="line">      debugger</span><br><span class="line">      break</span><br><span class="line">    case 2:</span><br><span class="line">      // HEADERS_RECEIVED (å·²è·å–å“åº”å¤´)</span><br><span class="line">      debugger</span><br><span class="line">      break</span><br><span class="line">    case 3:</span><br><span class="line">      // LOADING (æ­£åœ¨ä¸‹è½½å“åº”ä½“)</span><br><span class="line">      debugger</span><br><span class="line">      break</span><br><span class="line">    case 4:</span><br><span class="line">      // DONE (è¯·æ±‚å®Œæˆ)</span><br><span class="line">      if (xhr.status === 200) &#123;</span><br><span class="line">        console.log(xhr.responseType)</span><br><span class="line">        console.log(xhr.responseText)</span><br><span class="line">        console.log(xhr.response)</span><br><span class="line">      &#125;</span><br><span class="line">      break</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">xhr.open(&apos;GET&apos;, &apos;http://y.com:7001/json&apos;, true)</span><br><span class="line">xhr.send(null)</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ajax å°è£…POST,GETè¯·æ±‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">function Ajax(method,url,callback,data,async)&#123;</span><br><span class="line">  method = method.toUpperCase()</span><br><span class="line">  async = async || true</span><br><span class="line">  let xmlHttp = null;</span><br><span class="line">  if (XMLHttpRequest) &#123;</span><br><span class="line">      xmlHttp = new XMLHttpRequest();//æœåŠ¡å™¨è¯·æ±‚å¯¹è±¡</span><br><span class="line">  &#125;</span><br><span class="line">  else &#123;</span><br><span class="line">      xmlHttp = new ActiveXObject(&apos;Microsoft.XMLHTTP&apos;);//å…¼å®¹å¾®è½¯è¯·æ±‚å¯¹è±¡</span><br><span class="line">  &#125;</span><br><span class="line">  let params = [];</span><br><span class="line">  for (var key in data)&#123;</span><br><span class="line">      params.push(key + &apos;=&apos; + opt.data[key]);</span><br><span class="line">  &#125;</span><br><span class="line">  params = params.join(&apos;&amp;&apos;);</span><br><span class="line">  if (method === &apos;POST&apos;) &#123;//è¯·æ±‚æ–¹æ³•ä¸ºPOST,åˆ™æ‰§è¡Œå¦‚ä¸‹æ“ä½œ</span><br><span class="line">    xmlHttp.open(method, url, async);</span><br><span class="line">    xmlHttp.setRequestHeader(&apos;Content-Type&apos;, &apos;application/x-www-form-urlencoded;charset=utf-8&apos;);</span><br><span class="line">    xmlHttp.send(params);</span><br><span class="line">  &#125;</span><br><span class="line">  else if (method === &apos;GET&apos;) &#123;//è¯·æ±‚æ–¹æ³•ä¸ºGET,åˆ™æ‰§è¡Œå¦‚ä¸‹æ“ä½œ</span><br><span class="line">    xmlHttp.open(opt.method, opt.url + &apos;?&apos; + params, async);</span><br><span class="line">    xmlHttp.send(null);</span><br><span class="line">  &#125; </span><br><span class="line">  xmlHttp.onreadystatechange = function () &#123;</span><br><span class="line">    if (xmlHttp.readyState == 4 &amp;&amp; xmlHttp.status == 200) &#123;//å“åº”æ˜¯å¦æˆåŠŸ</span><br><span class="line">      var data = JSON.parse(xmlHttp.responseText);</span><br><span class="line">      callback(data);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">      throw  xmlHttp.responseText</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="åŒæºç­–ç•¥"><a href="#åŒæºç­–ç•¥" class="headerlink" title="åŒæºç­–ç•¥"></a>åŒæºç­–ç•¥</h1><p>ä¸ºäº†ä¿è¯ç”¨æˆ·ä¿¡æ¯çš„å®‰å…¨ï¼Œé˜²æ­¢æ¶æ„çš„ç½‘ç«™çªƒå–æ•°æ®<br>è§£å†³åŠæ³•ï¼šåŒæºç­–ç•¥<br>åŒæºç­–ç•¥æ˜¯æŒ‡ä¸‰ä¸ªç›¸åŒï¼šåè®®ç›¸åŒ,åŸŸåç›¸åŒ,ç«¯å£ç›¸åŒ<br>ä»¥ä¸Šä¸‰ä¸ªä¸ç›¸åŒåˆ™æ˜¯éåŒæºï¼ŒéåŒæºä¹‹é—´ç›¸äº’è®¿é—®å³è·¨åŸŸè®¿é—®</p>
<p>è·¨åŸŸå’Œipæ²¡æœ‰å…³ç³»</p>
<h1 id="è·¨åŸŸ"><a href="#è·¨åŸŸ" class="headerlink" title="è·¨åŸŸ"></a>è·¨åŸŸ</h1><p>æµè§ˆå™¨åœ¨é˜»æ­¢è·¨åŸŸ,é˜»æ­¢æ–¹å¼å¯èƒ½æ˜¯åœ¨ä¸€å¼€å§‹å°±é™åˆ¶äº†å‘èµ·è·¨ç«™çš„è¯·æ±‚ï¼Œä¹Ÿå¯èƒ½æ˜¯è·¨ç«™è¯·æ±‚å¯ä»¥æ­£å¸¸å‘èµ·ï¼Œä½†è¿”å›ç»“æœè¢«æµè§ˆå™¨æ‹¦æˆªäº†</p>
<h2 id="ä¸ºä»€ä¹ˆè¦é˜²æ­¢è·¨åŸŸ"><a href="#ä¸ºä»€ä¹ˆè¦é˜²æ­¢è·¨åŸŸ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦é˜²æ­¢è·¨åŸŸ"></a>ä¸ºä»€ä¹ˆè¦é˜²æ­¢è·¨åŸŸ</h2><p>è·¨åŸŸè®¿é—®æ—¶ä¼šå—åˆ°åŒæºç­–ç•¥çš„ä¸‰ä¸ªé™åˆ¶<br>1ã€Cookieã€LocalStorage å’Œ IndexDB æ— æ³•è¯»å–ã€‚<br>é€šè¿‡æµè§ˆå™¨document.cookieæˆ‘ä»¬å¯ä»¥è·å–ç”¨æˆ·ç™»å½•æ€,å¦‚æœcookieå¯ä»¥è¯»å–çš„è¯ï¼Œ<br>å°±ä¼šå‡ºç°åœ¨Aå…¬å¸ç½‘ç«™é‡Œå¯ä»¥å»Bå…¬å¸ç½‘ç«™è·å–ç™»å½•ä¿¡æ¯çš„äº‹æƒ…,è¿™æ ·å°±å®¹æ˜“å°†ç”¨æˆ·ä¿¡æ¯æ³„éœ²<br>2ã€DOM æ— æ³•è·å¾—<br>å¦‚æœDOMå¯ä»¥è·å¾—,ç°åœ¨æˆ‘æ˜¯ä¸€ä¸ªå‡ç½‘ç«™ï¼Œåˆ©ç”¨iframeå¥—åµŒä¸€ä¸ªç›®å‰çº¿ä¸Šè¿è¥çš„ç”µå•†ç½‘ç«™,é‚£ä¹ˆ<br>æ¶ˆè´¹è€…åœ¨è¾“å…¥æ”¯ä»˜å¯†ç æ—¶,é‚£æˆ‘å°±å¯ä»¥è·å–inputçš„å€¼,ä»è€Œè·å–ç”¨æˆ·æ”¯ä»˜å¯†ç <br>3ã€AJAX è¯·æ±‚ä¸èƒ½å‘é€<br>å¦‚æœAJAxå¯ä»¥å‘é€çš„è¯ï¼Œé‚£æˆ‘ä»¬å°±èƒ½å°†å†…ç½‘ä¸œè¥¿ä¸‹è½½ä¸‹æ¥å‘é€åˆ°å¤–ç½‘æœåŠ¡å™¨ï¼Œä»è€Œé€ æˆå†…ç½‘ä¿¡æ¯æ³„éœ²</p>
<h2 id="å¦‚ä½•å®ç°è·¨åŸŸ"><a href="#å¦‚ä½•å®ç°è·¨åŸŸ" class="headerlink" title="å¦‚ä½•å®ç°è·¨åŸŸ"></a>å¦‚ä½•å®ç°è·¨åŸŸ</h2><h3 id="jsonp"><a href="#jsonp" class="headerlink" title="jsonp"></a>jsonp</h3><p>åŸç†æ˜¯åˆ©ç”¨&lt;script&gt;æ ‡ç­¾å¯ä»¥åœ¨ä»»ä½•åŸŸä¸‹è·å–èµ„æºçš„åŸç†ï¼Œå°†è¦è·¨åŸŸè·å–çš„æ¥å£urlæ”¾åœ¨&lt;script&gt;æ ‡ç­¾çš„srcé‡Œé¢ï¼Œ<br>ç„¶åjså°†æ ‡ç­¾æ”¾åˆ°bodyé‡Œé¢ï¼Œå…¶ä¸­urlåŒ…å«ä¸€ä¸ªcallbackå‚æ•°ï¼Œç”¨äºæŒ‡å‘å¤„ç†responseçš„å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æˆ‘ä»¬æŒ‚è½½çš„windowä¸Š,<br>å³æˆ‘ä»¬åœ¨jsä¸­å®šä¹‰çš„çš„å‡½æ•°</p>
<p>å¦‚æœåœ¨æµè§ˆå™¨ç›´æ¥è®¿é—®æ¥å£â€™<a href="http://x.com:7001/json?callback=xxx&#39;" target="_blank" rel="noopener">http://x.com:7001/json?callback=xxx&#39;</a><br>é¡µé¢ä¼šæ˜¾ç¤º<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/**/ typeof xxx === &apos;function&apos; &amp;&amp; xxx(&#123;&quot;msg&quot;:&quot;hello world&quot;&#125;);</span><br></pre></td></tr></table></figure></p>
<p>å°±æ˜¯è¯´,åœ¨è¯·æ±‚è¿™ä¸ªæ¥å£æ—¶,ä¼šå»windowä¸Šæ‰¾xxxè¿™ä¸ªå¯¹è±¡ï¼Œçœ‹å®ƒæ˜¯ä¸æ˜¯å‡½æ•°ï¼Œå¦‚æœæ˜¯å‡½æ•°ï¼Œ<br>å°±å°†æ¥å£å®šä¹‰çš„responseï¼ˆ{â€œmsgâ€:â€hello worldâ€}ï¼‰ä½œä¸ºå‚æ•°ä¼ é€’ç»™xxxå‡½æ•°,å¹¶æ‰§è¡Œxxxå‡½æ•°</p>
<p>ç°åœ¨åœ¨<a href="http://y.com/x.htmlé¡µé¢ä¸­è¿›è¡Œè·¨åŸŸ" target="_blank" rel="noopener">http://y.com/x.htmlé¡µé¢ä¸­è¿›è¡Œè·¨åŸŸ</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">//json æ¥å£  æœåŠ¡ç«¯</span><br><span class="line"></span><br><span class="line">module.exports = app =&gt; &#123;</span><br><span class="line">  class MsgController extends app.Controller &#123;</span><br><span class="line">    * index(req) &#123;</span><br><span class="line">      this.ctx.body = &#123; msg: &apos;hello world&apos; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return MsgController</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// js å®¢æˆ·ç«¯è¯·æ±‚</span><br><span class="line">//æ–¹æ³•ä¸€ï¼š</span><br><span class="line"></span><br><span class="line">//å®šä¹‰ç›¸åº”å¤„ç†å‡½æ•°</span><br><span class="line">window.xxx = function (value) &#123;</span><br><span class="line">  console.log(value)</span><br><span class="line">&#125;</span><br><span class="line">//æ·»åŠ scriptæ ‡ç­¾</span><br><span class="line">var script = document.createElement(&apos;script&apos;)</span><br><span class="line">script.src = &apos;http://x.com:7001/json?callback=xxx&apos;</span><br><span class="line">document.body.appendChild(script)</span><br><span class="line"></span><br><span class="line">//æ–¹æ³•äºŒï¼š</span><br><span class="line">require([&apos;http://x.com:7001/json?callback=define&apos;], function (value) &#123;</span><br><span class="line">  console.log(value)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>ç°åœ¨è®¿é—®<a href="http://y.com/x.html,åœ¨æµè§ˆå™¨consoleå°±ä¼šæ‰“å°{&quot;msg&quot;:&quot;hello" target="_blank" rel="noopener">http://y.com/x.html,åœ¨æµè§ˆå™¨consoleå°±ä¼šæ‰“å°{&quot;msg&quot;:&quot;hello</a> worldâ€}</p>
<h3 id="CORS"><a href="#CORS" class="headerlink" title="CORS"></a>CORS</h3><p>XMLHttpRequest 2.0ä»¥åå¯ä»¥ä½¿ç”¨corsæ–¹æ³•è¿›è¡Œè·¨åŸŸ<br>CORSéœ€è¦æµè§ˆå™¨å’ŒæœåŠ¡å™¨åŒæ—¶æ”¯æŒ<br>æ•´ä¸ªCORSé€šä¿¡è¿‡ç¨‹ï¼Œéƒ½æ˜¯æµè§ˆå™¨è‡ªåŠ¨å®Œæˆï¼Œä¸éœ€è¦ç”¨æˆ·å‚ä¸ã€‚<br>å¯¹äºå¼€å‘è€…æ¥è¯´ï¼ŒCORSé€šä¿¡ä¸åŒæºçš„AJAXé€šä¿¡æ²¡æœ‰å·®åˆ«ï¼Œä»£ç å®Œå…¨ä¸€æ ·ã€‚<br>æµè§ˆå™¨ä¸€æ—¦å‘ç°AJAXè¯·æ±‚è·¨æºï¼Œå°±ä¼šè‡ªåŠ¨æ·»åŠ ä¸€äº›é™„åŠ çš„å¤´ä¿¡æ¯ï¼Œæœ‰æ—¶è¿˜ä¼šå¤šå‡ºä¸€æ¬¡é™„åŠ çš„è¯·æ±‚ï¼Œä½†ç”¨æˆ·ä¸ä¼šæœ‰æ„Ÿè§‰ã€‚<br>å®ç°CORSé€šä¿¡çš„å…³é”®æ˜¯æœåŠ¡å™¨ã€‚åªè¦æœåŠ¡å™¨å®ç°äº†CORSæ¥å£ï¼Œå°±å¯ä»¥è·¨æºé€šä¿¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">//corsæ¥å£ æœåŠ¡ç«¯</span><br><span class="line">module.exports = app =&gt; &#123;</span><br><span class="line">  class CrosController extends app.Controller &#123;</span><br><span class="line">    * index(req) &#123;</span><br><span class="line">      this.ctx.set(&apos;Access-Control-Allow-Origin&apos;, &apos;*&apos;)//å¦‚æœä¸æ·»åŠ åˆ™ä¼šç¦æ­¢è®¿é—®</span><br><span class="line">      // this.ctx.set(&apos;Access-Control-Allow-Origin&apos;, &apos;http://xx.com&apos;)</span><br><span class="line">      // å¦‚æœæˆ‘ä»¬è¦ http://*.qq.com éƒ½æ”¯æŒè·¨åŸŸæ€ä¹ˆåŠï¼Ÿ</span><br><span class="line">      this.ctx.body = &#123; msg: &apos;hello world&apos; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return CrosController</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//jsåº”ç”¨ å®¢æˆ·ç«¯</span><br><span class="line">var xhr = new XMLHttpRequest()</span><br><span class="line">xhr.onreadystatechange = function () &#123;</span><br><span class="line">  if (xhr.readyState === 4 &amp;&amp; xhr.status === 200) &#123;</span><br><span class="line">    console.log(JSON.parse(xhr.responseText).msg)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">xhr.withCredentials = true//åœ¨å¤´éƒ¨æ·»åŠ cookieå¸¦åˆ°y.stuq,å¦‚æœä¸è®¾ç½®ï¼Œåˆ™ä¸å¸¦</span><br><span class="line">xhr.open(&apos;GET&apos;, &apos;http://x.com:7001/cros&apos;)</span><br><span class="line">xhr.send(null)</span><br></pre></td></tr></table></figure>
<p><a href="http://www.ruanyifeng.com/blog/2016/04/cors.html" target="_blank" rel="noopener">è·¨åŸŸèµ„æºå…±äº« CORS è¯¦è§£</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS" target="_blank" rel="noopener">HTTPè®¿é—®æ§åˆ¶ï¼ˆCORSï¼‰</a></p>
<p>Access-Control-Allow-Origin çš„å±æ€§å€¼åªå…è®¸è®¾ç½®ä¸ºå•ä¸ªç¡®å®šåŸŸåå­—ç¬¦ä¸²æˆ–è€… (<em>),è®¾ç½®</em>çš„è¯ï¼Œæœ€ä¸å®‰å…¨ï¼Œå…è®¸æ‰€æœ‰åŸŸå¯ä»¥è®¿é—®</p>
<p>åœ¨æœåŠ¡å™¨ç«¯è®¾ç½®CORSè·¨åŸŸè¯·æ±‚ä¸­çš„å¤šåŸŸåç™½åå•ï¼Œå¯ä»¥å®ç°Access-Control-Allow-Origin å…è®¸å¯¹æŸä¸€ä¸ªæˆ–å‡ ä¸ªç½‘ç«™å¼€æ”¾è·¨åŸŸè¯·æ±‚æƒé™</p>
<p>åŸç†å°±æ˜¯åœ¨æœåŠ¡å™¨ç«¯åˆ¤æ–­è¯·æ±‚çš„Headerä¸­Originå±æ€§å€¼ï¼ˆreq.header.originï¼‰æ˜¯å¦åœ¨æˆ‘ä»¬çš„åŸŸåç™½åå•åˆ—è¡¨å†…ã€‚<br>å¦‚æœåœ¨ç™½åå•åˆ—è¡¨å†…ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æŠŠ Access-Control-Allow-Origin è®¾ç½®æˆå½“å‰çš„Originå€¼ï¼Œè¿™æ ·å°±æ»¡è¶³äº†Access-Control-Allow-Origin çš„å•ä¸€åŸŸåè¦æ±‚ï¼Œä¹Ÿèƒ½ç¡®ä¿å½“å‰è¯·æ±‚é€šè¿‡è®¿é—®ï¼›å¦‚æœä¸åœ¨ç™½åå•åˆ—è¡¨å†…ï¼Œåˆ™è¿”å›é”™è¯¯ä¿¡æ¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">// åˆ¤æ–­originæ˜¯å¦åœ¨åŸŸåç™½åå•åˆ—è¡¨ä¸­</span><br><span class="line">function isOriginAllowed(origin, allowedOrigin) &#123;</span><br><span class="line">    if (_.isArray(allowedOrigin)) &#123;</span><br><span class="line">        for(let i = 0; i &lt; allowedOrigin.length; i++) &#123;</span><br><span class="line">            if(isOriginAllowed(origin, allowedOrigin[i])) &#123;</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125; else if (_.isString(allowedOrigin)) &#123;</span><br><span class="line">        return origin === allowedOrigin;</span><br><span class="line">    &#125; else if (allowedOrigin instanceof RegExp) &#123;</span><br><span class="line">        return allowedOrigin.test(origin);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        return !!allowedOrigin;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">const ALLOW_ORIGIN = [  // åŸŸåç™½åå•</span><br><span class="line">    &apos;*.233.666.com&apos;,</span><br><span class="line">    &apos;hello.world.com&apos;,</span><br><span class="line">    &apos;hello..*.com&apos;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">app.post(&apos;a/b&apos;, function (req, res, next) &#123;</span><br><span class="line">    let reqOrigin = req.headers.origin;  // requestå“åº”å¤´çš„originå±æ€§</span><br><span class="line"></span><br><span class="line">    // åˆ¤æ–­è¯·æ±‚æ˜¯å¦åœ¨åŸŸåç™½åå•å†…</span><br><span class="line">    if(isOriginAllowed(reqOrigin, ALLOW_ORIGIN)) &#123;</span><br><span class="line">        // è®¾ç½®CORSä¸ºè¯·æ±‚çš„Originå€¼</span><br><span class="line">        res.header(&quot;Access-Control-Allow-Origin&quot;, reqOrigin);</span><br><span class="line">        res.header(&apos;Access-Control-Allow-Credentials&apos;, &apos;true&apos;);</span><br><span class="line"></span><br><span class="line">        // ä¸šåŠ¡ä»£ç é€»è¾‘ä»£ç  ...</span><br><span class="line">        // ...</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        res.send(&#123; code: -2, msg: &apos;éæ³•è¯·æ±‚&apos; &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>ä¸JSONPçš„æ¯”è¾ƒ:<br>CORSä¸JSONPçš„ä½¿ç”¨ç›®çš„ç›¸åŒï¼Œä½†æ˜¯æ¯”JSONPæ›´å¼ºå¤§ã€‚<br>JSONPåªæ”¯æŒGETè¯·æ±‚ï¼ŒCORSæ”¯æŒæ‰€æœ‰ç±»å‹çš„HTTPè¯·æ±‚ã€‚JSONPçš„ä¼˜åŠ¿åœ¨äºæ”¯æŒè€å¼æµè§ˆå™¨ï¼Œä»¥åŠå¯ä»¥å‘ä¸æ”¯æŒCORSçš„ç½‘ç«™è¯·æ±‚æ•°æ®ã€‚</p>
<h3 id="iframe-Hash"><a href="#iframe-Hash" class="headerlink" title="iframe-Hash"></a>iframe-Hash</h3><p>Location å¯¹è±¡æ˜¯ Window å¯¹è±¡çš„ä¸€ä¸ªéƒ¨åˆ†ï¼Œå¯é€šè¿‡ window.location å±æ€§æ¥è®¿é—®<br>hashæ˜¯locationå¯¹è±¡çš„çš„ä¸€ä¸ªå±æ€§ï¼Œå¯ä»¥è®¾ç½®æˆ–è¿”å›ä»äº•å· (#) å¼€å§‹çš„ URLï¼ˆé”šï¼‰</p>
<p>iframeæ˜¯HTMLæ ‡ç­¾ï¼Œä½œç”¨æ˜¯æ–‡æ¡£ä¸­çš„æ–‡æ¡£ï¼Œæˆ–è€…æµ®åŠ¨çš„æ¡†æ¶(FRAME)ã€‚iframeå…ƒç´ ä¼šåˆ›å»ºåŒ…å«å¦å¤–ä¸€ä¸ªæ–‡æ¡£çš„å†…è”æ¡†æ¶ï¼ˆå³è¡Œå†…æ¡†æ¶ï¼‰ã€‚</p>
<p>åŸç†æ˜¯åœ¨åŸåŸŸé¡µé¢åŒ…è£… è·¨åŸŸsrcçš„iframeæ ‡ç­¾ï¼Œåœ¨è·¨åŸŸsrcçš„æ–‡ä»¶é‡Œè¯·æ±‚è·¨åŸŸçš„èµ„æº(æ­¤æ—¶äºŒè€…åŒåŸŸ),<br>è·¨åŸŸsrcæ–‡ä»¶æ˜¯å¯ä»¥è·å–åˆ°iframeçˆ¶ç±»,å³æˆ‘ä»¬åŸåŸŸçš„windowå¯¹è±¡,<br>é€šè¿‡æ”¹å˜åŸåŸŸçš„hashå€¼ï¼Œå¼•å‘åŸåŸŸonhashchange,ä»è€Œå°†èµ„æºå¸¦å›åˆ°åŸåŸŸ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">//åŸåŸŸjs</span><br><span class="line">//åŒ…è£…iframe</span><br><span class="line">var iframe = document.createElement(&apos;iframe&apos;)</span><br><span class="line">iframe.src = &apos;http://x.com:7001/public/hash.html&apos;</span><br><span class="line">document.body.appendChild(iframe)</span><br><span class="line">//å¤„ç†è¯·æ±‚èµ„æº</span><br><span class="line">window.onhashchange = function () &#123;</span><br><span class="line">  // å°ç»ƒä¹ ï¼Œåšä¸ªå·¥å…·æ–¹æ³•ï¼Œå–å‡ºqueryçš„å€¼</span><br><span class="line">  console.log(location.hash)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//è·¨åŸŸçš„hash.htmlæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">var xhr = new XMLHttpRequest()</span><br><span class="line">xhr.onreadystatechange = function () &#123;</span><br><span class="line">    if (xhr.readyState === 4 &amp;&amp; xhr.status === 200) &#123;</span><br><span class="line">        var res = JSON.parse(xhr.responseText)</span><br><span class="line">        parent.location.href = `http://y.stuq.com:7001/public/3.html#msg=$&#123;res.msg&#125;` //å¼•èµ·åŸåŸŸonhashchangeï¼ŒåŒæ—¶å°†responseå¸¦å›</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">xhr.open(&apos;GET&apos;, &apos;http://x.com:7001/json&apos;, true) //è¯·æ±‚åŒåŸŸèµ„æº</span><br><span class="line">xhr.send(null)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h3 id="iframe-window-name"><a href="#iframe-window-name" class="headerlink" title="iframe-window.name"></a>iframe-window.name</h3><p>åŸç†æ˜¯åˆ©ç”¨iframeçš„window.name,name å€¼åœ¨ä¸åŒçš„é¡µé¢ï¼ˆç”šè‡³ä¸åŒåŸŸåï¼‰åŠ è½½åä¾æ—§å­˜åœ¨ï¼ˆå¦‚æœæ²¡ä¿®æ”¹åˆ™å€¼ä¸ä¼šå˜åŒ–ï¼‰ï¼Œå¹¶ä¸”å¯ä»¥æ”¯æŒéå¸¸é•¿çš„ name å€¼ï¼ˆ2MBï¼‰</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">//åŸåŸŸjs</span><br><span class="line">var iframe = document.createElement(&apos;iframe&apos;)</span><br><span class="line">iframe.src = &apos;http://x.com:7001/public/name.html&apos;</span><br><span class="line">document.body.appendChild(iframe)</span><br><span class="line"></span><br><span class="line">var times = 0</span><br><span class="line">iframe.onload = function () &#123;</span><br><span class="line">    if (++times === 2) &#123;//ç¬¬ä¸€æ¬¡æ‰“å¼€è·¨åŸŸé¡µé¢name,ç¬¬äºŒæ¬¡åŠ è½½é€šçŸ¥åŸåŸŸiframeæ”¹å˜å€¼</span><br><span class="line">        console.log(JSON.parse(iframe.contentWindow.name))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//name.html</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">var xhr = new XMLHttpRequest()</span><br><span class="line">xhr.onreadystatechange = function () &#123;</span><br><span class="line">    if (xhr.readyState === 4 &amp;&amp; xhr.status === 200) &#123;</span><br><span class="line">        window.name = xhr.responseText //è¿™é‡Œæ˜¯åŸåŸŸiframeçš„window,iframeä¸èƒ½è·¨åŸŸè¯»å–å¯¹è±¡,æ‰€ä»¥</span><br><span class="line">        location.href = &apos;http://y.com:7001/public/index.html&apos; //å†æ¬¡åŠ è½½iframeï¼Œé€šçŸ¥åŸåŸŸparentï¼Œiframeçš„contentWindow.nameéœ€è¦åšæ›´æ”¹</span><br><span class="line">        //hrefçš„å€¼,ä¾ç„¶æ˜¯è·¨åŸŸçš„ä¹Ÿå¯ä»¥ï¼Œè¿™é‡Œæ˜¯åŠ è½½å›åŸåŸŸçš„ä¸€ä¸ªæ–‡ä»¶</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">xhr.open(&apos;GET&apos;, &apos;http://x.com:7001/json&apos;, true)</span><br><span class="line">xhr.send(null)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h3 id="iframe-postMessage"><a href="#iframe-postMessage" class="headerlink" title="iframe-postMessage"></a>iframe-postMessage</h3><p>åˆ©ç”¨HTML5çš„postMessageæ–¹æ³•<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">//åŸåŸŸjs</span><br><span class="line">var iframe = document.createElement(&apos;iframe&apos;)</span><br><span class="line">iframe.src = &apos;http://x.stuq.com:7001/public/post.html&apos;</span><br><span class="line">document.body.appendChild(iframe)</span><br><span class="line"></span><br><span class="line">window.addEventListener(&apos;message&apos;, function(e) &#123;</span><br><span class="line">  console.log(JSON.parse(e.data))</span><br><span class="line">&#125;, false);</span><br><span class="line"></span><br><span class="line">//post.html</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">var xhr = new XMLHttpRequest()</span><br><span class="line">xhr.onreadystatechange = function () &#123;</span><br><span class="line">    if (xhr.readyState === 4 &amp;&amp; xhr.status === 200) &#123;</span><br><span class="line">        parent.postMessage(xhr.responseText, &apos;*&apos;) //æ‹¿åˆ°çˆ¶çº§é¡µé¢parent,æ‰§è¡Œpostmessageçš„ä¸€ä¸ªæ“ä½œï¼Œä»è€Œå¼•å‘çˆ¶çº§é¡µé¢çš„messageäº‹ä»¶</span><br><span class="line">        //*ä»£è¡¨targetOriginå¯ä»¥æ˜¯ä»»ä½•åŸŸ</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">xhr.open(&apos;GET&apos;, &apos;http://x.stuq.com:7001/json&apos;, true)</span><br><span class="line">xhr.send(null)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage" target="_blank" rel="noopener">Window.postMessage() API</a></p>
<h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>è·¨åŸŸæ–¹æ³•å¾ˆå¤š<br>é€‰æ‹©å¦‚ä½•ä½¿ç”¨å¯ä»¥è€ƒè™‘ä»¥ä¸‹å‡ æ–¹é¢<br>1.åœºæ™¯ï¼Œé€‰æ‹©ç®€å•çš„<br>2.å®‰å…¨ï¼Œè§£å†³é—®é¢˜æ˜¯å¦è¶³å¤Ÿå®‰å…¨<br>3.æ•°æ®æ¥æº,å¦‚æœè·¨åŸŸæ¥å£å¯ä»¥ä¼ èµ„æºç»™åŸåŸŸï¼Œåˆ™å¯ä»¥ä½¿ç”¨iframeä»£ç†<br>4.æ‰¿æ¥ç¬¬ä¸‰ç§æƒ…æ™¯ï¼Œå¦‚æœæ¥å£ä¸å…è®¸ä¼ èµ„æºï¼Œåˆ™åªèƒ½å¯„å¸Œæœ›äºåå°ï¼Œä½¿ç”¨åå‘ä»£ç†çš„æ–¹æ³•è·å–</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/knowledge/Karmatest.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/knowledge/Karmatest.html" itemprop="url">
                  Karma test
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-12T23:54:02+08:00">
                2017-08-12
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Karma-test"><a href="#Karma-test" class="headerlink" title="Karma test"></a>Karma test</h1><p>Karmaæ˜¯ç”±Googleå›¢é˜Ÿå¼€å‘çš„ä¸€å¥—å‰ç«¯æµ‹è¯•è¿è¡Œæ¡†æ¶ã€‚å®ƒä¸åŒäºæµ‹è¯•æ¡†æ¶ï¼ˆä¾‹å¦‚jasmineï¼Œmochaç­‰ï¼‰ï¼Œè¿è¡Œåœ¨è¿™äº›æµ‹è¯•æ¡†æ¶ä¹‹ä¸Šã€‚ä¸»è¦å®Œæˆä»¥ä¸‹å·¥ä½œï¼š<br>Karmaå¯åŠ¨ä¸€ä¸ªwebæœåŠ¡å™¨ï¼Œç”ŸæˆåŒ…å«jsæºä»£ç å’Œjsæµ‹è¯•è„šæœ¬çš„é¡µé¢ï¼›<br>è¿è¡Œæµè§ˆå™¨åŠ è½½é¡µé¢ï¼Œå¹¶æ˜¾ç¤ºæµ‹è¯•çš„ç»“æœï¼›<br>å¦‚æœå¼€å¯æ£€æµ‹ï¼Œåˆ™å½“æ–‡ä»¶æœ‰ä¿®æ”¹æ—¶ï¼Œæ‰§è¡Œç»§ç»­æ‰§è¡Œä»¥ä¸Šè¿‡ç¨‹ã€‚</p>
<h1 id="æ­å»ºæµ‹è¯•ç¯å¢ƒ"><a href="#æ­å»ºæµ‹è¯•ç¯å¢ƒ" class="headerlink" title="æ­å»ºæµ‹è¯•ç¯å¢ƒ"></a>æ­å»ºæµ‹è¯•ç¯å¢ƒ</h1><p>npm install -g karma-cli //è®©å…¨å±€éƒ½å¯ä»¥è¿è¡Œkarmaçš„å‘½ä»¤è¡Œ,å‘½ä»¤è¡Œå·¥å…·<br>npm i karma â€“save-dev //åªåœ¨å½“å‰é¡¹ç›®ä¸­ä½¿ç”¨karma<br>npm install //å®‰è£…é¡¹ç›®çš„ä¾èµ– package.json<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&quot;devDependencies&quot;: &#123;</span><br><span class="line">    &quot;karma&quot;: &quot;^1.7.0&quot;,</span><br><span class="line">    &quot;karma-chrome-launcher&quot;: &quot;^2.2.0&quot;,</span><br><span class="line">    &quot;karma-mocha&quot;: &quot;^1.3.0&quot;,</span><br><span class="line">    &quot;mocha&quot;: &quot;^3.5.0&quot;,</span><br><span class="line">    &quot;should&quot;: &quot;^11.2.1&quot;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>karma init //åœ¨cmdä¸­è¿è¡Œè¯¥å‘½ä»¤,æ„å»ºkarma.conf.jsæ–‡ä»¶,è¿è¡Œåä¼šè¯¢é—®ç›¸å…³é—®é¢˜ç„¶åç”Ÿæˆkarma.conf.jsæ–‡ä»¶<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">Which testing framework <span class="keyword">do</span> you want to use ?</span><br><span class="line">Press tab to list possible options. Enter to move to the next question.</span><br><span class="line">&gt; mocha <span class="comment">//é€‰æ‹©è¦ä½¿ç”¨çš„æ¡†æ¶,ä¸èƒ½ç›´æ¥è¾“å…¥,æ˜¯é€‰æ‹©é¢˜,ç‚¹å‡»é”®ç›˜ç®­å¤´å¯æ›´æ”¹é€‰é¡¹</span></span><br><span class="line"></span><br><span class="line">Do you want to use Require.js ?</span><br><span class="line">This will add Require.js plugin.</span><br><span class="line">Press tab to list possible options. Enter to move to the next question.</span><br><span class="line">&gt; no  <span class="comment">//æ˜¯å¦add Require.js plugin</span></span><br><span class="line"></span><br><span class="line">Do you want to capture any browsers automatically ?</span><br><span class="line">Press tab to list possible options. Enter empty string to move to the next quest</span><br><span class="line">ion.</span><br><span class="line">&gt; Chrome <span class="comment">//é€‰æ‹©ç”¨å“ªä¸ªæµè§ˆå™¨æ‰“å¼€æµ‹è¯•é¡µï¼Œä¹Ÿæ˜¯é€‰æ‹©é¢˜ï¼Œä¸èƒ½è¾“å…¥</span></span><br><span class="line">&gt;</span><br><span class="line"></span><br><span class="line">What is the location <span class="keyword">of</span> your source and test files ?</span><br><span class="line">You can use glob patterns, eg. <span class="string">"js/*.js"</span> or <span class="string">"test/**/*Spec.js"</span>.</span><br><span class="line">Enter empty string to move to the next question.</span><br><span class="line">&gt; src<span class="comment">/*.js  //æ·»åŠ è¦æµ‹è¯•çš„ä»£ç çš„è·¯å¾„ï¼Œä¸æ˜¯æµ‹è¯•ç”¨ä¾‹ä»£ç çš„è·¯å¾„ï¼ŒåŒæ—¶ï¼Œä»£ç ä¸­ç”¨åˆ°çš„å…¶ä»–æ–‡ä»¶ä¹Ÿåœ¨è¿™é‡ŒåŒæ—¶æ·»åŠ ï¼Œ</span></span><br><span class="line"><span class="comment">11 08 2017 15:03:13.822:WARN [init]: There is no file matching this pattern.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&gt; //	å›è½¦å¯ä»¥åˆ‡æ¢ä¸‹ä¸€è¡Œç»§ç»­æ·»åŠ ï¼Œè¿ç»­å›è½¦è¿›å…¥ä¸‹ä¸€ä¸ªé—®é¢˜</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Should any of the files included by the previous patterns be excluded ?</span></span><br><span class="line"><span class="comment">You can use glob patterns, eg. "**/</span>*.swp<span class="string">".</span></span><br><span class="line"><span class="string">Enter empty string to move to the next question.</span></span><br><span class="line"><span class="string">&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Do you want Karma to watch all the files and run the tests on change ?</span></span><br><span class="line"><span class="string">Press tab to list possible options.</span></span><br><span class="line"><span class="string">&gt; yes //æ˜¯å¦è·Ÿæ‰€æœ‰æ–‡ä»¶è‡ªåŠ¨å¼€å¯æµ‹è¯•</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Config file generated at "</span>G:\css\homework1\karma.conf.js<span class="string">".</span></span><br></pre></td></tr></table></figure></p>
<p>karma.conf.jsæ–‡ä»¶<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">module.exports = function(config) &#123;</span><br><span class="line">  config.set(&#123;</span><br><span class="line"></span><br><span class="line">    // base path that will be used to resolve all patterns (eg. files, exclude)</span><br><span class="line">    basePath: &apos;&apos;,//æ ¹è·¯å¾„ï¼Œåé¢é…ç½®çš„åŸºæœ¬æ‰€æœ‰ç›¸å¯¹è·¯å¾„éƒ½ä¼šæ ¹æ®è¿™ä¸ªè·¯å¾„æ¥æ„é€ ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // frameworks to use ä½¿ç”¨åˆ°çš„æ¡†æ¶</span><br><span class="line">    // available frameworks: https://npmjs.org/browse/keyword/karma-adapter</span><br><span class="line">    frameworks: [&apos;mocha&apos;],</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // list of files / patterns to load in the browser  å°†ä¼šåœ¨æµè§ˆå™¨é‡Œé¢æ‰§è¡Œçš„ä»£ç </span><br><span class="line">    files: [</span><br><span class="line">      &apos;node_modules/should/should.js&apos;,</span><br><span class="line">      &apos;js/*.js&apos;,</span><br><span class="line">      &apos;quz/*.js&apos;,</span><br><span class="line">      &apos;test/*.js&apos;</span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // list of files to exclude éœ€è¦ä» files ä¸­æ’é™¤æ‰çš„æ–‡ä»¶</span><br><span class="line">    exclude: [</span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // preprocess matching files before serving them to the browseréœ€è¦åšé¢„å¤„ç†çš„æ–‡ä»¶ï¼Œä»¥åŠè¿™äº›æ–‡ä»¶å¯¹åº”çš„é¢„å¤„ç†å™¨ã€‚</span><br><span class="line">    // available preprocessors: https://npmjs.org/browse/keyword/karma-preprocessor</span><br><span class="line">    preprocessors: &#123;////æ­¤å¤„å°±å¯ä»¥å°† coffee ã€ ES6 ç­‰ä»£ç è½¬æ¢ä¸€ä¸‹ã€‚</span><br><span class="line">        &apos;js/*.js&apos;: [&apos;coverage&apos;],//æµ‹è¯•è¦†ç›–ç‡</span><br><span class="line">        &apos;quz/*.js&apos;: [&apos;coverage&apos;]//æµ‹è¯•è¦†ç›–ç‡</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // test results reporter to use æµ‹è¯•ç»“æœæŠ¥å‘Šå™¨</span><br><span class="line">    // possible values: &apos;dots&apos;, &apos;progress&apos;</span><br><span class="line">    // available reporters: https://npmjs.org/browse/keyword/karma-reporter</span><br><span class="line">    reporters: [&apos;progress&apos;, &apos;coverage&apos;],</span><br><span class="line"></span><br><span class="line">     // è¦†ç›–ç‡æŠ¥å‘Šå™¨é…ç½®</span><br><span class="line">    coverageReporter: &#123;</span><br><span class="line">      type : &apos;lcov&apos;, //htmlæ ¼å¼ä¼šç”Ÿæˆhtmlæ–‡ä»¶ï¼Œlcovæ ¼å¼å¯ä»¥å’Œcoverallsç»“åˆç”Ÿæˆcoverallså¾½ç« </span><br><span class="line">      dir : &apos;coverage/&apos;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    // web server port æœåŠ¡å™¨ç«¯å£å·</span><br><span class="line">    port: 9876,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // enable / disable colors in the output (reporters and logs)</span><br><span class="line">    colors: true,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // level of logging æ—¥å¿—çº§åˆ«</span><br><span class="line">    // possible values: config.LOG_DISABLE || config.LOG_ERROR || config.LOG_WARN || config.LOG_INFO || config.LOG_DEBUG</span><br><span class="line">    logLevel: config.LOG_INFO,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // enable / disable watching file and executing tests whenever any file changes å¯ç”¨/ç¦ç”¨ç›‘è§†æ–‡ä»¶å˜åŒ–é‡æ–°æ‰§è¡Œæµ‹è¯•çš„åŠŸèƒ½</span><br><span class="line">    autoWatch: true,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // start these browsers ä½¿ç”¨çš„æµè§ˆå™¨</span><br><span class="line">    // available browser launchers: https://npmjs.org/browse/keyword/karma-launcher</span><br><span class="line">    browsers: [&apos;Chrome&apos;],</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // Continuous Integration mode trueæµ‹è¯•ä¸€æ¬¡å°±ç»“æŸ,falseæµ‹è¯•å®Œä¸€ç›´å¤„äºæµ‹è¯•çŠ¶æ€</span><br><span class="line">    // if true, Karma captures browsers, runs the tests and exits</span><br><span class="line">    singleRun: true,</span><br><span class="line"></span><br><span class="line">    // Concurrency level</span><br><span class="line">    // how many browser should be started simultaneous</span><br><span class="line">    concurrency: Infinity</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="é›†æˆæµ‹è¯•Travis-CI"><a href="#é›†æˆæµ‹è¯•Travis-CI" class="headerlink" title="é›†æˆæµ‹è¯•Travis CI"></a>é›†æˆæµ‹è¯•Travis CI</h1><p><a href="/post/knowledge/TravishCI.html">Travish CIä½¿ç”¨</a><br>é€šè¿‡Travis CIæµ‹è¯•æˆ‘ä»¬å¯ä»¥è·å¾—ä¸€ä¸ªæµ‹è¯•é€šè¿‡çš„æ ‡å¿—<a href="https://travis-ci.org/YooHannah/homework1" target="_blank" rel="noopener"><img src="https://travis-ci.org/YooHannah/homework1.svg?branch=develop" alt="Build Status"></a>ï¼Œå¯ä»¥å°†å®ƒæ”¾åœ¨githubä»“åº“readme.mdæ–‡ä»¶é‡Œé¢<br><img src="/image/coverage1.png" alt="coverage1"><br>æ›´æ”¹é“¾æ¥ä¸­branchçš„å€¼å¯ä»¥è·å¾—å¯¹åº”åˆ†æ”¯çš„æµ‹è¯•ç»“æœ</p>
<h1 id="æµ‹è¯•ä»£ç è¦†ç›–ç‡-Coverage"><a href="#æµ‹è¯•ä»£ç è¦†ç›–ç‡-Coverage" class="headerlink" title="æµ‹è¯•ä»£ç è¦†ç›–ç‡ Coverage"></a>æµ‹è¯•ä»£ç è¦†ç›–ç‡ Coverage</h1><p>è¡¡é‡æµ‹è¯•è„šæœ¬çš„è´¨é‡â€“ä»£ç è¦†ç›–ç‡:æµ‹è¯•ä¸­è¿è¡Œåˆ°çš„ä»£ç å æ‰€æœ‰ä»£ç çš„æ¯”ç‡</p>
<p>å®‰è£…æµ‹è¯•è¦†ç›–ç‡å·¥å…·<br>npm i â€“save-dev karma-coverage</p>
<p>ä¿®æ”¹é…ç½®æ–‡ä»¶karma.conf.js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// modified</span><br><span class="line">preprocessors: &#123;</span><br><span class="line">    &apos;src/**/*.js&apos;: [&apos;coverage&apos;], //è¦æµ‹è¯•çš„åŠŸèƒ½ä»£ç è·¯å¾„ï¼š[&apos;coverage&apos;]   å¤šä¸ªæ–‡ä»¶å¤¹å°±é€—å·éš”å¼€ï¼ŒæŒ‰æ ¼å¼å†™ä¸‹å»</span><br><span class="line">    &apos;js/*.js&apos;: [&apos;coverage&apos;],</span><br><span class="line">    &apos;quz/*.js&apos;: [&apos;coverage&apos;]</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">//modified</span><br><span class="line">reporters: [&apos;progress&apos;, &apos;coverage&apos;],</span><br><span class="line"></span><br><span class="line">// add</span><br><span class="line">coverageReporter: &#123;</span><br><span class="line">  type : &apos;html&apos;,</span><br><span class="line">  dir : &apos;coverage/&apos;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p>
<p>è¿è¡Œkarma start,ä¼šæ–°å¢coverageæ–‡ä»¶å¤¹,é‡Œé¢åªæœ‰ä¸€ä¸ªæµè§ˆå™¨åçš„æ–‡ä»¶å¤¹ï¼Œé‡Œé¢æ˜¯æ ¹æ®preprocessorsæ·»åŠ çš„è·¯å¾„ç”Ÿæˆå¯¹åº”çš„æ–‡ä»¶å¤¹å’Œå…¶ä»–æ–‡ä»¶ï¼Œ<br>å…¶ä»–æ–‡ä»¶é‡Œé¢æœ‰index.htmlæ–‡ä»¶ï¼Œæ˜¯æ•´ä¸ªæµ‹è¯•çš„æµ‹è¯•æŠ¥å‘Šï¼Œæ–‡ä»¶å¤¹é‡Œæ˜¯æ¯ä¸ªæ–‡ä»¶çš„è¦†ç›–æµ‹è¯•ç»“æœå’Œä»£ç å…·ä½“çš„è¦†ç›–æƒ…å†µ</p>
<p>æ³¨æ„ï¼šå¦‚æœä¸æƒ³å°†æµ‹è¯•ç»“æœä¸Šä¼ github,è®°å¾—æ›´æ”¹.gitignoreæ–‡ä»¶ï¼Œå°†coverageæ–‡ä»¶å¤¹å¿½ç•¥æ‰</p>
<h1 id="è·å–è¦†ç›–ç‡æ ‡å¿—"><a href="#è·å–è¦†ç›–ç‡æ ‡å¿—" class="headerlink" title="è·å–è¦†ç›–ç‡æ ‡å¿—"></a>è·å–è¦†ç›–ç‡æ ‡å¿—</h1><p>github ä»“åº“ç»å¸¸ä¼šçœ‹åˆ°è¿™ä¸ªæ ‡å¿—<br><img src="/image/coverage2.png" alt="coverage2"><br>å°±æ˜¯è¯´é¡¹ç›®çš„æµ‹è¯•è¦†ç›–ç‡æ˜¯91%ï¼Œè¦è·å–è¿™ä¸ªæ ‡å¿—æˆ‘ä»¬éœ€è¦å°†æµ‹è¯•è¦†ç›–ç‡æ”¾åˆ°<a href="https://coveralls.io" target="_blank" rel="noopener">Coveralls</a>ä¸Š</p>
<p>å®‰è£… coverallsæ–¹ä¾¿æˆ‘ä»¬åœ¨Travis CIä¸Šæµ‹è¯•å®Œä¹‹åå°†ç»“æœä¸Šä¼ <br>npm i coveralls â€“save-dev</p>
<p>æ›´æ”¹karma.conf.js<br>coverageReporter: {<br>  type : â€˜lcovâ€™, //å°†htmlæ”¹ä¸ºlcov<br>  dir : â€˜coverage/â€˜<br>},<br>æ¥ä¸‹æ¥æ“ä½œæ­¥éª¤å¯ä»¥æœ‰ä¸¤ç§<br>æ–¹æ³•ä¸€ï¼š<br>ä»…æ›´æ”¹ package.jsonæ–‡ä»¶,ä¸ä¿ç•™æµ‹è¯•å‘½ä»¤karma start<br>æ›´æ”¹package.jsonçš„scripts<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;test&quot;: &quot;./node_modules/karma/bin/karma start --browsers Firefox --single-run &amp;&amp; find coverage -name lcov.info -print0 | xargs -0 cat | ./node_modules/coveralls/bin/coveralls.js &amp;&amp; rm -rf ./coverage&quot;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>æ–¹æ³•äºŒï¼š<br>æ›´æ”¹package.jsonæ–‡ä»¶,ä¿ç•™æµ‹è¯•å‘½ä»¤karma start<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">		&quot;test&quot;: &quot;karma start&quot;,</span><br><span class="line">    &quot;report&quot;: &quot;find coverage -name lcov.info -print0 | xargs -0 cat | ./node_modules/coveralls/bin/coveralls.js &amp;&amp; rm -rf ./coverage&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ä¹Ÿè¦æ›´æ”¹.travis.ymlæ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹è¯­å¥<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">after_success:</span><br><span class="line">  - &quot;npm run report&quot;</span><br></pre></td></tr></table></figure></p>
<p>ç„¶åpushä»£ç ï¼Œç­‰Travi CI å®Œæˆæµ‹è¯•åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨<a href="https://coveralls.io" target="_blank" rel="noopener">Coveralls</a>ä¸Šè·å–æ ‡å¿—,<br>åœ¨æ€»çš„æµ‹è¯•ç»“æœé‚£ä¸ªé¡µé¢ä¸æ˜¯å…·ä½“æŸæ¬¡æäº¤çš„é¡µé¢è·å–<br><img src="/image/coverage3.png" alt="coverage3"><br>ç‚¹å‡»EMBEDå¯ä»¥è·å–ä¸åŒæ ¼å¼çš„æ ‡å¿—ä»£ç ï¼Œ<br>å¤åˆ¶ç²˜è´´MARKDOWN æ ¼å¼å¯ä»¥æ”¾åœ¨readme.mdæ–‡ä»¶ä¸­ç›´æ¥ä½¿ç”¨</p>
<p>ç›¸å…³é“¾æ¥ï¼š<br><a href="https://csbun.github.io/blog/2015/11/karma/" target="_blank" rel="noopener">ä½¿ç”¨ Karma åœ¨çœŸå®æµè§ˆå™¨ä¸Šæµ‹è¯•</a><br><a href="https://segmentfault.com/a/1190000006895064" target="_blank" rel="noopener">å‰ç«¯å•å…ƒæµ‹è¯•ä¹‹Karmaç¯å¢ƒæ­å»º</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/test/Karmatest.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/test/Karmatest.html" itemprop="url">
                  Karma test
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-12T23:54:02+08:00">
                2017-08-12
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Karma-test"><a href="#Karma-test" class="headerlink" title="Karma test"></a>Karma test</h1><p>Karmaæ˜¯ç”±Googleå›¢é˜Ÿå¼€å‘çš„ä¸€å¥—å‰ç«¯æµ‹è¯•è¿è¡Œæ¡†æ¶ã€‚å®ƒä¸åŒäºæµ‹è¯•æ¡†æ¶ï¼ˆä¾‹å¦‚jasmineï¼Œmochaç­‰ï¼‰ï¼Œè¿è¡Œåœ¨è¿™äº›æµ‹è¯•æ¡†æ¶ä¹‹ä¸Šã€‚ä¸»è¦å®Œæˆä»¥ä¸‹å·¥ä½œï¼š<br>Karmaå¯åŠ¨ä¸€ä¸ªwebæœåŠ¡å™¨ï¼Œç”ŸæˆåŒ…å«jsæºä»£ç å’Œjsæµ‹è¯•è„šæœ¬çš„é¡µé¢ï¼›<br>è¿è¡Œæµè§ˆå™¨åŠ è½½é¡µé¢ï¼Œå¹¶æ˜¾ç¤ºæµ‹è¯•çš„ç»“æœï¼›<br>å¦‚æœå¼€å¯æ£€æµ‹ï¼Œåˆ™å½“æ–‡ä»¶æœ‰ä¿®æ”¹æ—¶ï¼Œæ‰§è¡Œç»§ç»­æ‰§è¡Œä»¥ä¸Šè¿‡ç¨‹ã€‚</p>
<h1 id="æ­å»ºæµ‹è¯•ç¯å¢ƒ"><a href="#æ­å»ºæµ‹è¯•ç¯å¢ƒ" class="headerlink" title="æ­å»ºæµ‹è¯•ç¯å¢ƒ"></a>æ­å»ºæµ‹è¯•ç¯å¢ƒ</h1><p>npm install -g karma-cli //è®©å…¨å±€éƒ½å¯ä»¥è¿è¡Œkarmaçš„å‘½ä»¤è¡Œ,å‘½ä»¤è¡Œå·¥å…·<br>npm i karma â€“save-dev //åªåœ¨å½“å‰é¡¹ç›®ä¸­ä½¿ç”¨karma<br>npm install //å®‰è£…é¡¹ç›®çš„ä¾èµ– package.json<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&quot;devDependencies&quot;: &#123;</span><br><span class="line">    &quot;karma&quot;: &quot;^1.7.0&quot;,</span><br><span class="line">    &quot;karma-chrome-launcher&quot;: &quot;^2.2.0&quot;,</span><br><span class="line">    &quot;karma-mocha&quot;: &quot;^1.3.0&quot;,</span><br><span class="line">    &quot;mocha&quot;: &quot;^3.5.0&quot;,</span><br><span class="line">    &quot;should&quot;: &quot;^11.2.1&quot;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>karma init //åœ¨cmdä¸­è¿è¡Œè¯¥å‘½ä»¤,æ„å»ºkarma.conf.jsæ–‡ä»¶,è¿è¡Œåä¼šè¯¢é—®ç›¸å…³é—®é¢˜ç„¶åç”Ÿæˆkarma.conf.jsæ–‡ä»¶<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">Which testing framework <span class="keyword">do</span> you want to use ?</span><br><span class="line">Press tab to list possible options. Enter to move to the next question.</span><br><span class="line">&gt; mocha <span class="comment">//é€‰æ‹©è¦ä½¿ç”¨çš„æ¡†æ¶,ä¸èƒ½ç›´æ¥è¾“å…¥,æ˜¯é€‰æ‹©é¢˜,ç‚¹å‡»é”®ç›˜ç®­å¤´å¯æ›´æ”¹é€‰é¡¹</span></span><br><span class="line"></span><br><span class="line">Do you want to use Require.js ?</span><br><span class="line">This will add Require.js plugin.</span><br><span class="line">Press tab to list possible options. Enter to move to the next question.</span><br><span class="line">&gt; no  <span class="comment">//æ˜¯å¦add Require.js plugin</span></span><br><span class="line"></span><br><span class="line">Do you want to capture any browsers automatically ?</span><br><span class="line">Press tab to list possible options. Enter empty string to move to the next quest</span><br><span class="line">ion.</span><br><span class="line">&gt; Chrome <span class="comment">//é€‰æ‹©ç”¨å“ªä¸ªæµè§ˆå™¨æ‰“å¼€æµ‹è¯•é¡µï¼Œä¹Ÿæ˜¯é€‰æ‹©é¢˜ï¼Œä¸èƒ½è¾“å…¥</span></span><br><span class="line">&gt;</span><br><span class="line"></span><br><span class="line">What is the location <span class="keyword">of</span> your source and test files ?</span><br><span class="line">You can use glob patterns, eg. <span class="string">"js/*.js"</span> or <span class="string">"test/**/*Spec.js"</span>.</span><br><span class="line">Enter empty string to move to the next question.</span><br><span class="line">&gt; src<span class="comment">/*.js  //æ·»åŠ è¦æµ‹è¯•çš„ä»£ç çš„è·¯å¾„ï¼Œä¸æ˜¯æµ‹è¯•ç”¨ä¾‹ä»£ç çš„è·¯å¾„ï¼ŒåŒæ—¶ï¼Œä»£ç ä¸­ç”¨åˆ°çš„å…¶ä»–æ–‡ä»¶ä¹Ÿåœ¨è¿™é‡ŒåŒæ—¶æ·»åŠ ï¼Œ</span></span><br><span class="line"><span class="comment">11 08 2017 15:03:13.822:WARN [init]: There is no file matching this pattern.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&gt; //	å›è½¦å¯ä»¥åˆ‡æ¢ä¸‹ä¸€è¡Œç»§ç»­æ·»åŠ ï¼Œè¿ç»­å›è½¦è¿›å…¥ä¸‹ä¸€ä¸ªé—®é¢˜</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Should any of the files included by the previous patterns be excluded ?</span></span><br><span class="line"><span class="comment">You can use glob patterns, eg. "**/</span>*.swp<span class="string">".</span></span><br><span class="line"><span class="string">Enter empty string to move to the next question.</span></span><br><span class="line"><span class="string">&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Do you want Karma to watch all the files and run the tests on change ?</span></span><br><span class="line"><span class="string">Press tab to list possible options.</span></span><br><span class="line"><span class="string">&gt; yes //æ˜¯å¦è·Ÿæ‰€æœ‰æ–‡ä»¶è‡ªåŠ¨å¼€å¯æµ‹è¯•</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Config file generated at "</span>G:\css\homework1\karma.conf.js<span class="string">".</span></span><br></pre></td></tr></table></figure></p>
<p>karma.conf.jsæ–‡ä»¶<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">module.exports = function(config) &#123;</span><br><span class="line">  config.set(&#123;</span><br><span class="line"></span><br><span class="line">    // base path that will be used to resolve all patterns (eg. files, exclude)</span><br><span class="line">    basePath: &apos;&apos;,//æ ¹è·¯å¾„ï¼Œåé¢é…ç½®çš„åŸºæœ¬æ‰€æœ‰ç›¸å¯¹è·¯å¾„éƒ½ä¼šæ ¹æ®è¿™ä¸ªè·¯å¾„æ¥æ„é€ ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // frameworks to use ä½¿ç”¨åˆ°çš„æ¡†æ¶</span><br><span class="line">    // available frameworks: https://npmjs.org/browse/keyword/karma-adapter</span><br><span class="line">    frameworks: [&apos;mocha&apos;],</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // list of files / patterns to load in the browser  å°†ä¼šåœ¨æµè§ˆå™¨é‡Œé¢æ‰§è¡Œçš„ä»£ç </span><br><span class="line">    files: [</span><br><span class="line">      &apos;node_modules/should/should.js&apos;,</span><br><span class="line">      &apos;js/*.js&apos;,</span><br><span class="line">      &apos;quz/*.js&apos;,</span><br><span class="line">      &apos;test/*.js&apos;</span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // list of files to exclude éœ€è¦ä» files ä¸­æ’é™¤æ‰çš„æ–‡ä»¶</span><br><span class="line">    exclude: [</span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // preprocess matching files before serving them to the browseréœ€è¦åšé¢„å¤„ç†çš„æ–‡ä»¶ï¼Œä»¥åŠè¿™äº›æ–‡ä»¶å¯¹åº”çš„é¢„å¤„ç†å™¨ã€‚</span><br><span class="line">    // available preprocessors: https://npmjs.org/browse/keyword/karma-preprocessor</span><br><span class="line">    preprocessors: &#123;////æ­¤å¤„å°±å¯ä»¥å°† coffee ã€ ES6 ç­‰ä»£ç è½¬æ¢ä¸€ä¸‹ã€‚</span><br><span class="line">        &apos;js/*.js&apos;: [&apos;coverage&apos;],//æµ‹è¯•è¦†ç›–ç‡</span><br><span class="line">        &apos;quz/*.js&apos;: [&apos;coverage&apos;]//æµ‹è¯•è¦†ç›–ç‡</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // test results reporter to use æµ‹è¯•ç»“æœæŠ¥å‘Šå™¨</span><br><span class="line">    // possible values: &apos;dots&apos;, &apos;progress&apos;</span><br><span class="line">    // available reporters: https://npmjs.org/browse/keyword/karma-reporter</span><br><span class="line">    reporters: [&apos;progress&apos;, &apos;coverage&apos;],</span><br><span class="line"></span><br><span class="line">     // è¦†ç›–ç‡æŠ¥å‘Šå™¨é…ç½®</span><br><span class="line">    coverageReporter: &#123;</span><br><span class="line">      type : &apos;lcov&apos;, //htmlæ ¼å¼ä¼šç”Ÿæˆhtmlæ–‡ä»¶ï¼Œlcovæ ¼å¼å¯ä»¥å’Œcoverallsç»“åˆç”Ÿæˆcoverallså¾½ç« </span><br><span class="line">      dir : &apos;coverage/&apos;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    // web server port æœåŠ¡å™¨ç«¯å£å·</span><br><span class="line">    port: 9876,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // enable / disable colors in the output (reporters and logs)</span><br><span class="line">    colors: true,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // level of logging æ—¥å¿—çº§åˆ«</span><br><span class="line">    // possible values: config.LOG_DISABLE || config.LOG_ERROR || config.LOG_WARN || config.LOG_INFO || config.LOG_DEBUG</span><br><span class="line">    logLevel: config.LOG_INFO,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // enable / disable watching file and executing tests whenever any file changes å¯ç”¨/ç¦ç”¨ç›‘è§†æ–‡ä»¶å˜åŒ–é‡æ–°æ‰§è¡Œæµ‹è¯•çš„åŠŸèƒ½</span><br><span class="line">    autoWatch: true,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // start these browsers ä½¿ç”¨çš„æµè§ˆå™¨</span><br><span class="line">    // available browser launchers: https://npmjs.org/browse/keyword/karma-launcher</span><br><span class="line">    browsers: [&apos;Chrome&apos;],</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // Continuous Integration mode trueæµ‹è¯•ä¸€æ¬¡å°±ç»“æŸ,falseæµ‹è¯•å®Œä¸€ç›´å¤„äºæµ‹è¯•çŠ¶æ€</span><br><span class="line">    // if true, Karma captures browsers, runs the tests and exits</span><br><span class="line">    singleRun: true,</span><br><span class="line"></span><br><span class="line">    // Concurrency level</span><br><span class="line">    // how many browser should be started simultaneous</span><br><span class="line">    concurrency: Infinity</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="é›†æˆæµ‹è¯•Travis-CI"><a href="#é›†æˆæµ‹è¯•Travis-CI" class="headerlink" title="é›†æˆæµ‹è¯•Travis CI"></a>é›†æˆæµ‹è¯•Travis CI</h1><p><a href="/post/knowledge/TravishCI.html">Travish CIä½¿ç”¨</a><br>é€šè¿‡Travis CIæµ‹è¯•æˆ‘ä»¬å¯ä»¥è·å¾—ä¸€ä¸ªæµ‹è¯•é€šè¿‡çš„æ ‡å¿—<a href="https://travis-ci.org/YooHannah/homework1" target="_blank" rel="noopener"><img src="https://travis-ci.org/YooHannah/homework1.svg?branch=develop" alt="Build Status"></a>ï¼Œå¯ä»¥å°†å®ƒæ”¾åœ¨githubä»“åº“readme.mdæ–‡ä»¶é‡Œé¢<br><img src="/image/coverage1.png" alt="coverage1"><br>æ›´æ”¹é“¾æ¥ä¸­branchçš„å€¼å¯ä»¥è·å¾—å¯¹åº”åˆ†æ”¯çš„æµ‹è¯•ç»“æœ</p>
<h1 id="æµ‹è¯•ä»£ç è¦†ç›–ç‡-Coverage"><a href="#æµ‹è¯•ä»£ç è¦†ç›–ç‡-Coverage" class="headerlink" title="æµ‹è¯•ä»£ç è¦†ç›–ç‡ Coverage"></a>æµ‹è¯•ä»£ç è¦†ç›–ç‡ Coverage</h1><p>è¡¡é‡æµ‹è¯•è„šæœ¬çš„è´¨é‡â€“ä»£ç è¦†ç›–ç‡:æµ‹è¯•ä¸­è¿è¡Œåˆ°çš„ä»£ç å æ‰€æœ‰ä»£ç çš„æ¯”ç‡</p>
<p>å®‰è£…æµ‹è¯•è¦†ç›–ç‡å·¥å…·<br>npm i â€“save-dev karma-coverage</p>
<p>ä¿®æ”¹é…ç½®æ–‡ä»¶karma.conf.js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// modified</span><br><span class="line">preprocessors: &#123;</span><br><span class="line">    &apos;src/**/*.js&apos;: [&apos;coverage&apos;], //è¦æµ‹è¯•çš„åŠŸèƒ½ä»£ç è·¯å¾„ï¼š[&apos;coverage&apos;]   å¤šä¸ªæ–‡ä»¶å¤¹å°±é€—å·éš”å¼€ï¼ŒæŒ‰æ ¼å¼å†™ä¸‹å»</span><br><span class="line">    &apos;js/*.js&apos;: [&apos;coverage&apos;],</span><br><span class="line">    &apos;quz/*.js&apos;: [&apos;coverage&apos;]</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">//modified</span><br><span class="line">reporters: [&apos;progress&apos;, &apos;coverage&apos;],</span><br><span class="line"></span><br><span class="line">// add</span><br><span class="line">coverageReporter: &#123;</span><br><span class="line">  type : &apos;html&apos;,</span><br><span class="line">  dir : &apos;coverage/&apos;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p>
<p>è¿è¡Œkarma start,ä¼šæ–°å¢coverageæ–‡ä»¶å¤¹,é‡Œé¢åªæœ‰ä¸€ä¸ªæµè§ˆå™¨åçš„æ–‡ä»¶å¤¹ï¼Œé‡Œé¢æ˜¯æ ¹æ®preprocessorsæ·»åŠ çš„è·¯å¾„ç”Ÿæˆå¯¹åº”çš„æ–‡ä»¶å¤¹å’Œå…¶ä»–æ–‡ä»¶ï¼Œ<br>å…¶ä»–æ–‡ä»¶é‡Œé¢æœ‰index.htmlæ–‡ä»¶ï¼Œæ˜¯æ•´ä¸ªæµ‹è¯•çš„æµ‹è¯•æŠ¥å‘Šï¼Œæ–‡ä»¶å¤¹é‡Œæ˜¯æ¯ä¸ªæ–‡ä»¶çš„è¦†ç›–æµ‹è¯•ç»“æœå’Œä»£ç å…·ä½“çš„è¦†ç›–æƒ…å†µ</p>
<p>æ³¨æ„ï¼šå¦‚æœä¸æƒ³å°†æµ‹è¯•ç»“æœä¸Šä¼ github,è®°å¾—æ›´æ”¹.gitignoreæ–‡ä»¶ï¼Œå°†coverageæ–‡ä»¶å¤¹å¿½ç•¥æ‰</p>
<h1 id="è·å–è¦†ç›–ç‡æ ‡å¿—"><a href="#è·å–è¦†ç›–ç‡æ ‡å¿—" class="headerlink" title="è·å–è¦†ç›–ç‡æ ‡å¿—"></a>è·å–è¦†ç›–ç‡æ ‡å¿—</h1><p>github ä»“åº“ç»å¸¸ä¼šçœ‹åˆ°è¿™ä¸ªæ ‡å¿—<br><img src="/image/coverage2.png" alt="coverage2"><br>å°±æ˜¯è¯´é¡¹ç›®çš„æµ‹è¯•è¦†ç›–ç‡æ˜¯91%ï¼Œè¦è·å–è¿™ä¸ªæ ‡å¿—æˆ‘ä»¬éœ€è¦å°†æµ‹è¯•è¦†ç›–ç‡æ”¾åˆ°<a href="https://coveralls.io" target="_blank" rel="noopener">Coveralls</a>ä¸Š</p>
<p>å®‰è£… coverallsæ–¹ä¾¿æˆ‘ä»¬åœ¨Travis CIä¸Šæµ‹è¯•å®Œä¹‹åå°†ç»“æœä¸Šä¼ <br>npm i coveralls â€“save-dev</p>
<p>æ›´æ”¹karma.conf.js<br>coverageReporter: {<br>  type : â€˜lcovâ€™, //å°†htmlæ”¹ä¸ºlcov<br>  dir : â€˜coverage/â€˜<br>},<br>æ¥ä¸‹æ¥æ“ä½œæ­¥éª¤å¯ä»¥æœ‰ä¸¤ç§<br>æ–¹æ³•ä¸€ï¼š<br>ä»…æ›´æ”¹ package.jsonæ–‡ä»¶,ä¸ä¿ç•™æµ‹è¯•å‘½ä»¤karma start<br>æ›´æ”¹package.jsonçš„scripts<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;test&quot;: &quot;./node_modules/karma/bin/karma start --browsers Firefox --single-run &amp;&amp; find coverage -name lcov.info -print0 | xargs -0 cat | ./node_modules/coveralls/bin/coveralls.js &amp;&amp; rm -rf ./coverage&quot;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>æ–¹æ³•äºŒï¼š<br>æ›´æ”¹package.jsonæ–‡ä»¶,ä¿ç•™æµ‹è¯•å‘½ä»¤karma start<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">		&quot;test&quot;: &quot;karma start&quot;,</span><br><span class="line">    &quot;report&quot;: &quot;find coverage -name lcov.info -print0 | xargs -0 cat | ./node_modules/coveralls/bin/coveralls.js &amp;&amp; rm -rf ./coverage&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ä¹Ÿè¦æ›´æ”¹.travis.ymlæ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹è¯­å¥<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">after_success:</span><br><span class="line">  - &quot;npm run report&quot;</span><br></pre></td></tr></table></figure></p>
<p>ç„¶åpushä»£ç ï¼Œç­‰Travi CI å®Œæˆæµ‹è¯•åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨<a href="https://coveralls.io" target="_blank" rel="noopener">Coveralls</a>ä¸Šè·å–æ ‡å¿—,<br>åœ¨æ€»çš„æµ‹è¯•ç»“æœé‚£ä¸ªé¡µé¢ä¸æ˜¯å…·ä½“æŸæ¬¡æäº¤çš„é¡µé¢è·å–<br><img src="/image/coverage3.png" alt="coverage3"><br>ç‚¹å‡»EMBEDå¯ä»¥è·å–ä¸åŒæ ¼å¼çš„æ ‡å¿—ä»£ç ï¼Œ<br>å¤åˆ¶ç²˜è´´MARKDOWN æ ¼å¼å¯ä»¥æ”¾åœ¨readme.mdæ–‡ä»¶ä¸­ç›´æ¥ä½¿ç”¨</p>
<p>ç›¸å…³é“¾æ¥ï¼š<br><a href="https://csbun.github.io/blog/2015/11/karma/" target="_blank" rel="noopener">ä½¿ç”¨ Karma åœ¨çœŸå®æµè§ˆå™¨ä¸Šæµ‹è¯•</a><br><a href="https://segmentfault.com/a/1190000006895064" target="_blank" rel="noopener">å‰ç«¯å•å…ƒæµ‹è¯•ä¹‹Karmaç¯å¢ƒæ­å»º</a><br><a href="https://imweb.io/topic/5833d14cf8a1d5546059a301" target="_blank" rel="noopener">å‰ç«¯è‡ªåŠ¨åŒ–æµ‹è¯•è§£å†³æ–¹æ¡ˆæ¢æ</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/test/assert.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/test/assert.html" itemprop="url">
                  æ–­è¨€è¯­å¥assert
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-12T23:54:02+08:00">
                2017-08-12
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>æµ‹è¯•ç”¨ä¾‹é‡Œé¢çš„ä¸€ç§åˆ¤æ–­è¯­å¥</p>
<p>åœ¨mochaä¸­éœ€è¦require<br>var assert = require(â€˜assertâ€™)</p>
<p>å‚æ•°ä¸€èˆ¬æœ‰ä¸‰ä¸ª<br>value å¾…åˆ¤æ–­çš„å€¼<br>expected è¦å’Œvalueè¿›è¡Œæ¯”è¾ƒçš„å€¼ï¼Œçœ‹äºŒè€…æ˜¯å¦ç›¸ç­‰æˆ–è€…ä¸ç›¸ç­‰,å¦‚æœæ²¡æœ‰expectedï¼Œåˆ™æ˜¯åœ¨åˆ¤æ–­valueçš„å€¼æ˜¯å¦ä¸ºçœŸ<br>message åˆ¤æ–­ç»“æœä¸ºé”™è¯¯æ—¶,æŠ›å‡ºæ¥çš„é”™è¯¯æé†’è¯­å¥ï¼Œå¦‚æœ message å‚æ•°ä¸º undefinedï¼Œåˆ™èµ‹äºˆé»˜è®¤çš„é”™è¯¯ä¿¡æ¯ã€‚</p>
<p>assert(value[, message]) åŒassert.ok()<br>assert.ok(value[, message]) valueå¦‚æœä¸ä¸ºçœŸå€¼,æŠ›å‡ºä¸€ä¸ªå¸¦æœ‰ message å±æ€§çš„ AssertionError</p>
<p>assert.fail(message) æŠ›å‡ºé”™è¯¯ä¿¡æ¯message</p>
<p>assert.fail(actual, expected, message, operator) æ ¹æ®å‚æ•°æŠ›å‡ºç›¸åº”é”™è¯¯ä¿¡æ¯<br>å¦‚æœ message ä¸å­˜åœ¨ï¼Œåˆ™é”™è¯¯ä¿¡æ¯ä¼šè¢«è®¾ä¸º actual çš„å€¼åŠ åˆ†éš”ç¬¦ operator å†åŠ  expected çš„å€¼ã€‚ å¦åˆ™ï¼Œé”™è¯¯ä¿¡æ¯ä¸º message çš„å€¼,operatoræ²¡æœ‰çš„è¯ï¼Œé»˜è®¤ä¸º!=</p>
<p>assert.ifError(value) å¦‚æœ value ä¸ºçœŸï¼Œåˆ™æŠ›å‡º value,å¦‚æœä¸ºå‡ï¼Œåˆ™æµ‹è¯•é€šè¿‡</p>
<p>assert.equal(actual, expected[, message])      ä½¿ç”¨ç›¸ç­‰è¿ç®—ç¬¦ï¼ˆ==ï¼‰æµ‹è¯• actual å‚æ•°ä¸ expected å‚æ•°æ˜¯å¦ç›¸ç­‰ã€‚<br>assert.deepEqual(actual, expected[, message])  æµ‹è¯• actual å‚æ•°ä¸ expected å‚æ•°æ˜¯å¦æ·±åº¦ç›¸ç­‰ã€‚ åŸå§‹å€¼ä½¿ç”¨ ç›¸ç­‰è¿ç®—ç¬¦ï¼ˆ==ï¼‰æ¯”è¾ƒï¼Œåªæ¯”è¾ƒå¯æšä¸¾çš„è‡ªèº«å±æ€§ã€‚<br>æ·±åº¦ç›¸ç­‰æ„å‘³ç€å­å¯¹è±¡çš„å¯æšä¸¾çš„è‡ªèº«å±æ€§ä¹Ÿä¼šè¢«æ¯”è¾ƒ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">const obj1 = &#123;</span><br><span class="line">  a: &#123;</span><br><span class="line">    b: 1</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">const obj3 = &#123;</span><br><span class="line">  a: &#123;</span><br><span class="line">    b: 1</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">const obj4 = Object.create(obj1);</span><br><span class="line">assert.deepEqual(obj1, obj4);</span><br><span class="line">// æŠ›å‡º AssertionError: &#123; a: &#123; b: 1 &#125; &#125; deepEqual &#123;&#125;</span><br><span class="line">// åŸå‹ä¼šè¢«å¿½ç•¥</span><br><span class="line">assert.deepEqual(obj1, obj3);</span><br><span class="line">// é€šè¿‡ï¼Œä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰</span><br></pre></td></tr></table></figure></p>
<p>assert.deepStrictEqual(actual, expected[, message])<br>å¤§å¤šæ•°æƒ…å†µä¸‹ä¸ assert.deepEqual() ä¸€æ ·ï¼Œä½†æœ‰ä¸‰ä¸ªä¾‹å¤–ï¼š</p>
<p>åŸå§‹å€¼ä½¿ç”¨ å…¨ç­‰è¿ç®—ç¬¦ï¼ˆ===ï¼‰æ¯”è¾ƒã€‚ä½¿ç”¨SameValueZeroæ¯”è¾ƒæ³•æ¥æ¯”è¾ƒè®¾ç½®çš„å€¼åŠæ˜ å°„çš„é”®ï¼ˆä¹Ÿå°±æ„å‘³ä¸ç”¨è€ƒè™‘caveatsï¼‰ã€‚<br>å¯¹è±¡çš„ åŸå‹ ä¹Ÿä½¿ç”¨ å…¨ç­‰è¿ç®—ç¬¦ æ¯”è¾ƒã€‚<br>å¯¹è±¡çš„ç±»å‹æ ‡ç­¾åº”è¯¥ç›¸åŒã€‚</p>
<p>assert.notEqual(actual, expected[, message])              ä½¿ç”¨ ä¸ç­‰è¿ç®—ç¬¦ï¼ˆ!=ï¼‰æµ‹è¯•æ˜¯å¦ä¸ç›¸ç­‰ã€‚<br>assert.notDeepEqual(actual, expected[, message])          æµ‹è¯•æ˜¯å¦ä¸æ·±åº¦ç›¸ç­‰ã€‚ ä¸ assert.deepEqual() ç›¸åã€‚<br>assert.notStrictEqual(actual, expected[, message])        ä½¿ç”¨ ä¸å…¨ç­‰è¿ç®—ç¬¦ï¼ˆ!==ï¼‰æµ‹è¯•æ˜¯å¦ä¸å…¨ç­‰ã€‚<br>assert.notDeepStrictEqual(actual, expected[, message])    æµ‹è¯•æ˜¯å¦ä¸æ·±åº¦å…¨ç­‰ã€‚ ä¸ assert.deepStrictEqual() ç›¸åã€‚</p>
<p>assert.throws(block[, error][, message])   æœŸæœ› block å‡½æ•°æŠ›å‡ºé”™è¯¯errorï¼Œå¦‚æœblock(function)æŠ›å‡ºerrorçš„é”™è¯¯ï¼Œåˆ™æµ‹è¯•é€šè¿‡<br>error å¯ä»¥æ˜¯æ„é€ å‡½æ•°ã€æ­£åˆ™è¡¨è¾¾å¼ã€æˆ–è‡ªå®šä¹‰çš„éªŒè¯å‡½æ•°ã€‚</p>
<p>assert.doesNotThrow(block[, error][, message])  æ–­è¨€ block å‡½æ•°ä¸ä¼šæŠ›å‡ºé”™è¯¯<br>å½“ assert.doesNotThrow() è¢«è°ƒç”¨æ—¶ï¼Œå®ƒä¼šç«‹å³è°ƒç”¨ block å‡½æ•°ã€‚<br>å¦‚æœæŠ›å‡ºé”™è¯¯ä¸”é”™è¯¯ç±»å‹ä¸ error å‚æ•°æŒ‡å®šçš„ç›¸åŒï¼Œåˆ™æŠ›å‡º AssertionErrorã€‚ å¦‚æœé”™è¯¯ç±»å‹ä¸ç›¸åŒï¼Œæˆ– error å‚æ•°æ˜¯ undefinedï¼Œåˆ™é”™è¯¯ä¼šè¢«æŠ›å›ç»™è°ƒç”¨è€…ã€‚<br>å¦‚æœblockä¸æŠ›å‡ºé”™è¯¯ï¼Œåˆ™æµ‹è¯•é€šè¿‡</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/13/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><span class="page-number current">14</span><a class="page-number" href="/page/15/">15</a><span class="space">&hellip;</span><a class="page-number" href="/page/24/">24</a><a class="extend next" rel="next" href="/page/15/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/psb.jpg" alt="YooHannah">
          <p class="site-author-name" itemprop="name">YooHannah</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">232</span>
              <span class="site-state-item-name">æ—¥å¿—</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">åˆ†ç±»</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">20</span>
                <span class="site-state-item-name">æ ‡ç­¾</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">YooHannah</span>
</div>


<div class="powered-by">
  ç”± <a class="theme-link" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨
</div>

<div class="theme-info">
  ä¸»é¢˜ -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/treedocument/treedocument.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	




  
  

  

  

  

  


</body>
</html>
