<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="/atom.xml" title="My Little World" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0">






<meta property="og:type" content="website">
<meta property="og:title" content="My Little World">
<meta property="og:url" content="http://yoohannah.github.io/page/7/index.html">
<meta property="og:site_name" content="My Little World">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="My Little World">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoohannah.github.io/page/7/">





  <title> My Little World </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">My Little World</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">learn and share</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/knowledge/shadowDom.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/knowledge/shadowDom.html" itemprop="url">
                  Shadow DOM
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-27T20:18:15+08:00">
                2020-01-27
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Shadow DOM是HTML的一个规范，它允许浏览器开发者封装自己的HTML标签，css样式和特定js代码<br>同时也可以让开发者常见类似video这样的自定义一级标签，<br>创建的这些新标签和相关的api被称为 WEB Component</p>
<p>Shadow host 是shadow dom 的容器元素，就是最终使用的标签元素<br>Shadow root 是shadow dom 具体内容的根节点，可以使用document.createShadowRoot()创建<br>shadow tree 是shadow dom 包含的子节点数</p>
<p>在shadow root 上可以任意通过DOM操作添加任意shadow tree，同时指定样式和处理逻辑<br>并将自己的API暴露出来<br>完成创建后需要通过document.registerElement()在文档中注册元素<br>shadow dom 创建就完成了</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/vue/vue-router.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/vue/vue-router.html" itemprop="url">
                  vuerouter源码初步学习
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-27T12:34:15+08:00">
                2020-01-27
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>工作流程：<br> URL改变-&gt;出发监听事件-&gt;改变vue-router里的current变量-&gt;<br> 触发current变量的监听者-&gt;获取新组件-&gt;render新组件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">class HistoryRoute&#123;</span><br><span class="line">  constructor()&#123;</span><br><span class="line">    this.current=null</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">class vueRouter&#123;</span><br><span class="line">  constructor(options)&#123;</span><br><span class="line">    this.history= new HistoryRoute;</span><br><span class="line">    this.mode = options.mode || &apos;hash&apos;</span><br><span class="line">    this.routes = options.routes || []</span><br><span class="line">    this.routesMap = this.createMap(this.routes)</span><br><span class="line">    this.init()</span><br><span class="line">  &#125;</span><br><span class="line">  Init()&#123;</span><br><span class="line">    if(this.mode==&apos;hash&apos;)&#123;</span><br><span class="line">      //如果没有#号，自动加上#</span><br><span class="line">      location.hash?&quot;&quot;:location.hash=&apos;/&apos;</span><br><span class="line">      //监听hash改变</span><br><span class="line">      window.addEventListener(&apos;load&apos;,()=&gt;&#123;</span><br><span class="line">        //slice去掉#号</span><br><span class="line">        this.history.current=location.hash.slice(1)</span><br><span class="line">      &#125;)</span><br><span class="line">      window.addEventListener(&apos;hashchange&apos;,()=&gt;&#123;</span><br><span class="line">        this.history.current=location.hash.slice(1)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">      location.pathname?&quot;&quot;:location.pathname=&apos;/&apos;</span><br><span class="line">      window.addEventListener(&apos;load&apos;,()=&gt;&#123;</span><br><span class="line">        this.history.current=location.pathname</span><br><span class="line">      &#125;)</span><br><span class="line">      window.addEventListener(&apos;hashchange&apos;,()=&gt;&#123;</span><br><span class="line">        this.history.current=location.pathname</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  //将路由对象[&#123;path:&apos;xxx&apos;,component:a&#125;]转成：&#123;xxx:a&#125;</span><br><span class="line">  createMap(routes)&#123;</span><br><span class="line">    return routes.reduce((memo,current)=&gt;&#123;</span><br><span class="line">      memo[current.path] = current.components</span><br><span class="line">      return memo</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;  </span><br><span class="line">&#125;</span><br><span class="line">//定义属性标签 get set ===&gt;供VUE.use使用</span><br><span class="line">//VUE.use(xxxx) xxx是一个函数时直接运行xxx函数，xxx是一个对象或者类时，运行其上面的install方法</span><br><span class="line">vueRouter.install = function(Vue)&#123;</span><br><span class="line">  Vue.mixin(&#123;</span><br><span class="line">    beforeCreate()&#123;</span><br><span class="line">      //this指向当前组件实例，this.$options指向创建VUE实例时传入的配置项</span><br><span class="line">      if(this.$options&amp;&amp;this.$option.router)&#123;</span><br><span class="line">        //把当前实例挂在_root上</span><br><span class="line">        this._root = this</span><br><span class="line">        this._router = this.$options.router</span><br><span class="line">        Vue.util.defineReactive(this,&apos;current&apos;,this._router.history) //双向绑定，对路由变化进行监听，</span><br><span class="line">      &#125;</span><br><span class="line">      Object.defineProperty(this,&quot;$router&quot;,&#123; //能够获取$router但不能修改的原理。防止用户修改_router</span><br><span class="line">        get()&#123;</span><br><span class="line">          return this._root._router;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  Vue.components(&apos;router-view&apos;,&#123;</span><br><span class="line">    render(r)&#123;</span><br><span class="line">      //拿到当前路径</span><br><span class="line">      //this指向proxy,当前组件代理对象；this._self当前组件实例化对象；this._self._root当前组件对象</span><br><span class="line">      let current = this._self._root._router.history.current</span><br><span class="line">      let routeMap = this._self._root._router.routeMap</span><br><span class="line">      return r(routeMap[current])</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">module.exports = vueRouter</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/js/module.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/js/module.html" itemprop="url">
                  关于模块化
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-27T11:08:15+08:00">
                2020-01-27
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="什么是模块化"><a href="#什么是模块化" class="headerlink" title="什么是模块化"></a>什么是模块化</h1><p>  模块化就是把系统分离成独立功能的方法，从而实现需要什么功能，就加载什么功能<br>  当一个项目开发得越来越复杂时，会出现问题：命名冲突；文件依赖<br>  使用模块化开发，可以避免以上问题，并且提高开发效率：可维护性；可复用性</p>
<p>  模块化开发演变<br>  1.使用全局函数      ===&gt;早期开发就是将重复得代码封装到函数中，再将一系列的函数放到一个文件中<br>    存在的问题就是：污染全局变量；看不出相互的直接关系<br>  2.使用对象命名空间  ===&gt;通过对象命名空间的形式，从某种程度上解决了变量命名冲突的问题，但是并不能从根本上解决命名冲突<br>    存在的问题是：内部状态可被外部改写；命名空间越来越来长<br>  3.私有共有成员分离  ===&gt;利用此种方式将函数包装成一个独立的作用域，私有空间的变量和函数不会影响全局作用域<br>    存在问题：解决了变量命名冲突问题，但是没有解决降低开发复杂度的问题</p>
<h1 id="Commonjs"><a href="#Commonjs" class="headerlink" title="Commonjs"></a>Commonjs</h1><p>  commomJS规范加载模块是【同步】的，也就是说，加载完成才执行后面的操作<br>  Node.js主要用于服务器编程，模块都是存在本地硬盘中加载比较快，所以Node.js采用CommonJS<br>  三个部分：<br>  module变量在每个模块内部，就代表当前模块<br>  exports属性是对外的接口，用于导出当前模块的方法或变量<br>  require()用来加载外部模块，读取并执行js文件，返回该模块的exports对象<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">加载时执行：</span><br><span class="line">a.js</span><br><span class="line">exports.done = ture</span><br><span class="line">var b = require(&apos;b.js&apos;)</span><br><span class="line">console.log(&apos;a.js-done&apos;)</span><br><span class="line"></span><br><span class="line">b.js</span><br><span class="line">exports.done = false</span><br><span class="line">var a = require(&apos;a.js&apos;)</span><br><span class="line">console.log(a.done)</span><br><span class="line">console.log(&apos;b.js-done&apos;)</span><br><span class="line"></span><br><span class="line">App.js   执行App.js</span><br><span class="line">var a = require(&apos;a.js&apos;) // 因为引用b.js，执行b.js代码故打印出true b.js-done，引用完毕后接着执行打印出 a.js-done</span><br><span class="line">var b = require(&apos;b.js&apos;)// 已经被a引用过，不再执行 直接在缓存中找出 exports &#123;done：false&#125; 返回</span><br><span class="line">console.log(a.done)</span><br><span class="line">console.log(b.done) </span><br><span class="line"></span><br><span class="line">如果a.js改成如下</span><br><span class="line">var b = require(&apos;b.js&apos;)</span><br><span class="line">exports.done = ture</span><br><span class="line">console.log(&apos;a.js-done&apos;)</span><br><span class="line">执行App.js</span><br><span class="line">打印结果为undefined b.js-done a.js-done true false </span><br><span class="line">因为a依赖b时，执行b，b再依赖a时，exports.done = ture语句还未执行，故a 的 exports 为&#123;&#125; exports.done自然为undefined</span><br></pre></td></tr></table></figure></p>
<p>  只有commonjs因为同步加载，加载时执行可实现循环依赖，其他模式均不可以处理循环依赖的用法</p>
<h1 id="AMD-requirejs"><a href="#AMD-requirejs" class="headerlink" title="AMD(requirejs)"></a>AMD(requirejs)</h1><p>  AMD也就是【异步】模块定义，它采用异步方式加载模块，通过define方法去定义模块，require方法去加载模块<br>  定义：<br>  define([tools],function(){return {}}) //第一个参数为数组时，说明该模块还依赖其他模块,提前声明依赖，没有依赖时，只传入function即可<br>  加载：<br>  require([‘module’],callback) //第一个参数数组内成员即要加载的模块，callback是前面所有某块都加载成功之后的回调函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">/** a.js */</span><br><span class="line"></span><br><span class="line">define([&apos;b&apos;], function(b) &#123;</span><br><span class="line">  console.log(b)</span><br><span class="line">  var hello = function()&#123;</span><br><span class="line">    console.log(&apos;hello work&apos;)</span><br><span class="line">  &#125;</span><br><span class="line">  return &#123;</span><br><span class="line">    Hello:Hello</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">/** b.js */</span><br><span class="line"></span><br><span class="line">define(function()&#123;</span><br><span class="line">  var name = &apos;max&apos;</span><br><span class="line">  return&#123;</span><br><span class="line">    name:name</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">/** 使用a.js,b.js */</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> &lt;script type=&apos;text/javascript&apos; src=&apos;require.js&apos;&gt;&lt;/script&gt;</span><br><span class="line"> &lt;script type=&apos;text/javascript&apos;&gt;</span><br><span class="line">  require.config(&#123;</span><br><span class="line">    paths:&#123;</span><br><span class="line">      &apos;a&apos;:&apos;./a&apos;,</span><br><span class="line">      &apos;b&apos;:&apos;./b&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  require([&apos;a&apos;,&apos;b&apos;],function(a,b)&#123; //启用模块加载器</span><br><span class="line">    console.log(a)</span><br><span class="line">    console.log(b)</span><br><span class="line">  &#125;)</span><br><span class="line"> &lt;/script&gt;</span><br><span class="line"> */</span><br></pre></td></tr></table></figure></p>
<h1 id="CMD-seajs"><a href="#CMD-seajs" class="headerlink" title="CMD(seajs)"></a>CMD(seajs)</h1><p>  与AMD一样，只是定义和模块加载方式上不同<br>  一个模块一个文件<br>  define(function(require,exports,module){<br>   //require 是可以把其他模块导入进来的一个参数<br>   //exports可以把模块内的一些属性和方法导出<br>   //module是一个对象，上面存储了与当前模块相关联的一些属性和方法<br>  })<br>  CMD推崇依赖就近，延迟执行，文件是提前加载好的，只有在require的时候才去执行文件<br>  define(function(require,exports,module){<br>     var math = require(‘./math’)<br>     math.add()<br>  })<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">/** a.js */</span><br><span class="line"></span><br><span class="line">define(function(require,exports,module) &#123;</span><br><span class="line">  var b = require(&apos;b&apos;)</span><br><span class="line">  console.log(b)</span><br><span class="line">  exports.hello = function()&#123;</span><br><span class="line">    console.log(&apos;hello work&apos;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"> &lt;script type=&apos;text/javascript&apos; src=&apos;sea.js&apos;&gt;&lt;/script&gt;</span><br><span class="line"> &lt;script type=&apos;text/javascript&apos;&gt;</span><br><span class="line">  seajs.config(&#123;</span><br><span class="line">    alias:&#123;</span><br><span class="line">      &apos;a&apos;:&apos;./a&apos;,</span><br><span class="line">      &apos;b&apos;:&apos;./b&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  seajs.use([&apos;a&apos;,&apos;b&apos;],function(a,b)&#123; //启用模块加载器</span><br><span class="line">    console.log(a)</span><br><span class="line">    console.log(b)</span><br><span class="line">  &#125;)</span><br><span class="line"> &lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<h1 id="ES6模块化"><a href="#ES6模块化" class="headerlink" title="ES6模块化"></a>ES6模块化</h1><p>  汲取CommonJS和AMD优点，支持异步加载，未来可以成为浏览器和服务器通用的模块化解决方案<br>  export:用于把模块里的内容暴露出来， export default 为模块指定默认输出，一个模块只能有一个默认输出，所以export default 只能使用一次<br>  import： 用于引入模块提供的功能===&gt; import {x1,x2} form ‘./lib’; x1()</p>
<p>  ES6模块运行机制：<br>  ES6模块是动态引用，如果使用import从一个模块加载变量，变量不会被缓存，<br>  而是成为一个指向被加载模块的引用。等脚本执行时，根据只读引用到被加载的那个模块中去取值</p>
<p>  ES6与CommonJS模块差异<br>  CommonJS模块输出的是一个值的拷贝，ES6模块输出的是值得引用<br>  CommonJS模块运行时加载，ES6模块编译时输出接口</p>
<h1 id="加载器结构"><a href="#加载器结构" class="headerlink" title="加载器结构"></a>加载器结构</h1><h2 id="模块部分"><a href="#模块部分" class="headerlink" title="模块部分"></a>模块部分</h2><p>   每个模块创建都先初始化数据，存储在缓存对象中<br>   <img src="/image/module1.png" alt="module1"></p>
<h3 id="数据初始化"><a href="#数据初始化" class="headerlink" title="数据初始化"></a>数据初始化</h3><p>  <img src="/image/module2.png" alt="module2"><br>  加载器中设计了一个名为Module的构造函数，【每个模块都是此构造函数的实例对象】<br>  构造函数中给实例对象扩展了’未来’所需要用到的属性（uri:当前模块绝对路径地址，deps:模块的依赖列表….)及方法(load,resolve:获取当前模块绝对路径…)</p>
<h3 id="模块存储"><a href="#模块存储" class="headerlink" title="模块存储"></a>模块存储</h3><p>  加载器中设计了一个名为cache的缓存对象，每个文件(模块)都会存储在cache对象中<br>  具体存储方式:{‘当前模块绝对路径’: new Module()} 注意：当前模块的绝对路径是通过资源部分，资源定位方法实现的</p>
<h2 id="资源部分"><a href="#资源部分" class="headerlink" title="资源部分"></a>资源部分</h2><p>   资源定位和依赖管理是加载器涉及的两大核心</p>
<h3 id="资源定位"><a href="#资源定位" class="headerlink" title="资源定位"></a>资源定位</h3><p>  <img src="/image/module3.png" alt="module3"><br>  加载器中设计了一个resolve()方法把模块名解析成绝对路径格式<br>  检测当前模块名称是否有路径短名称配置，是否有模块短名称配置，是否有后缀<br>  在加载器启动方法中会去调用传入数组列表中的模块，获取模块名称<br>  然后根据当前项目绝对路径和模块名称进行拼接</p>
<h4 id="动态加载script文件"><a href="#动态加载script文件" class="headerlink" title="动态加载script文件"></a>动态加载script文件</h4><p>  动态创建script标签： document.create(‘script’)； src指向当前模块绝对路径地址<br>  加载文件同时，模块加载器解析当前模块所依赖的模块，以数组形式存储，更新到deps属性中</p>
<h3 id="依赖管理"><a href="#依赖管理" class="headerlink" title="依赖管理"></a>依赖管理</h3><p>  已知当前模块在cache中的形态，{‘当前模块绝对路径’: new Module()}<br>  换算成：{‘当前模块绝对路径’: {uri:’当前模块绝对路径’,deps:[]}}<br>  <img src="/image/module4.png" alt="module4"><br>    deps存储当前模块的依赖列表，依赖列表通过动态加载script文件正则解析获取<br>    重点：解析依赖—&gt;获取依赖模块绝对路径地址—-&gt;动态加载—-&gt;提取依赖—-&gt;解析依赖<br>        递归方式加载所有模块，直至模块全部加载完毕（模块的deps属性集合中没有依赖的绝对路径，即长度为0）</p>
<h2 id="如何实现一个文件一个作用域？"><a href="#如何实现一个文件一个作用域？" class="headerlink" title="如何实现一个文件一个作用域？"></a>如何实现一个文件一个作用域？</h2><p>  保证模块拥有独立作用域，采用对象命名空间的思想，即每个模块返回一个接口对象，这个独立作用域就是一个对象</p>
<h2 id="如何拿到依赖模块的接口对象？"><a href="#如何拿到依赖模块的接口对象？" class="headerlink" title="如何拿到依赖模块的接口对象？"></a>如何拿到依赖模块的接口对象？</h2><p>  参数即define传入的函数，执行函数，返回函数返回的结果即对象</p>
<h2 id="如何让寻找依赖？"><a href="#如何让寻找依赖？" class="headerlink" title="如何让寻找依赖？"></a>如何让寻找依赖？</h2><p>  拼接地址，缓存，然后递归<br>  图片：依赖加载策略 模块数据初始化 资源定位-动态加载 依赖管理解决方案</p>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br></pre></td><td class="code"><pre><span class="line">(function(global) &#123;</span><br><span class="line">  var startUp = global.startUp = &#123;</span><br><span class="line">    version:&apos;1.0.1&apos;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  var data = &#123;&#125; //配置信息</span><br><span class="line">  var cache = &#123;&#125;</span><br><span class="line">  var anonymousMeta = &#123;&#125;</span><br><span class="line">  //模块生命周期</span><br><span class="line"></span><br><span class="line">  var status = &#123;</span><br><span class="line">    FETCHED: 1,</span><br><span class="line">    SAVED:2,</span><br><span class="line">    LOADING:3,</span><br><span class="line">    LOADED:4,</span><br><span class="line">    EXECTING:5,</span><br><span class="line">    EXECTED:6</span><br><span class="line">  &#125;</span><br><span class="line">  var isArray = function (obj) &#123;</span><br><span class="line">    return toString.call(obj) === &quot;[object Array]&quot;</span><br><span class="line">  &#125;</span><br><span class="line">  var isFunction = function (obj) &#123;</span><br><span class="line">    return toString.call(obj) === &quot;[object Function]&quot;</span><br><span class="line">  &#125;</span><br><span class="line">  var isString = function (obj) &#123;</span><br><span class="line">    return toString.call(obj) === &quot;[object String]&quot;</span><br><span class="line">  &#125;</span><br><span class="line">  function scripts()&#123;</span><br><span class="line">    return document.getElementsByTagName(&apos;script&apos;)</span><br><span class="line">  &#125;</span><br><span class="line">  function getInteractiveScript()&#123; //支持data-main属性添加默认路径: &lt;script data-main = &apos;common/js&apos; src=&apos;module.js&apos;&gt;&lt;/script&gt;</span><br><span class="line">    var arrS = scripts()</span><br><span class="line">    var dataMain,src</span><br><span class="line">    var exp = /^.*\.js$/</span><br><span class="line">    arrS = [].slice.call(arrS)</span><br><span class="line">    arrS.forEach(function(script)&#123;</span><br><span class="line">      dataMain = script.getAttribute(&apos;data-main&apos;)</span><br><span class="line">      if(dataMain &amp;&amp; !data.baseUrl &amp;&amp; !(exp.test(dataMain)))&#123;</span><br><span class="line">        if(dataMain.substring(dataMain.length-1) !== &apos;/&apos;)&#123;</span><br><span class="line">          dataMain = (dataMain+&apos;/&apos;)</span><br><span class="line">        &#125;</span><br><span class="line">        data.baseUrl = dataMain</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  getInteractiveScript()</span><br><span class="line">  //是否使用了别名</span><br><span class="line">  function parseAlias(id)&#123;</span><br><span class="line">    var alias = data.alias //是否配置别名</span><br><span class="line">    return alias &amp;&amp; isString(alias[id]) ? alias[id] :id //没有配置别名，返回原来值，有配置别名，返回别名对应值</span><br><span class="line">  &#125;</span><br><span class="line">  //不能以&apos;/&apos;&apos;:&apos;开头，必须是一个&apos;/&apos;后面跟随任意字符至少一个</span><br><span class="line">  var PATH_RE = /^([^\/:]+)(\/.+)$/ //([^\/:]+) 路径的短名称配置</span><br><span class="line"></span><br><span class="line">  //检测是否 书写路径短名称</span><br><span class="line">  function parsePaths(id) &#123;</span><br><span class="line">    var paths = data.paths; //是否配置短路径</span><br><span class="line">    if(paths &amp;&amp; (m=id.match(PATH_RE)) &amp;&amp; isString(paths[m[1]]))&#123;</span><br><span class="line">      id = paths[m[1]]+m[2]</span><br><span class="line">    &#125;</span><br><span class="line">    return id</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  //检测是否添加后缀</span><br><span class="line">  function normalize(path)&#123;</span><br><span class="line">    var last = path.length-1</span><br><span class="line">    var lastC = path.charAt(last)</span><br><span class="line">    return (lastC === &apos;/&apos; || path.substring(last-2) === &apos;.js&apos;) ? path :path+&apos;.js&apos;</span><br><span class="line">  &#125;</span><br><span class="line">  //添加根目录</span><br><span class="line">  function addBase(id,uri)&#123;</span><br><span class="line">    // var result;</span><br><span class="line">    // //相对路径</span><br><span class="line">    // if(id.charAt(0) === &apos;.&apos;)&#123;</span><br><span class="line">    //   result = realpath( (uri ? uri.match(/[^?]*\//)[0] : data.cwd ) + id)</span><br><span class="line">    // &#125;else&#123;</span><br><span class="line">    //   result = data.cwd+id</span><br><span class="line">    // &#125;</span><br><span class="line">    var result = data.baseUrl ?data.cwd + data.baseUrl +id : data.cwd + id //支持data-main属性添加默认路径</span><br><span class="line">    return result</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  var DOT_RE = /\/.\//g //   /a/b/./c/./d ==&gt;/a/b/c/d     /./ ==&gt;/</span><br><span class="line">  var DOUBLE_DOT_RE = /\/[^/]+\/\.\.\//; // a/b/c/../../d ===&gt;a/b/../d ==&gt; a/d    /xxxxx/../==&gt; /</span><br><span class="line">  //规范路径</span><br><span class="line">  function realpath(path)&#123;</span><br><span class="line">    path = path.replace(DOT_RE,&apos;/&apos;)</span><br><span class="line">    while(path.match(DOUBLE_DOT_RE))&#123;</span><br><span class="line">      path= path.replace(DOUBLE_DOT_RE,&apos;/&apos;)</span><br><span class="line">    &#125;</span><br><span class="line">    return path</span><br><span class="line">  &#125;</span><br><span class="line">  //生成绝对路径 资源路径解析</span><br><span class="line">  startUp.resolve = function (child,parent) &#123;</span><br><span class="line">    if(!child) return &apos;&apos;</span><br><span class="line">    child = parseAlias(child) //检测是否有别名</span><br><span class="line">    child = parsePaths(child) //检测是否有路径别名，依赖模块中引包的模块路径地址 require(&apos;app/c)</span><br><span class="line">    child = normalize(child) //检测是否添加后缀</span><br><span class="line">    return addBase(child,parent) //添加根目录</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  startUp.request = function(url,callback)&#123;</span><br><span class="line">    var node = document.createElement(&apos;script&apos;)</span><br><span class="line">    node.src = url</span><br><span class="line">    document.body.appendChild(node)</span><br><span class="line">    node.onload = function()&#123;</span><br><span class="line">      node.onload = null</span><br><span class="line">      document.body.removeChild(node) //加载依赖结束后移除加载时的script标签</span><br><span class="line">      callback()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  //模块加载器启用</span><br><span class="line">  startUp.use = function(list,callback)&#123;</span><br><span class="line">    //检阅有没有预先加载的模块</span><br><span class="line">    Module.preload(function()&#123;</span><br><span class="line">      Module.use(list,callback,data.cwd+&quot;_use_&quot;+cid()) //虚拟的根目录</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  //模块加载器配置</span><br><span class="line">  /**</span><br><span class="line">   * </span><br><span class="line">   * startUp.config(&#123;</span><br><span class="line">   *   alias:&#123;</span><br><span class="line">   *    a:&apos;common/js/a&apos;</span><br><span class="line">   *   &#125;,</span><br><span class="line">   *   preload:[c.js]</span><br><span class="line">   * &#125;)</span><br><span class="line">   */</span><br><span class="line">  startUp.config = function (options) &#123;</span><br><span class="line">    var key,curr</span><br><span class="line">    for(key in options)&#123;</span><br><span class="line">      curr = Option[key]</span><br><span class="line">      data[key] = curr</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  //构造函数 模块初始化数据</span><br><span class="line">  function Module(uri,deps)&#123;</span><br><span class="line">    this.uri = uri;</span><br><span class="line">    this.deps = deps || [] //依赖项</span><br><span class="line">    this.exports = null</span><br><span class="line">    this.status = 0</span><br><span class="line">    this._waitings = &#123;&#125;</span><br><span class="line">    this._remain = 0</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  //分析主干(左子树 | 右子树)上的依赖项</span><br><span class="line">  Module.prototype.load = function()&#123;</span><br><span class="line">    var m = this</span><br><span class="line">    m.status = status.LOADING//LOADING == 3 正在加载模块依赖项</span><br><span class="line">    var uris = m.resolve()//获取主干上的依赖项</span><br><span class="line">    var len = m.remain = uris.length</span><br><span class="line"></span><br><span class="line">    //加载主干上的依赖项(模块)</span><br><span class="line">    var seed</span><br><span class="line">    for(var i=0;i&lt;len;i++)&#123;</span><br><span class="line">      seed = Module.get(uris[i]) //创建缓存信息</span><br><span class="line">      if(seed.status &lt;status.LOADED)&#123; //LOADED == 4 准备加载执行当前模块</span><br><span class="line">        seed._waitings[m.uri] = seed._waitings[m.uri] || 1 //多少模块依赖于我，_waitings是依赖我的模块的路径集合</span><br><span class="line">      &#125;else&#123;</span><br><span class="line">        seed._remain--</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    //如果依赖列表模块全部加载完毕</span><br><span class="line">    if(m._remain == 0)&#123; //递归过程到此结束</span><br><span class="line">      //获取模块的接口对象</span><br><span class="line">      m.onload()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //准备执行根目录下的依赖列表中的模块</span><br><span class="line">    var requestCache = &#123;&#125;</span><br><span class="line">    for(var i=0;i&lt;len;i++)&#123;</span><br><span class="line">      seed = Module.get(uris[i])</span><br><span class="line">      if(seed.status &lt; status.FETCHED)&#123;</span><br><span class="line">        seed.fetch(requestCache)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    for(uri in requestCache)&#123;</span><br><span class="line">      requestCache[uri]()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Module.prototype.fetch = function(requestCache)&#123;</span><br><span class="line">    var m =this</span><br><span class="line">    m.status = status.FETCHED</span><br><span class="line">    var uri = m.uri</span><br><span class="line">    requestCache[uri] = sendRequest; //Document.createElement(&apos;script)</span><br><span class="line">    </span><br><span class="line">    function sendRequest()&#123;</span><br><span class="line">      startUp.request(uri,onRequest) //动态加载script</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function onRequest()&#123; //事件函数 script标签加载模块结束后，onload 函数中会被调用</span><br><span class="line">      if(anonymousMeta)&#123; //模块的数据更新</span><br><span class="line">        m.save(uri,anonymousMeta)</span><br><span class="line">      &#125;</span><br><span class="line">      m.load() //递归 模块加载策略</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Module.prototype.onload = function()&#123;</span><br><span class="line">    var mod = this</span><br><span class="line">    mod.status = LOADED //4</span><br><span class="line">    if(mod.callback)&#123;//获取模块接口对象</span><br><span class="line">      mod.callback()</span><br><span class="line">    &#125;</span><br><span class="line">    var waitings = mod._waitings //依赖加载完，递归回调 被依赖模块(父)的callback</span><br><span class="line">    var key,m;</span><br><span class="line">    for(key in waitings)&#123;</span><br><span class="line">      var m = cache[key]</span><br><span class="line">      m._remain -= waitings[key]</span><br><span class="line">      if(m._remain == 0)&#123; //判断父模块依赖是否全部加载完</span><br><span class="line">        m.onload()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  //资源定位 解析依赖项生成绝对路径</span><br><span class="line">  Module.prototype.resolve = function()&#123;</span><br><span class="line">    var mod = this</span><br><span class="line">    var ids = mod.deps</span><br><span class="line">    var uris = []</span><br><span class="line">    for(var i =0;i&lt;ids.length;i++)&#123;</span><br><span class="line">      uris[i] = startUp.resolve(ids[i],mod.uri) //依赖项（主干 | 子树）</span><br><span class="line">    &#125;</span><br><span class="line">    return uris;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   //更改初始化数据</span><br><span class="line">  Module.prototype.save = function(uri,meta)&#123;</span><br><span class="line">    var mod = Module.get(uri)</span><br><span class="line">    mod.uri = uri</span><br><span class="line">    mod.deps = meta.deps || []</span><br><span class="line">    mod.factory = meta.factory</span><br><span class="line">    mod.status = status.SAVED</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  //获取接口对象</span><br><span class="line">  Module.prototype.exec = function()&#123;</span><br><span class="line">    var module = this</span><br><span class="line">    //防止重复执行</span><br><span class="line">    if(module.status &gt;= status.EXECTING)&#123;</span><br><span class="line">      return module.exports</span><br><span class="line">    &#125;</span><br><span class="line">    module.status = status.EXECTING;</span><br><span class="line">    var uri = module.uri</span><br><span class="line">    function require(id)&#123; //作为参数传递到define参数的函数中</span><br><span class="line">      return Module.get(require.resolve(id)).exec() //获取接口对象</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    require.resolve = function(id)&#123;</span><br><span class="line">      return startUp.resolve(id,uri)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    var factory = module.factory //define传入的函数</span><br><span class="line">    var exports = isFunction(factory) ? factory(require,module.exports= &#123;&#125;,module) :factory;</span><br><span class="line">    if(exports === undefined) &#123;</span><br><span class="line">      exports = module.exports</span><br><span class="line">    &#125;</span><br><span class="line">    module.exports = exports</span><br><span class="line">    module.status = status.EXECTED //6</span><br><span class="line">    return exports</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  //定义一个模块</span><br><span class="line">  Module.define = function(factory)&#123;</span><br><span class="line">    var deps</span><br><span class="line">    if(isFunction(factory))&#123;</span><br><span class="line">      //正则解析依赖项</span><br><span class="line">      deps = parseDependencies(factory.toString())</span><br><span class="line">    &#125;</span><br><span class="line">    //存储当前模块信息</span><br><span class="line">    var meta = &#123;</span><br><span class="line">      id:&apos;&apos;,</span><br><span class="line">      uri:&apos;&apos;,</span><br><span class="line">      deps:deps,</span><br><span class="line">      factory:factory</span><br><span class="line">    &#125;</span><br><span class="line">    anonymousMeta = meta</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  //检测缓存对象上是否有当前模块信息</span><br><span class="line">  Module.get = function(uri,deps)&#123;</span><br><span class="line">    //cache[&apos;xxxxx.js&apos;] = &#123;uri:&apos;xxxxx.js&apos;,deps:[]&#125; //module 实例对象</span><br><span class="line">    return cache[uri] || (cache[uri] = new Module(uri,deps))</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Module.use = function(deps,callback,uri)&#123;</span><br><span class="line">    var m = Module.get(uri,isArray(deps)?dep:[deps])</span><br><span class="line">    console.log(module)</span><br><span class="line">    //所有模块都加载完毕</span><br><span class="line">    m.callback= function()&#123;</span><br><span class="line">      var exports = [] //所有依赖项模块的接口对象</span><br><span class="line">      var uris = m.resolve()</span><br><span class="line">      for(var i = 0;i&lt;uris.length;i++)&#123;</span><br><span class="line">        exports[i] = cache[uris[i]].exec() //获取模块对外定义的接口对象</span><br><span class="line">      &#125;</span><br><span class="line">      if(callback)&#123;</span><br><span class="line">        callback.apply(global,exports)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    m.load()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  var _cid = 0</span><br><span class="line"></span><br><span class="line">  function cid()&#123;</span><br><span class="line">    return _cid++</span><br><span class="line">  &#125;</span><br><span class="line">  // data.preload = []</span><br><span class="line">  //取消当前项目文档的URL</span><br><span class="line">  data.cwd = document.URL.match(/[^?]*\//)[0]</span><br><span class="line">  Module.preload = function(callback)&#123;</span><br><span class="line">    var preload = data.preload ||[]</span><br><span class="line">    var length = data.preload.length</span><br><span class="line">    if(length)&#123; //length !== 0 先加载预先设定模块</span><br><span class="line">      Module.use(preload,function () &#123;</span><br><span class="line">        preload.splice(0,length)</span><br><span class="line">        callback()</span><br><span class="line">      &#125;,data.cwd+&apos;_use_&apos;+cid())</span><br><span class="line">    &#125; else&#123;</span><br><span class="line">      callback() </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  var REQUIRE_RE = /\brequire\s*\(\s*([&quot;&apos;])(.+?)\1\s*\)/g</span><br><span class="line">  function parseDependencies(code)&#123;</span><br><span class="line">    var ret = []</span><br><span class="line">    code.replace(REQUIRE_RE,function(m,m1,m2)&#123;</span><br><span class="line">      if(m2) ret.push(m2)</span><br><span class="line">    &#125;)</span><br><span class="line">    return ret</span><br><span class="line">  &#125;</span><br><span class="line">  global.define = module.define</span><br><span class="line">&#125;)(this)</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/vue/src1.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/vue/src1.html" itemprop="url">
                  vue 源码学习一【new vue】
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-27T10:48:15+08:00">
                2020-01-27
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="new-vue时发生了什么"><a href="#new-vue时发生了什么" class="headerlink" title="new vue时发生了什么"></a>new vue时发生了什么</h1><p>平常练习时使用vue顺序是，将vue.js引入html,<br>new vue就可以开始使用vue框架写东西<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;div id = &apos;app&apos;&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123;a&#125;&#125;&lt;/p&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;script type=&quot;text/javascript&quot; src=&quot;vue.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    let app = new Vue(&#123;</span><br><span class="line">      el:&apos;#app&apos;,</span><br><span class="line">      data:&#123;</span><br><span class="line">        a:&apos;hello world&apos;</span><br><span class="line">      &#125;,</span><br><span class="line">      method:&#123;&#125;,</span><br><span class="line">    &#125;)</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure></p>
<p>代码运行顺序是，当我们在script标签引入文件时，<br>引入的vuejs文件会先执行一遍，<br>执行的结果就是帮助我们生成一个挂载在全局的，vue对象的构造函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">(function (global, factory) &#123;</span><br><span class="line">  typeof exports === &apos;object&apos; &amp;&amp; typeof module !== &apos;undefined&apos; ? module.exports = factory() :</span><br><span class="line">  typeof define === &apos;function&apos; &amp;&amp; define.amd ? define(factory) :</span><br><span class="line">  (global = global || self, global.Vue = factory());//将vue挂到全局上下文中</span><br><span class="line">&#125;(this, function () &#123; &apos;use strict&apos;;</span><br><span class="line">  function Vue (options) &#123;</span><br><span class="line">    if (!(this instanceof Vue)</span><br><span class="line">    ) &#123;</span><br><span class="line">      warn(&apos;Vue is a constructor and should be called with the `new` keyword&apos;);</span><br><span class="line">    &#125;</span><br><span class="line">    this._init(options);</span><br><span class="line">  &#125;</span><br><span class="line">  initMixin(Vue);</span><br><span class="line">  stateMixin(Vue);</span><br><span class="line">  eventsMixin(Vue);</span><br><span class="line">  lifecycleMixin(Vue);</span><br><span class="line">  renderMixin(Vue);</span><br><span class="line">  initGlobalAPI(Vue);</span><br><span class="line">  Vue.compile = compileToFunctions;</span><br><span class="line"></span><br><span class="line">  return Vue;</span><br><span class="line"></span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure></p>
<p>当代码运行到new vue时，代码就会调用function Vue<br>function Vue 中会【调用】自己的_init()方法，<br>对即将生成的vue对象做初始化工作，即开始生成vue对象</p>
<p>_init方法定义在initMixin函数中<br>在调用initMixin生成构造函数流程中被挂到vue上<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">Vue.prototype._init = function (options) &#123;</span><br><span class="line">  var vm = this;</span><br><span class="line">  vm._uid = uid$3++;</span><br><span class="line"></span><br><span class="line">  var startTag, endTag;</span><br><span class="line">  vm._isVue = true;// a flag to avoid this being observed</span><br><span class="line">  // 合并选项,将配置项以内置选项进行合并</span><br><span class="line">  if (options &amp;&amp; options._isComponent) &#123;</span><br><span class="line">    //优化内部组件实例化过程</span><br><span class="line">    // 由于动态选项合并非常慢，并且内部组件选项均不需要特殊处理。</span><br><span class="line">    initInternalComponent(vm, options);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    vm.$options = mergeOptions(</span><br><span class="line">      resolveConstructorOptions(vm.constructor),</span><br><span class="line">      options || &#123;&#125;,</span><br><span class="line">      vm</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  /* istanbul ignore else */</span><br><span class="line">  &#123;</span><br><span class="line">    initProxy(vm);</span><br><span class="line">  &#125;</span><br><span class="line">  // expose real self</span><br><span class="line">  vm._self = vm;</span><br><span class="line">  initLifecycle(vm);</span><br><span class="line">  initEvents(vm);</span><br><span class="line">  initRender(vm);</span><br><span class="line">  callHook(vm, &apos;beforeCreate&apos;);//运行订阅了beforecreate钩子的相关方法</span><br><span class="line">  initInjections(vm); // resolve injections before data/props</span><br><span class="line">  initState(vm);</span><br><span class="line">  initProvide(vm); // resolve provide after data/props</span><br><span class="line">  callHook(vm, &apos;created&apos;);</span><br><span class="line">  if (vm.$options.el) &#123;//如果配置了el,就进行挂载处理挂载</span><br><span class="line">    vm.$mount(vm.$options.el);//会给给option挂上render，staticRenderFns属性</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/vue/usual.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/vue/usual.html" itemprop="url">
                  一些关于vue的零散笔记
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-27T10:48:15+08:00">
                2020-01-27
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="释放内部对象且能防止外部修改的方式"><a href="#释放内部对象且能防止外部修改的方式" class="headerlink" title="释放内部对象且能防止外部修改的方式"></a>释放内部对象且能防止外部修改的方式</h1><p>通过创建中间对象挂载到实例上，通过中间对象的set方法进行拦截<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">function initGlobalAPI (Vue) &#123;</span><br><span class="line">  var configDef = &#123;&#125;;</span><br><span class="line">  configDef.get = function () &#123; return config; &#125;; //config对象是vue对象构建过程的内部对象，存储全局配置项</span><br><span class="line">  &#123;</span><br><span class="line">    configDef.set = function () &#123;</span><br><span class="line">      warn(</span><br><span class="line">        &apos;Do not replace the Vue.config object, set individual fields instead.&apos;</span><br><span class="line">      );</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  Object.defineProperty(Vue, &apos;config&apos;, configDef);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><a href="https://cn.vuejs.org/v2/api/#optionMergeStrategies" target="_blank" rel="noopener">Vue.config.optionMergeStrategies</a> 应用中<br>Vue.config可以get,得到的即内部的config，但如果进行Vue.config = xxxx set操作就会报错<br>通过Vue.config可以获得内部config，从而可以修改内部config对象上的属性，从而修改到全局配置</p>
<h1 id="关于3-0的思考"><a href="#关于3-0的思考" class="headerlink" title="关于3.0的思考"></a>关于3.0的思考</h1><p>如何更快<br>Object.defineProperty–&gt;Proxy<br>Virtual Dom重构<br>更多编译优化：<br>Slot默认编译为函数<br>重构vnode factory，统一输入参数，进一步优化编译处理函数(Monomorphic vnode factory)<br>编译时增加vnode/children 类型信息标识，从而做进一步优化（Compiler-generated flags for vnode/children types）</p>
<p>Function based API 对比Class API 好处<br>更好的TS类型推导支持<br>更灵活的逻辑复用能力<br>Tree-shaking 友好<br>代码更容易压缩</p>
<p>现有逻辑复用模式<br>Mixins<br>高阶组件<br>基于scoped slots/作用域插槽封装逻辑的组件<br>存在问题<br>数据来源不清晰 （Function based API 数据来源清晰）<br>命名冲突（Function based API 没有命名冲突）<br>无谓的额外组件的性能消耗 （Function based API 没有额外组件性能消耗）</p>
<p>对比React Hooks<br>同样的逻辑组合，复用能力更强<br>只调用一次<br>符合JS直觉<br>没有闭包变量问题<br>没有内存/GC压力<br>不存在内联回调导致子组件永远更新问题</p>
<p>2.0<br>mergeOption 选项策略处理<br>插件开发：以默认配置优先；以用户配置为覆盖<br>策略：听过JS 增强配置选项的表达力<br>{}==&gt;function(){}  el===根实例</p>
<p>数据劫持vue3.0改用proxy原因<br>defineProperty只能监听某个属性，不能对全对象监听，使用proxy可以省去for in提升效率<br>可以监听数组，不用再去单独的对数组做特异性操作</p>
<p>vue2.0 vdom性能瓶颈<br>虽然能够保证触发更新的组件最小化，但在单个组件内部依然需要遍历该组件的整个Vdom树<br>vdom的性能跟模板大小正相关，跟动态节点的数量无关。<br>在一些组件整个模板内只有少量动态节点的情况下，这些遍历都是性能的浪费</p>
<h1 id="编译3步骤"><a href="#编译3步骤" class="headerlink" title="编译3步骤"></a>编译3步骤</h1><p>parse：AST<br>optimize:标记静态节点<br>generate 生成目标平台所需的代码 将AST转化成render function字符串</p>
<h1 id="修饰符"><a href="#修饰符" class="headerlink" title="修饰符"></a>修饰符</h1><p>v-model.lazy 从input事件中转变为在change事件中同步数据<br>v-model.number 可以将输入转换为Number类型<br>v-model.trim 可以自动过滤输入的首尾空格</p>
<p>v-for 循环时，key尽量赋值为不变的值，即静态值，如item.id ,否则列表增删时，会更新每一项</p>
<p>当子组件需要向父组件传递数据时，就要用到自定义事件<br>子组件用$emit来触发事件，父组件用$on()来监听子组件的事件<br>自定义组件的v-model ：一个组件上的v-model 默认会利用名为value的prop和名为input的事件<br>将原生事件绑定到组件： 使用v-on的.native修饰符监听原生事件<br>.sync修饰符：父组件监听自定义事件按需更新数据</p>
<h1 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h1><p>动态组件：VUE 提供了一个特殊的元素&lt;component&gt;用来动态的挂载不同的组件，使用is特性来选择要挂载的组件， 还可以使用&lt;keep-alive&gt;标签使组件进行缓存</p>
<p>异步组件：VUE允许将组件定义为一个工厂函数，动态地解析组件。VUE只在组件需要渲染时触发工厂函数，并且把结果缓存起来用于后面地再次渲染</p>
<h2 id="组件创建方式"><a href="#组件创建方式" class="headerlink" title="组件创建方式"></a>组件创建方式</h2><p>1.调用Vue.extend(),创建名为xx的组件，template定义模板的标签，模板的内容需要写在该标签下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var xx = Vue.extend(&#123;</span><br><span class="line">    template:&apos;&lt;div&gt;this is a component&lt;/div&gt;&apos;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>2.使用&lt;template&gt;标签创建，需要加上id属性<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;template id = &apos;mycom&apos;&gt;</span><br><span class="line">  &lt;div&gt;this is a component&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure></p>
<p>3.使用&lt;script&gt;标签创建，需要加id属性，同时还得加type=’text/x-template’ 不执行编译里面的代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=&apos;text/x-template&apos; id = &apos;mycom&apos;&gt;</span><br><span class="line">  &lt;div&gt;this is a component&lt;/div&gt;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="组件全局注册方式"><a href="#组件全局注册方式" class="headerlink" title="组件全局注册方式"></a>组件全局注册方式</h2><p>1.调用Vue.extend(),创建名为myCom的组件全局注册<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Vue.component(&apos;my-com&apos;,myCom)</span><br></pre></td></tr></table></figure></p>
<p>2.template及script标签构建的组件全局注册<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Vue.component(&apos;my-comp&apos;,&#123;</span><br><span class="line">    template:&apos;#mycom&apos;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<h2 id="组件局部注册"><a href="#组件局部注册" class="headerlink" title="组件局部注册"></a>组件局部注册</h2><p>1.调用Vue.extend(),创建名为myCom的组件局部注册（只能在注册该组件的实例中使用，一处注册，一处使用）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var app = new Vue(&#123;</span><br><span class="line">    el:&apos;#app&apos;,</span><br><span class="line">    components:&#123;</span><br><span class="line">        &apos;my-com&apos;:myCom</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>2.template及script构建的组件局部注册<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var app = new Vue(&#123;</span><br><span class="line">    el:&apos;#app&apos;</span><br><span class="line">    componnets:&#123;</span><br><span class="line">        &apos;my-com&apos;:&#123;</span><br><span class="line">            template:&apos;#myCom&apos;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<h2 id="组件化处理边界情况"><a href="#组件化处理边界情况" class="headerlink" title="组件化处理边界情况"></a>组件化处理边界情况</h2><p>1.访问根实例 this.$root.xxx<br>2.访问父组件实例：this.$parent.xxx<br>3.访问子组件实例或子元素：&lt;child ref=’xxx’&gt;&lt;/child &gt; =&gt;this.$refs.xxx<br>4.依赖注入：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">provide:function()&#123; //父组件</span><br><span class="line">    return&#123;</span><br><span class="line">        getMap:this.getMap</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">inject:[getMap]//子组件</span><br></pre></td></tr></table></figure></p>
<p>然而，依赖注入还是有负面影响的。它将你应用程序中的组件与它们当前的组织方式耦合起来，使重构变得更加困难。同时所提供的属性是非响应式的。这是出于设计的考虑，因为使用它们来创建一个中心化规模化的数据跟使用 $root做这件事都是不够好的。如果你想要共享的这个属性是你的应用特有的，而不是通用化的，或者如果你想在祖先组件中更新所提供的数据，那么这意味着你可能需要换用一个像 Vuex 这样真正的状态管理方案了</p>
<p>5.统一处理事件侦听器时，在组件卸载前，统一清除监听器<br>6.组件循环引用，Vue.component注册的组件允许，但是模块化导入的不允许<br>7.模板定义的替代品：<br>A:内联模板：当inline-template这个特殊的特性出现在一个子组件上时，这个组件将会使用其里面的内容作为模板<br>而不是将其作为被分发的内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;myCom inline-template&gt;&lt;div&gt;&lt;p&gt;these are compiled as the component&apos;s own template&lt;/p&gt;&lt;/div&gt;&lt;/myCom&gt;</span><br></pre></td></tr></table></figure></p>
<p>B:x-template<br>在script标签里使用text/x-template，并且指定id,将这个id赋值给template<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=&apos;text/x-template&apos; id = &apos;mycom&apos;&gt;</span><br><span class="line">  &lt;div&gt;this is a component&lt;/div&gt;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">Vue.component(&apos;my-comp&apos;,&#123;</span><br><span class="line">    template:&apos;#mycom&apos;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>8.强制更新<br>A：使用this.$forceUpdate<br>B：使用v-once创建低开销静态组件，组件包含大量静态内容可以在根元素上添加v-once特性以确保这些内容只计算一次然后缓存起来</p>
<h2 id="组件通信类型"><a href="#组件通信类型" class="headerlink" title="组件通信类型"></a>组件通信类型</h2><p>父子组件通信<br>1.使用props和$emit父子组件相互通信<br>2.父组件用$children或者利用ref操作子组件<br>3.子组件$parent访问父组件</p>
<p>非父子组件通信<br>1.使用中央事件总线(eventbus来处理非父子组件间的通信)<br>2.祖先元素通过provide提供数据，后代通过<a href="https://www.cnblogs.com/llcdxh/p/10330929.html" target="_blank" rel="noopener">inject</a>获取该数据<br>3.使用<a href="https://blog.csdn.net/songxiugongwang/article/details/84001967" target="_blank" rel="noopener">$attrs和$listeners</a>实现祖孙组件通信<br>4.$root直接访问根组件</p>
<h1 id="Vue-use"><a href="#Vue-use" class="headerlink" title="Vue.use"></a>Vue.use</h1><p>Vue.use(myPlugin)本质上是调用myPlugin.install(VUE)<br>使用插件必须在new vue()启动应用之前完成，实例化之前就要配置好<br>使用Vue.use多次注册相同插件，那只会注册成功一次<br>一个测试案例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import Vue from &apos;vue&apos;</span><br><span class="line">import &#123;expect&#125; from &apos;chai&apos;</span><br><span class="line">import Counter from &apos;@/counter.vue&apos;</span><br><span class="line"></span><br><span class="line">describe(&apos;测试Counter.vue&apos;,()=&gt;&#123;</span><br><span class="line">    const Constructor = Vue.extend(Counter)</span><br><span class="line">    const vm = new Constructor().$mount()</span><br><span class="line">    const button = vm.$el.querySelector(&apos;button&apos;)</span><br><span class="line">    const clickE = new window.Event(&apos;click&apos;)</span><br><span class="line">    button.dispatchEvent(clickE)</span><br><span class="line">    vm._watcher.run()</span><br><span class="line">    expect(Number(vm.$el.querySelector(&apos;span&apos;).textContent)).to.equal(1)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<h1 id="vuex"><a href="#vuex" class="headerlink" title="vuex"></a>vuex</h1><p>默认的五种基本对象<br>state:存储状态(对象)<br>getters:对数据获取之前的再次编译，可以理解为state的计算属性，对state的数据进行筛选，过滤<br>mutations:同步修改状态，并且是同步的。在组件中使用$store.commit(‘’,params)<br>actions:异步修改状态，在组件中使用是$store.dispatch(‘’)<br>modules:store的子模块，为了开发大型项目，方便状态管理而使用的</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/vue/src3.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/vue/src3.html" itemprop="url">
                  vue 源码学习三
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-27T10:48:15+08:00">
                2020-01-27
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>钩子函数的执行顺序</p>
<p>不使用keep-alive beforeRouteEnter –&gt; created –&gt; mounted –&gt; destroyed</p>
<p>使用keep-alive beforeRouteEnter –&gt; created –&gt; mounted –&gt; activated –&gt; deactivated 再次进入缓存的页面，只会触发beforeRouteEnter –&gt;activated –&gt; deactivated 。 created和mounted不会再执行。</p>
<p>我们可以利用不同的钩子函数，做不同的事。</p>
<h1 id="vue-component"><a href="#vue-component" class="headerlink" title="vue.component"></a>vue.component</h1><p>template配置项的处理，与编译时的判断做对比<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">function _createElement (context,tag,data,children,normalizationType) &#123;</span><br><span class="line">  //这里省略一系列边界判断</span><br><span class="line">  var vnode, ns;</span><br><span class="line">  if (typeof tag === &apos;string&apos;) &#123;</span><br><span class="line">    var Ctor;</span><br><span class="line">    ns = (context.$vnode &amp;&amp; context.$vnode.ns) || config.getTagNamespace(tag);</span><br><span class="line">    if (config.isReservedTag(tag)) &#123; //标签名是一般的html标签</span><br><span class="line">      vnode = new VNode(</span><br><span class="line">        config.parsePlatformTagName(tag), data, children,</span><br><span class="line">        undefined, undefined, context</span><br><span class="line">      );</span><br><span class="line">    &#125; else if ((!data || !data.pre) &amp;&amp; isDef(Ctor = resolveAsset(context.$options, &apos;components&apos;, tag))) &#123; //标签名是组件标签名</span><br><span class="line">      vnode = createComponent(Ctor, data, context, children, tag);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      //未知或未列出的命名空间元素在运行时检查，</span><br><span class="line">      //因为当其父项标准化子元素时可能会为其分配一个命名空间</span><br><span class="line">      vnode = new VNode(</span><br><span class="line">        tag, data, children,</span><br><span class="line">        undefined, undefined, context</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    // direct component options / constructor</span><br><span class="line">    vnode = createComponent(tag, data, context, children);</span><br><span class="line">  &#125;</span><br><span class="line">  if (Array.isArray(vnode)) &#123;</span><br><span class="line">    return vnode</span><br><span class="line">  &#125; else if (isDef(vnode)) &#123;</span><br><span class="line">    if (isDef(ns)) &#123; applyNS(vnode, ns); &#125;</span><br><span class="line">    if (isDef(data)) &#123; registerDeepBindings(data); &#125;</span><br><span class="line">    return vnode</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    return createEmptyVNode()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">  function createFunctionalComponent (</span><br><span class="line">    Ctor,</span><br><span class="line">    propsData,</span><br><span class="line">    data,</span><br><span class="line">    contextVm,</span><br><span class="line">    children</span><br><span class="line">  ) &#123;</span><br><span class="line">    var options = Ctor.options;</span><br><span class="line">    var props = &#123;&#125;;</span><br><span class="line">    var propOptions = options.props;</span><br><span class="line">    if (isDef(propOptions)) &#123;</span><br><span class="line">      for (var key in propOptions) &#123;</span><br><span class="line">        props[key] = validateProp(key, propOptions, propsData || emptyObject);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      if (isDef(data.attrs)) &#123; mergeProps(props, data.attrs); &#125;</span><br><span class="line">      if (isDef(data.props)) &#123; mergeProps(props, data.props); &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    var renderContext = new FunctionalRenderContext(</span><br><span class="line">      data,</span><br><span class="line">      props,</span><br><span class="line">      children,</span><br><span class="line">      contextVm,</span><br><span class="line">      Ctor</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    var vnode = options.render.call(null, renderContext._c, renderContext);</span><br><span class="line"></span><br><span class="line">    if (vnode instanceof VNode) &#123;</span><br><span class="line">      return cloneAndMarkFunctionalResult(vnode, data, renderContext.parent, options, renderContext)</span><br><span class="line">    &#125; else if (Array.isArray(vnode)) &#123;</span><br><span class="line">      var vnodes = normalizeChildren(vnode) || [];</span><br><span class="line">      var res = new Array(vnodes.length);</span><br><span class="line">      for (var i = 0; i &lt; vnodes.length; i++) &#123;</span><br><span class="line">        res[i] = cloneAndMarkFunctionalResult(vnodes[i], data, renderContext.parent, options, renderContext);</span><br><span class="line">      &#125;</span><br><span class="line">      return res</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="生命周期合并策略"><a href="#生命周期合并策略" class="headerlink" title="生命周期合并策略"></a>生命周期合并策略</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">var strats = config.optionMergeStrategies;</span><br><span class="line">LIFECYCLE_HOOKS.forEach(function (hook) &#123;</span><br><span class="line">    strats[hook] = mergeHook;</span><br><span class="line">  &#125;);</span><br><span class="line">function mergeHook (</span><br><span class="line">    parentVal,</span><br><span class="line">    childVal</span><br><span class="line">  ) &#123;</span><br><span class="line">    var res = childVal</span><br><span class="line">      ? parentVal</span><br><span class="line">        ? parentVal.concat(childVal)</span><br><span class="line">        : Array.isArray(childVal)</span><br><span class="line">          ? childVal</span><br><span class="line">          : [childVal]</span><br><span class="line">      : parentVal;</span><br><span class="line">    return res</span><br><span class="line">      ? dedupeHooks(res)</span><br><span class="line">      : res</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">function mergeOptions (</span><br><span class="line">    parent,</span><br><span class="line">    child,</span><br><span class="line">    vm</span><br><span class="line">  ) &#123;</span><br><span class="line">    &#123;</span><br><span class="line">      checkComponents(child);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (typeof child === &apos;function&apos;) &#123;</span><br><span class="line">      child = child.options;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    normalizeProps(child, vm);</span><br><span class="line">    normalizeInject(child, vm);</span><br><span class="line">    normalizeDirectives(child);</span><br><span class="line"></span><br><span class="line">    // Apply extends and mixins on the child options,</span><br><span class="line">    // but only if it is a raw options object that isn&apos;t</span><br><span class="line">    // the result of another mergeOptions call.</span><br><span class="line">    // Only merged options has the _base property.</span><br><span class="line">    if (!child._base) &#123;</span><br><span class="line">      if (child.extends) &#123;</span><br><span class="line">        parent = mergeOptions(parent, child.extends, vm);</span><br><span class="line">      &#125;</span><br><span class="line">      if (child.mixins) &#123;</span><br><span class="line">        for (var i = 0, l = child.mixins.length; i &lt; l; i++) &#123;</span><br><span class="line">          parent = mergeOptions(parent, child.mixins[i], vm);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    var options = &#123;&#125;;</span><br><span class="line">    var key;</span><br><span class="line">    for (key in parent) &#123;</span><br><span class="line">      mergeField(key);</span><br><span class="line">    &#125;</span><br><span class="line">    for (key in child) &#123;</span><br><span class="line">      if (!hasOwn(parent, key)) &#123;</span><br><span class="line">        mergeField(key);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    function mergeField (key) &#123;</span><br><span class="line">      var strat = strats[key] || defaultStrat;</span><br><span class="line">      options[key] = strat(parent[key], child[key], vm, key);</span><br><span class="line">    &#125;</span><br><span class="line">    return options</span><br><span class="line">  &#125;</span><br><span class="line"> function initMixin$1 (Vue) &#123;</span><br><span class="line">    Vue.mixin = function (mixin) &#123;</span><br><span class="line">      this.options = mergeOptions(this.options, mixin);</span><br><span class="line">      return this</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/knowledge/h5.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/knowledge/h5.html" itemprop="url">
                  一些关于H5的知识
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-27T10:33:58+08:00">
                2020-01-27
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>h5 新增语义化布局标签：header,nav,section,aside,article,footer，均表现为块级<br>canvas,video,audio,sessionStorage,localStorage,<br>拖放API(源对象：ondragstart,ondrag,ondragend；源对象标签属性要设置为draggable=true<br>目标对象：ondragenter,ondragover,ondragleave,ondrop;<br>ondragover事件默认会屏蔽ondrop事件,<br>如果要触发ondrop事件，需要在ondragover事件函数中阻止默认屏蔽行为<br>event.preventDefault()<br>)<br>//谷歌浏览器v56 之后，window,document,body的touchstart,touchmove事件会被默认为pssive:true<br>//解决方法一：window.addEventListener(‘touchstart’,func,{passive:false})<br>//解决方法二，添加样式：*{touch-action:none} 取消所有元素默认事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//实现把A标签拖到B标签</span><br><span class="line">1.A标签开始拖动时</span><br><span class="line">ondragstart(event)&#123;</span><br><span class="line">  event.dataTransfer.setData(&apos;source&apos;,event.target.id)</span><br><span class="line">&#125;</span><br><span class="line">2.B标签监听拖拽结束后</span><br><span class="line">ondrop(event)&#123;</span><br><span class="line">  var source = document.getElementById(event.dataTransfer.getData(&apos;source&apos;))</span><br><span class="line">  event.target.appendChild(source)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>History常用场景<br>单页应用中：实现网页无刷新更新数据的同时，解决浏览器无法前进/后退的问题<br>pushState:每执行一次都会增加一条历史记录，浏览器在返回时，就不会返回前一个页面，并且不会刷新浏览器<br>replaceState：用来修改当前历史记录，而不是创建一个新的历史记录，点击返回按钮照样会返回上一个页面<br>onpopstate：点击后退，前进或者调用history.back()，history.forward(),history.go()方法</p>
<h1 id="跨文档通讯"><a href="#跨文档通讯" class="headerlink" title="跨文档通讯"></a>跨文档通讯</h1><p>定义：跨文档消息传送，来自不同域的页面间传递消息<br>使用场景：内嵌框架和其父文档相互进行数据传输或者通讯</p>
<h2 id="postMessage"><a href="#postMessage" class="headerlink" title="postMessage"></a>postMessage</h2><p>window.postMessage(message,origin,transfer)<br>message:发送到子文档的信息，一般转成字符串，否则可能出现浏览器不兼容<br>origin:域信息，告诉子文档，消息来源，用于判断来源是否匹配，然后才进行相关操作<br>transfer:转移消息对象，可选参数，是一串和message同时传递的Transferable对象，这些对象的所有权将被转移给消息的接收方，而发送方将不再保有所有权</p>
<h2 id="onmessage"><a href="#onmessage" class="headerlink" title="onmessage"></a>onmessage</h2><p>onmessage事件回调函数参数event事件对象<br>event.data:postMessage传输过来的第一个参数，通常是字符串类型，（也可以是其他类型，但可能出现浏览器不兼容情况，所以一般转成字符串传递）<br>event.origin:postMessage传输过来的第二个参数，是用来匹配来源方的域<br>event.source:来源方目标文档的window引用，通常用作单次握手回应数据（event.source.postMessage()）<br>event.ports:MessageEvent接口特有属性，用于获取消息端口集合对象</p>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><p>父文档A通过iframe内嵌框架加载B子文档<br>通过iframe内嵌框架的onload事件回调父文档的sendMsg函数<br>再sendMsg函数中通过postMessage()函数向子文档B发送消息</p>
<p>子文档B监听onmessage事件，当文档收到消息后会执行该事件回调函数<br>回调函数内通过event对象判断域是否安全，然后处理推送过来的消息，<br>可以再通过调用event.source.postMessage向父文档发送消息</p>
<h1 id="地理位置"><a href="#地理位置" class="headerlink" title="地理位置"></a>地理位置</h1><p>navigator.geolocation.getCurrentPosition(success,error,option)<br>success:成功得到位置时的回调函数，使用Position对象作为唯一的参数<br>error:失败时回调，使用PositionError对象作为唯一参数<br>options：可选参数，对请求做一些配置</p>
<h1 id="离线存储优势"><a href="#离线存储优势" class="headerlink" title="离线存储优势"></a>离线存储优势</h1><p>离线浏览：当用户网络断开时，可以继续访问页面<br>访问速度快：将资源缓存到本地，已缓存资源加载更快<br>减少服务器负载：浏览器将只会从服务器下载更新过或者更改过的资源</p>
<h1 id="视频播放兼容"><a href="#视频播放兼容" class="headerlink" title="视频播放兼容"></a>视频播放兼容</h1><h2 id="Flv-js"><a href="#Flv-js" class="headerlink" title="Flv.js"></a>Flv.js</h2><p>H5 Flash(FLV)播放器,纯原生js开发，使H5能够支持FLV格式的视频<br>原理：将FLV文件流转码复用为ISO BMFF(MP4碎片)片段，然后通过Media Source Extension将MP4片段汇进浏览器<br>使用es6编写，通过Babel Compiler编译成es5能够支持FLV格式的视频</p>
<h2 id="Video-js"><a href="#Video-js" class="headerlink" title="Video.js"></a>Video.js</h2><p>几乎兼容所有浏览器,且优先使用H5，在不支持的浏览器中自动使用Flash播放<br>构建视频播放页面耗时短，界面可定制，开源，纯JS和css实现，文档详细</p>
<p>#Canvas绘制动画步骤<br>1.清空canvas<br>除非接下来要画的内容会完全充满canvas(例如背景图)，否则需要清空所有，最简单<br>的做法就是clearRect方法<br>2.保存canvas状态<br>如果需要改变一些会改变canvas状态的设置(样式，变形之类的)，又要在每画一帧之时，都是原始状态的话，需要先保存一下<br>3.绘制动画图形<br>重绘动画帧<br>4.恢复canvas状态<br>如果已经保存了canvas的状态，可以先恢复它，然后重绘下一帧</p>
<h1 id="transform"><a href="#transform" class="headerlink" title="transform"></a>transform</h1><p>2D功能函数组合使用时，先写的后执行<br>perspective：100px 可以设置3d旋转时的景深<br>transform-origin:可以改变中心点</p>
<h1 id="响应式布局"><a href="#响应式布局" class="headerlink" title="响应式布局"></a>响应式布局</h1><p>可以通过link标签配置media去使用不同比例的CSS样式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel=&apos;stylesheet&apos; media=&apos;screen and (max-device-width:480px)&apos; href=&apos;./css1.css&apos;&gt;</span><br><span class="line">&lt;link rel=&apos;stylesheet&apos; media=&apos;screen and (min-device-width:480px)&apos; href=&apos;./css2.css&apos;&gt;</span><br></pre></td></tr></table></figure></p>
<p><a href="https://github.com/YooHannah/algorithm/blob/master/baseJs/touchEvent.js" target="_blank" rel="noopener">一些触摸事件的实现</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/vue/vueRouter.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/vue/vueRouter.html" itemprop="url">
                  一些vueRouter官方文档看到的
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-28T23:06:15+08:00">
                2019-11-28
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="复用组件"><a href="#复用组件" class="headerlink" title="复用组件"></a>复用组件</h2><p>当使用路由参数时，例如从 /user/foo 导航到 /user/bar，原来的组件实例会被复用。<br>因为两个路由都渲染同个组件，比起销毁再创建，复用则显得更加高效。不过，这也意味着组件的生命周期钩子不会再被调用。</p>
<p>复用组件时，想对路由参数的变化作出响应的话，可以简单地 watch (监测变化) $route 对象</p>
<p>参数或查询的改变并不会触发进入/离开的导航守卫。<br>可以通过观察 $route 对象来应对这些变化，或使用 beforeRouteUpdate 的组件内守卫。</p>
<h2 id="参数组合"><a href="#参数组合" class="headerlink" title="参数组合"></a>参数组合</h2><p>如果提供了 path，params 会被忽略，query 并不会被忽略。你需要提供路由的 name 或手写完整的带有参数的 path<br> path—–query   name—–params</p>
<h2 id="beforeRouteUpdate"><a href="#beforeRouteUpdate" class="headerlink" title="beforeRouteUpdate"></a>beforeRouteUpdate</h2><p>如果目的地和当前路由相同，只有参数发生了改变 (比如从一个用户资料到另一个 /users/1 -&gt; /users/2)，你需要使用 beforeRouteUpdate 来响应这个变化 (比如抓取用户信息)</p>
<h2 id="router-view标签"><a href="#router-view标签" class="headerlink" title="router-view标签"></a>router-view标签</h2><p><router-view> 没有设置名字，那么默认为 default；如果设置了name，那么该视图显示路由中components中配置的name值对应的组件</router-view></p>
<h2 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h2><p>重定向三种形式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">1.</span><br><span class="line">const router = new VueRouter(&#123;</span><br><span class="line">  routes: [</span><br><span class="line">    &#123; path: &apos;/a&apos;, redirect: &apos;/b&apos; &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">2.命名的路由</span><br><span class="line">const router = new VueRouter(&#123;</span><br><span class="line">  routes: [</span><br><span class="line">    &#123; path: &apos;/a&apos;, redirect: &#123; name: &apos;foo&apos; &#125;&#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line">3.方法，动态返回重定向目标：</span><br><span class="line">const router = new VueRouter(&#123;</span><br><span class="line">  routes: [</span><br><span class="line">    &#123; path: &apos;/a&apos;, redirect: to =&gt; &#123;</span><br><span class="line">      // 方法接收 目标路由 作为参数</span><br><span class="line">      // return 重定向的 字符串路径/路径对象</span><br><span class="line">    &#125;&#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>导航守卫并没有应用在跳转路由上，而仅仅应用在其目标上,为 /a 路由添加一个 beforeEach 或 beforeLeave 守卫并不会有任何效果</p>
<p>“重定向”的意思是，当用户访问 /a时，URL 将会被替换成 /b，然后匹配路由为 /b，<br>/a 的别名是 /b，意味着，当用户访问 /b 时，URL 会保持为 /b，但是路由匹配则为 /a，就像用户访问 /a 一样。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const router = new VueRouter(&#123;</span><br><span class="line">  routes: [</span><br><span class="line">    &#123; path: &apos;/a&apos;, component: A, alias: &apos;/b&apos; &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<h2 id="props"><a href="#props" class="headerlink" title="props"></a>props</h2><p>通过配置props属性实现多路由复用组件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">1.如果 props 被设置为 true，route.params 将会被设置为组件属性。</span><br><span class="line">const User = &#123;</span><br><span class="line">  props: [&apos;id&apos;],</span><br><span class="line">  template: &apos;&lt;div&gt;User &#123;&#123; id &#125;&#125;&lt;/div&gt;&apos;</span><br><span class="line">&#125;</span><br><span class="line">const router = new VueRouter(&#123;</span><br><span class="line">  routes: [</span><br><span class="line">    &#123; path: &apos;/user/:id&apos;, component: User, props: true &#125;,</span><br><span class="line"></span><br><span class="line">    // 对于包含命名视图的路由，你必须分别为每个命名视图添加 `props` 选项：</span><br><span class="line">    &#123;</span><br><span class="line">      path: &apos;/user/:id&apos;,</span><br><span class="line">      components: &#123; default: User, sidebar: Sidebar &#125;,</span><br><span class="line">      props: &#123; default: true, sidebar: false &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">2.如果 props 是一个对象，它会被按原样设置为组件属性。当 props 是静态的时候有用</span><br><span class="line">const router = new VueRouter(&#123;</span><br><span class="line">  routes: [</span><br><span class="line">    &#123; path: &apos;/promotion/from-newsletter&apos;, component: Promotion, props: &#123; newsletterPopup: false &#125; &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">3.创建一个函数返回 props</span><br><span class="line">const router = new VueRouter(&#123;</span><br><span class="line">  routes: [</span><br><span class="line">    &#123; path: &apos;/search&apos;, component: SearchUser, props: (route) =&gt; (&#123; query: route.query.q &#125;) &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line">URL /search?q=vue 会将 &#123;query: &apos;vue&apos;&#125; 作为属性传递给 SearchUser 组件</span><br></pre></td></tr></table></figure></p>
<p>请尽可能保持 props 函数为无状态的，因为它只会在路由发生变化时起作用。如果你需要状态来定义 props，请使用包装组件，这样 Vue 才可以对状态变化做出反应</p>
<h2 id="路由生命周期"><a href="#路由生命周期" class="headerlink" title="路由生命周期"></a>路由生命周期</h2><h3 id="全局配置"><a href="#全局配置" class="headerlink" title="全局配置"></a>全局配置</h3><p>router.beforeEach:当一个导航触发时，全局前置守卫按照创建顺序调用。守卫是异步解析执行，此时导航在所有守卫 resolve 完之前一直处于 等待中<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">三个参数</span><br><span class="line">to: 即将要进入的目标 路由对象</span><br><span class="line">from: 当前导航正要离开的路由的路由对象</span><br><span class="line">next：一定要调用该方法来 resolve 这个钩子。执行效果依赖 next 方法的调用参数</span><br><span class="line">      next(): 进行管道中的下一个钩子。如果全部钩子执行完了，则导航的状态就是 confirmed (确认的)。</span><br><span class="line">      next(false): 中断当前的导航。如果浏览器的 URL 改变了 (可能是用户手动或者浏览器后退按钮)，那么 URL 地址会重置到 from 路由对应的地址。</span><br><span class="line">      next(&apos;/&apos;) 或者 next(&#123; path: &apos;/&apos; &#125;): 跳转到一个不同的地址。当前的导航被中断，然后进行一个新的导航。</span><br><span class="line">      next(error): 如果传入 next 的参数是一个 Error 实例，则导航会被终止且该错误会被传递给 router.onError() 注册过的回调</span><br></pre></td></tr></table></figure></p>
<p>router.beforeResolve:在导航被确认之前，同时在所有组件内守卫和异步路由组件被解析之后，解析守卫就被调用</p>
<p>router.afterEach:不会接受 next 函数也不会改变导航本身</p>
<h3 id="路由配置"><a href="#路由配置" class="headerlink" title="路由配置"></a>路由配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">const router = new VueRouter(&#123;</span><br><span class="line">  routes: [</span><br><span class="line">    &#123;</span><br><span class="line">      path: &apos;/foo&apos;,</span><br><span class="line">      component: Foo,</span><br><span class="line">      beforeEnter: (to, from, next) =&gt; &#123;</span><br><span class="line">        // ...</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="组件内"><a href="#组件内" class="headerlink" title="组件内"></a>组件内</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">const Foo = &#123;</span><br><span class="line">  template: `...`,</span><br><span class="line">  beforeRouteEnter (to, from, next) &#123;</span><br><span class="line">    // 在渲染该组件的对应路由被 confirm 前调用</span><br><span class="line">    // 不！能！获取组件实例 `this` </span><br><span class="line">    // 因为守卫在导航确认前被调用,因此即将登场的新组件还没被创建。</span><br><span class="line">    //可以通过传一个回调给 next来访问组件实例。在导航被确认的时候执行回调，并且把组件实例作为回调方法的参数。</span><br><span class="line">    next(vm =&gt; &#123; //是支持给 next 传递回调的唯一钩子，beforeRouteUpdate，beforeRouteLeave都不支持，因为可以访问的到</span><br><span class="line">      // 通过 `vm` 访问组件实例</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  beforeRouteUpdate (to, from, next) &#123;</span><br><span class="line">    // 在当前路由改变，但是该组件被复用时调用</span><br><span class="line">    // 举例来说，对于一个带有动态参数的路径 /foo/:id，在 /foo/1 和 /foo/2 之间跳转的时候，</span><br><span class="line">    // 由于会渲染同样的 Foo 组件，因此组件实例会被复用。而这个钩子就会在这个情况下被调用。</span><br><span class="line">    // 可以访问组件实例 `this`</span><br><span class="line">  &#125;,</span><br><span class="line">  beforeRouteLeave (to, from, next) &#123;</span><br><span class="line">    // 导航离开该组件的对应路由时调用</span><br><span class="line">    // 可以访问组件实例 `this`</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="完整的导航解析流程"><a href="#完整的导航解析流程" class="headerlink" title="完整的导航解析流程"></a>完整的导航解析流程</h3><ol>
<li>导航被触发。</li>
<li>在失活的组件里调用离开守卫。</li>
<li>调用全局的 beforeEach 守卫。</li>
<li>在重用的组件里调用 beforeRouteUpdate 守卫 (2.2+)。</li>
<li>在路由配置里调用 beforeEnter。</li>
<li>解析异步路由组件。</li>
<li>在被激活的组件里调用 beforeRouteEnter。</li>
<li>调用全局的 beforeResolve 守卫 (2.5+)。</li>
<li>导航被确认。</li>
<li>调用全局的 afterEach 钩子。</li>
<li>触发 DOM 更新。</li>
<li>用创建好的实例调用 beforeRouteEnter 守卫中传给 next 的回调函数。</li>
</ol>
<h2 id="数据获取"><a href="#数据获取" class="headerlink" title="数据获取"></a>数据获取</h2><h3 id="导航完成后获取数据"><a href="#导航完成后获取数据" class="headerlink" title="导航完成后获取数据"></a>导航完成后获取数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">created () &#123;</span><br><span class="line">  // 组件创建完后获取数据，</span><br><span class="line">  // 此时 data 已经被 observed 了</span><br><span class="line">  this.fetchData()</span><br><span class="line">&#125;,</span><br><span class="line">watch: &#123;</span><br><span class="line">  // 如果路由有变化，会再次执行该方法</span><br><span class="line">  &apos;$route&apos;: &apos;fetchData&apos;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h3 id="在导航完成前获取数据"><a href="#在导航完成前获取数据" class="headerlink" title="在导航完成前获取数据"></a>在导航完成前获取数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">beforeRouteEnter (to, from, next) &#123;</span><br><span class="line">  getPost(to.params.id, (err, post) =&gt; &#123;</span><br><span class="line">    next(vm =&gt; vm.setData(err, post))</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;,</span><br><span class="line">// 路由改变前，组件就已经渲染完了</span><br><span class="line">// 逻辑稍稍不同</span><br><span class="line">beforeRouteUpdate (to, from, next) &#123;</span><br><span class="line">  this.post = null</span><br><span class="line">  getPost(to.params.id, (err, post) =&gt; &#123;</span><br><span class="line">    this.setData(err, post)</span><br><span class="line">    next()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;,</span><br><span class="line">methods: &#123;</span><br><span class="line">  setData (err, post) &#123;</span><br><span class="line">    if (err) &#123;</span><br><span class="line">      this.error = err.toString()</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      this.post = post</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="滚动行为"><a href="#滚动行为" class="headerlink" title="滚动行为"></a>滚动行为</h2><p>scrollBehavior 这个功能只在支持 history.pushState 的浏览器中可用。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">const router = new VueRouter(&#123;</span><br><span class="line">  routes: [...],</span><br><span class="line">  scrollBehavior (to, from, savedPosition) &#123;</span><br><span class="line"></span><br><span class="line">    // return 期望滚动到哪个的位置</span><br><span class="line">    if (to.hash) &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        selector: to.hash //模拟“滚动到锚点”的行为</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if (savedPosition) &#123;</span><br><span class="line">      return savedPosition //返回 savedPosition，在按下 后退/前进 按钮时，就会像浏览器的原生表现那样</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      return &#123; x: 0, y: 0 &#125; //让页面滚动到顶部</span><br><span class="line">    &#125;</span><br><span class="line">    return new Promise((resolve, reject) =&gt; &#123; //返回一个 Promise 来得出预期的位置描述</span><br><span class="line">      setTimeout(() =&gt; &#123;</span><br><span class="line">        resolve(&#123; x: 0, y: 0 &#125;)</span><br><span class="line">      &#125;, 500)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/knowledge/calcApprence.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/knowledge/calcApprence.html" itemprop="url">
                  两个css问题解决
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-28T22:58:58+08:00">
                2019-11-28
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="子元素-position-fixed-，但宽度要和父元素一致"><a href="#子元素-position-fixed-，但宽度要和父元素一致" class="headerlink" title="子元素 position:fixed ，但宽度要和父元素一致"></a>子元素 position:fixed ，但宽度要和父元素一致</h1><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>父元素宽度随屏幕大小变化，而且margin-left有一个固定值，假设为320px<br>子元素position:fixed<br>如果直接设置子元素宽度为100%<br>则会导致子元素有320px的宽度在可视区域外<br><img src="/image/calc.png" alt="calc.png"></p>
<h2 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h2><p>css3的函数calc() 可以用来计算属性值<br>特点：<br>1.浏览器解析calc()结果还是calc(),不会计算参数表达式的值，<br>  意味着浏览器中的值可以更加灵活，能够响应视口的改变，即实际渲染结果始终调用calc计算结果<br>2.可以使用加减乘除，可以套嵌使用，即calc参数表达式中可以包含calc函数调用<br>3.可以进行不同单位间的计算,可以混合绝对单位(如百分比与视口单元)与相对单元(比如像素)<br>应用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">1.居中</span><br><span class="line">//居中设置原来</span><br><span class="line">.center &#123;</span><br><span class="line">  position: absolute</span><br><span class="line">  top: 50%;</span><br><span class="line">  left: 50%;</span><br><span class="line">  marging-top: -150px;</span><br><span class="line">  margin-left: -150px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//使用calc</span><br><span class="line">.center &#123;</span><br><span class="line">  position: absolute</span><br><span class="line">  top: calc(50% - 150px);</span><br><span class="line">  left: calc(50% - 150px);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">2.设置字体，在页面上的任何文本，将会根据视口自动缩放，</span><br><span class="line">相同比例的视口总会显示相同的文本数量，不管视口的真实尺寸是多少。</span><br><span class="line">html &#123;  </span><br><span class="line">    font-size: calc(100vw / 30);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">width:calc(100%-320px)</span><br></pre></td></tr></table></figure>
<h1 id="input样式兼容"><a href="#input样式兼容" class="headerlink" title="input样式兼容"></a>input样式兼容</h1><p>在safari浏览器中给input设置样式不能直接被使用，会依旧使用浏览器默认样式，<br>此时需要给样式添加<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-webkit-appearance: none;/*去除系统默认appearance的样式*/</span><br><span class="line">line-height: normal;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoohannah.github.io/post/js/proxy.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="YooHannah">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/psb.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="My Little World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="My Little World" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/js/proxy.html" itemprop="url">
                  关于代理proxy
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-08T22:19:37+08:00">
                2019-11-08
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>代理是JS es6中引入，可用于控制对象<br>—代理可以定制对象交互时行动（例如，当读取属性或调用方法）<br>— 所有交互行为都必须通过代理，指定的行为发生时会调用代理方法<br>使用代理可以优雅实现以下内容</p>
<ul>
<li>日志记录</li>
<li>性能测试</li>
<li>数据校验</li>
<li>自动填充对象属性</li>
<li>数组负索引</li>
</ul>
<p>使用代理对对象访问添加日志 — report 函数用于添加日志<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">function makeLoggable(target)&#123;</span><br><span class="line">	return new Proxy(target,&#123;</span><br><span class="line">		get:(target,property)=&gt;&#123;</span><br><span class="line">			report(&apos;READING:&apos;+property)</span><br><span class="line">			return target[property]</span><br><span class="line">		&#125;,</span><br><span class="line">		set:(target,property,value)=&gt;&#123;</span><br><span class="line">			report(&apos;writing value&apos; +value +&apos;to&apos;+&apos;property&apos;)</span><br><span class="line">			target[property] = value</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>proxy 用于数据校验</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">var personValidator = &#123;</span><br><span class="line">    name(val)&#123;</span><br><span class="line">        return typeof val === &apos;string&apos;</span><br><span class="line">    &#125;</span><br><span class="line">    age(val)&#123;</span><br><span class="line">        return typeof val === &apos;number&apos; &amp;&amp; val&gt;18</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class person&#123;</span><br><span class="line">    constructor(name,age)&#123;</span><br><span class="line">        this.name = name;</span><br><span class="line">        this.age = age;</span><br><span class="line">        return createValidator(this,personValidator)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">function createValidator(target,validator)&#123;</span><br><span class="line">    return new Proxy(target,&#123;</span><br><span class="line">        _validator:validator,</span><br><span class="line">        set(target,key,value,proxy)&#123;</span><br><span class="line">            if(target.hasOwnproperty(key))&#123;</span><br><span class="line">                var validator = this._validator[key]</span><br><span class="line">                if(validator(value))&#123;</span><br><span class="line">                    return Reflect.set(target,key,value,proxy)</span><br><span class="line">                &#125;else&#123;</span><br><span class="line">                    throw Error(&apos;type error&apos;)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用代理自动填充属性<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">function Folder()&#123;</span><br><span class="line">	return new Proxy(&#123;&#125;,&#123;</span><br><span class="line">		get:(target,property)=&gt;&#123;</span><br><span class="line">			if(!(property in target))&#123;</span><br><span class="line">				target[property] = new Folder()</span><br><span class="line">			&#125;</span><br><span class="line">			return target[property]</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const rootFolder = new Folder()</span><br><span class="line">try &#123;</span><br><span class="line">	rootFolder.ninjasDir.firstNinjaDir.ninjaFile = &apos;yoshi.txt&apos;</span><br><span class="line">&#125;catch(e)&#123;</span><br><span class="line">	console.log(e)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>使用代理实现数组负引用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">function creatNegativeArrayProxy(array)&#123;</span><br><span class="line">	if(!Array.isArray(array))&#123;</span><br><span class="line">		throw new TypeError(&apos;expected an array&apos;)</span><br><span class="line">	&#125;</span><br><span class="line">	return new Proxy(array,&#123;</span><br><span class="line">		get:(target,index)=&gt;&#123;</span><br><span class="line">			index = +index</span><br><span class="line">			return target[index&lt;0?target.length+index:index]</span><br><span class="line">		&#125;,</span><br><span class="line">		set:(target,index,val)=&gt;&#123;</span><br><span class="line">			index = +index</span><br><span class="line">			return target[index&lt;0?target.length+index:index] = val</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const ninja = [1,2,3]</span><br><span class="line">const proxi = creatNegativeArrayProxy(ninja)</span><br><span class="line">console.log(proxi[-1]) //==&gt; 3</span><br><span class="line">proxi[-2] = 22 // ninja ==&gt;1,22,3</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/6/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><span class="space">&hellip;</span><a class="page-number" href="/page/24/">24</a><a class="extend next" rel="next" href="/page/8/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/psb.jpg" alt="YooHannah">
          <p class="site-author-name" itemprop="name">YooHannah</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">240</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">21</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">YooHannah</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/treedocument/treedocument.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	




  
  

  

  

  

  


</body>
</html>
